"use strict";(self.webpackChunkcritical_web=self.webpackChunkcritical_web||[]).push([[931],{1970:(F,T,c)=>{c.d(T,{P:()=>g});var f=c(9212),h=c(2181);class a{create(){return{svg:null,mainG:null,innerWidth:null,innerHeight:null,margin:{top:60,right:90,bottom:100,left:90},scales:null,focusLine:null,selected:null,head:null,latestId:0,latestGroupId:0,seedProject:null}}}var I=c(3920),p=c(3633),u=c(4595),D=c(2119),y=c(9975),j=c(8962);let _=(()=>{class m{constructor(e,t,s,o){this.dashboard=e,this.projSerializer=t,this.treeNodeSerializer=s,this.nodeConnector=o}setState(e){this.st=e}initializeHeadNode(e){const t=this.projSerializer,s=t.fromJson(e),o=this.treeNodeSerializer.head();o.data=s,this.st.head=o,this.st.selected=o,this.st.seedProject=t.fromJson(e)}countNodes(e,t){t.push(e);for(const s of e.children)this.countNodes(s,t);return t.length>0?Math.max(...t.map(s=>s.id?s.id:0))+1:0}selectNode(e){const t=this.getNodeById(this.st.head,e);t&&(this.st.selected=this.copyNode(t))}getNodeById(e,t){if(e.id===t)return e;let s=null;for(const o of e.children){const r=this.getNodeById(o,t);r&&(s=r)}return s}commit(e){const t=this.createNode(e);return this.st.selected.children.push(t),t.parent=this.st.selected,t.parentNodeId=this.st.selected.id,this.st.selected=t,this.getHistoryArray(this.st.head)}branch(e){if(null!=this.st.selected.parent){this.st.selected=this.st.selected.parent;const t=this.createNode(e);return t.parent=this.st.selected,t.parentNodeId=this.st.selected.id,this.st.selected.children.push(t),this.st.selected=t,this.getHistoryArray(this.st.head)}return null}reset(){const e=(new D.z).fromJson(this.st.seedProject),t=this.copyNode(this.st.head);return t.data=e,t.children=[],this.st.head=t,this.st.selected=this.copyNode(t),t}copyNode(e){const t=(new D.z).fromJson(e.data),s=(new y.Q).fromJson(e);return t.profile.view.lassoOn=e.data.profile.view.lassoOn,s.data=t,s}createNode(e){const t=this.st.selected;this.st.latestId++;let s=null,o=null;const r=this.st.latestId;t.children.length>0?(this.st.latestGroupId++,s=this.st.latestGroupId,o=0):(s=t.group,o=t.subgroup+1);const i=`${s}-${o}-${r}`,n=this.projSerializer.fromJson(e);n.profile.view.lassoOn=e.profile.view.lassoOn;const d={id:r,group:s,subgroup:o,data:n,name:i,children:[],metadata:null,parent:null,parentNodeId:null};return this.nodeConnector.connectArrowsToNodes(n),this.processMetadata(d),d}processMetadata(e){const o={assignmentCompleted:0===e.data.activities.filter(r=>!r.chartInfo.isDummy).filter(r=>0===r.assign.resources.length).length,time:null,cost:null};e.metadata=o}getHistoryArray(e){const t=[];return this.walkTree(e,t,0),t}walkTree(e,t,s){if(!e)return;const o=this.projSerializer.fromJson(e.data),r=this.treeNodeSerializer.fromJson(e);this.nodeConnector.connectArrowsToNodes(o),r.data=o,t.push(r);for(const i of e.children)this.walkTree(i,t,++s)}loadState(e,t){const s=t.find(i=>0===i.id),o=this.copyNode(s);o.data=this.projSerializer.fromJson(s.data),e.head=o,e.selected=o,e.seedProject=this.projSerializer.fromJson(e.head.data);const r=t.map(i=>i.id);return e.latestId=Math.max(...r)+1,e.latestGroupId=u.Iz,this.buildBranch(e.head,t,null),t.forEach(i=>this.nodeConnector.connectArrowsToNodes(i.data)),this.projSerializer.fromJson(s.data)}buildBranch(e,t,s){if(e){s&&(s.children.push(e),e.parent=s);const o=t.filter(r=>r.parentNodeId===e.id&&null!==r.parentNodeId);for(const r of o)this.buildBranch(r,t,e)}}static#t=this.\u0275fac=function(t){return new(t||m)(f.LFG(p.Ou),f.LFG(D.z),f.LFG(y.Q),f.LFG(j.E))};static#e=this.\u0275prov=f.Yz7({token:m,factory:m.\u0275fac,providedIn:"root"})}return m})(),v=(()=>{class m{constructor(e,t,s,o,r){this.dashboard=e,this.eventService=t,this.projectSerializer=s,this.ops=o,this.ngZone=r,this.isInitialized=!1,this.subsInited=!1}initSubscriptions(){this.subsInited||(this.selectedNode$=this.eventService.get(u.Xq),this.commitSub=this.eventService.get(u.J7).pipe((0,h.h)(e=>!!e)).subscribe(e=>this.commit()),this.branchSub=this.eventService.get(u.u0).pipe((0,h.h)(e=>!!e)).subscribe(e=>this.branch()),this.resetSub=this.eventService.get(u.NT).pipe((0,h.h)(e=>!!e)).subscribe(e=>this.reset()),this.loadTreeSub=this.eventService.get(u.kV).pipe((0,h.h)(e=>!!e)).subscribe(e=>this.loadTree(e)),this.selectedNode$.pipe((0,h.h)(e=>!!e)).subscribe(e=>this.selectNode(e)),this.subsInited=!0)}commit(){const e=this.ops.commit(this.project);this.eventService.get(u.cu).next(e),null!==this.st.selected&&this.selectedNode$.next(this.st.selected.id),this.drawChart()}branch(){const e=this.ops.branch(this.project);this.eventService.get(u.cu).next(e),null!==this.st.selected&&this.selectedNode$.next(this.st.selected.id),this.drawChart()}reset(){const e=this.ops.reset(),t=this.projectSerializer.fromJson(e.data);this.dashboard.updateProject(t,!0),null!==this.st.selected&&this.selectedNode$.next(this.st.selected.id),this.eventService.get(u.cu).next([]),this.drawChart()}loadTree(e){this.st=this.st??(new a).create();const t=this.ops.loadState(this.st,e);this.dashboard.updateProject(t,!0),this.eventService.get(u.cu).next(e),this.drawChart()}selectNode(e){this.ops.selectNode(e),null!==this.st.selected&&null!==this.st.selected.data&&this.dashboard.updateProject(this.st.selected.data,!0),this.drawChart()}init(e,t,s,o){this.id=s,this.st=this.st??(new a).create(),this.st.latestId=u.Iz,this.st.innerHeight=t-this.st.margin.top-this.st.margin.bottom,this.st.innerWidth=e-this.st.margin.left-this.st.margin.right,this.ops.setState(this.st),this.initSvg(e,t,o),this.initZoom(),this.dashboard.activeProject$.pipe((0,h.h)(r=>!!r)).subscribe(r=>{this.ngZone.runOutsideAngular(()=>{this.project=r,this.isInitialized||(this.ops.initializeHeadNode(r),this.drawChart()),this.isInitialized=!0})}),this.initSubscriptions()}initZoom(){const e=I.sPX().on("zoom",(t,s)=>{this.st.mainG.attr("transform",t.transform)}).scaleExtent([1,1]);this.st.svg.call(e),I.sPX().translateBy(this.st.svg,this.st.margin.left,this.st.margin.top)}destroy(){this.reset(),this.commitSub&&this.commitSub.unsubscribe(),this.branchSub&&this.branchSub.unsubscribe(),this.resetSub&&this.resetSub.unsubscribe(),this.loadTreeSub&&this.loadTreeSub.unsubscribe(),this.eventService.get(u.J7).next(null),this.eventService.get(u.u0).next(null),this.eventService.get(u.NT).next(null)}initSvg(e,t,s){const o=this.st,r="tree-s-"+this.id;I.Ys(s).select("svg").remove();const i=I.Ys(s).append("svg").attr("class",r);this.st.svg=i.style("width","100%").style("height",null).attr("preserveAspectRatio","xMinYMin meet").attr("viewBox",`0 0 ${e} ${t}`),o.mainG=o.svg.append("g").attr("transform","translate("+this.st.margin.left+","+this.st.margin.top+")")}drawChart(){if(!this.st.mainG)return;this.st.mainG.selectAll("*").remove();let e=I.G_s().size([this.st.innerHeight,this.st.innerWidth]);const t=I.bT9(this.st.head);e=e.size([this.st.innerWidth,75*t.height]);const o=e(t),r=t.descendants().slice(1);this.st.mainG.selectAll(".link-tree").data(r).enter().append("path").attr("class","link-tree").attr("stroke","2px").attr("d",n=>"M"+n.x+","+n.y+"C"+n.x+","+(n.y+n.parent.y)/2+" "+n.parent.x+","+(n.y+n.parent.y)/2+" "+n.parent.x+","+n.parent.y);const i=this.st.mainG.selectAll(".node-tree").data(o.descendants()).enter().append("g");i.append("circle").attr("class","node-tree").attr("r",8).attr("cx",n=>n.x).attr("cy",n=>n.y).classed("selected",n=>n.data?.id===this.st.selected?.id).classed("completed",n=>!!n.data?.metadata?.assignmentCompleted).on("mousedown",(n,d)=>{this.selectedNode$.next(d.data.id),this.st.selected=d.data;const P=(new D.z).fromJson(d.data.data);this.dashboard.updateProject(P,!0),this.drawChart()}),i.append("text").text(n=>n.data.name).attr("x",n=>n.x).attr("dx",8.5).attr("y",n=>n.y)}static#t=this.\u0275fac=function(t){return new(t||m)(f.LFG(p.Ou),f.LFG(p.WO),f.LFG(D.z),f.LFG(_),f.LFG(f.R0b))};static#e=this.\u0275prov=f.Yz7({token:m,factory:m.\u0275fac,providedIn:"root"})}return m})();const S=["chart"];let g=(()=>{class m{constructor(){this.ui=(0,f.f3M)(v)}ngOnInit(){this.ui.init(this.width,this.height,this.id,this.chart.nativeElement)}ngOnDestroy(){this.ui.destroy()}static#t=this.\u0275fac=function(t){return new(t||m)};static#e=this.\u0275cmp=f.Xpm({type:m,selectors:[["cp-project-tree"]],viewQuery:function(t,s){if(1&t&&f.Gf(S,7),2&t){let o;f.iGM(o=f.CRH())&&(s.chart=o.first)}},inputs:{id:"id",width:"width",height:"height"},features:[f._Bn([v])],decls:3,vars:0,consts:[[1,"node-tree"],[1,"project-tree"],["chart",""]],template:function(t,s){1&t&&(f.TgZ(0,"div",0),f._UZ(1,"div",1,2),f.qZA())},styles:["cp-project-tree text{stroke:#999}cp-project-tree svg{background-color:#fff}cp-project-tree .link-tree{fill:none;stroke:#000}cp-project-tree .border{fill:none;shape-rendering:crispEdges;stroke:#aaa}cp-project-tree .node-tree{stroke:#fff;fill:#000;cursor:pointer}cp-project-tree .node-tree.onpath{stroke:#6495ed;stroke-width:4px;fill:#d3d3d3}cp-project-tree .node-tree.selected{stroke:#6495ed;stroke-width:4px;fill:red}cp-project-tree .node-tree.selected.completed,cp-project-tree .node-tree.completed{stroke:#6495ed;stroke-width:4px;fill:#0e0}cp-project-tree .project-tree{margin-top:15px}\n"],encapsulation:2})}return m})()},2457:(F,T,c)=>{c.d(T,{n:()=>a});var f=c(6814),h=c(9212);let a=(()=>{class I{static#t=this.\u0275fac=function(D){return new(D||I)};static#e=this.\u0275mod=h.oAB({type:I});static#s=this.\u0275inj=h.cJS({imports:[f.ez]})}return I})()},5269:(F,T,c)=>{c.d(T,{u:()=>p});var f=c(3633),h=c(4595),a=c(9212),I=c(6602);let p=(()=>{class u{constructor(y,j){this.eventService=y,this.jsonFileManager=j,this.multiFileFormats=!1,this.eventService.get(h.cu).subscribe(_=>{this.history=_})}ngOnInit(){}commit(){this.eventService.get(h.J7).next(!0)}branch(){this.eventService.get(h.u0).next(!0)}reset(){this.eventService.get(h.NT).next(!0)}downloadHistory(){this.jsonFileManager.export(this.history)}loadFile(y){const j=y.files,_=j.item(0);null!==_&&j.length>0&&this.jsonFileManager.importFromTreeNodeList(_).then(v=>{this.eventService.get(h.kV).next(v)})}static#t=this.\u0275fac=function(j){return new(j||u)(a.Y36(f.WO),a.Y36(I.W))};static#e=this.\u0275cmp=a.Xpm({type:u,selectors:[["cp-tree-buttons"]],inputs:{fileActions:"fileActions",multiFileFormats:"multiFileFormats"},decls:18,vars:1,consts:[[1,"btns"],["href","javascript:void(0)",3,"click"],[3,"hidden"],["type","file","accept",".json",1,"file-input",3,"change"],["uploadFile",""]],template:function(j,_){if(1&j){const v=a.EpF();a.TgZ(0,"div",0)(1,"div")(2,"a",1),a.NdJ("click",function(){return _.commit()}),a._uU(3,"Commit"),a.qZA(),a._uU(4," \xa0 | \xa0 "),a.TgZ(5,"a",1),a.NdJ("click",function(){return _.branch()}),a._uU(6,"Branch"),a.qZA(),a._uU(7," \xa0 | \xa0 "),a.TgZ(8,"a",1),a.NdJ("click",function(){return _.reset()}),a._uU(9,"Reset"),a.qZA()(),a.TgZ(10,"div",2)(11,"a",1),a.NdJ("click",function(){return _.downloadHistory()}),a._uU(12,"Download"),a.qZA(),a._uU(13," \xa0 | \xa0 "),a.TgZ(14,"a",1),a.NdJ("click",function(){a.CHM(v);const g=a.MAs(17);return g.value="",a.KtG(g.click())}),a._uU(15,"Load File"),a.qZA(),a.TgZ(16,"input",3,4),a.NdJ("change",function(g){return _.loadFile(g.target)}),a.qZA()()()}2&j&&(a.xp6(10),a.Q6J("hidden",!_.fileActions))},styles:[".btns[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.file-input[_ngcontent-%COMP%]{display:none}"]})}return u})()},9975:(F,T,c)=>{c.d(T,{Q:()=>h});var f=c(9212);let h=(()=>{class a{fromJson(p){p=p??{};let u=p?.metadata??{};return u=u?{assignmentCompleted:u.assignmentCompleted??!1,time:u.time??null,cost:u.cost??null}:{assignmentCompleted:!1,time:null,cost:null},{name:p?.name??null,group:p?.group??null,subgroup:p?.subgroup??null,metadata:p?.metadata??null,data:p?.data??null,children:p?.children??[],id:p?.id??null,parent:p.parent??null,parentNodeId:p?.parentNodeId??null}}toJson(p){}head(){return{id:0,group:0,subgroup:0,name:"head",data:null,children:[],parent:null,metadata:null,parentNodeId:null}}static#t=this.\u0275fac=function(u){return new(u||a)};static#e=this.\u0275prov=f.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"})}return a})()},6399:(F,T,c)=>{c.d(T,{h:()=>m});var f=c(4403),h=c(9212),a=c(2119),I=c(9635),p=c(2069),u=c(6265),D=c(580),y=c(9304),j=c(5233),_=c(7399),v=c(9989),S=c(6562),g=c(9975);let m=(()=>{class O{constructor(t,s,o,r,i,n,d,P,b,w,z,C,M,L,A){this.projectSerializer=t,this.projProfSerializer=s,this.treeNodeSerializer=o,this.resProfSerializer=r,this.resSerializer=i,this.resSumSerializer=n,this.roleSerializer=d,this.phaseSerializer=P,this.roleSumSerializer=b,this.asResSerializer=w,this.actSerializer=z,this.actProfSerializer=C,this.chartSerializer=M,this.intSerializer=L,this.projectSubProjectSerializer=A}setProp(t,s,o){return t[o]=s[o]}mapProjectToNode(t){const s=this.treeNodeSerializer.fromJson();return s.parentNodeId=0,s.id=t.profile.id,s.data=t,s}mapTreeNode(t){return t.data=this.projectSerializer.fromJson(t.data),t}createTreeHeadNode(){const t=this.treeNodeSerializer.fromJson();return t.parentNodeId=null,t.id=0,t.data=this.projectSerializer.fromJson(),t}getNode(t,s){const o=this.projProfSerializer.fromJson(),r=this.treeNodeSerializer.fromJson();if(t){const G=Object.keys(t);for(const k of G)o.hasOwnProperty(k)&&this.setProp(o,t,k),r.hasOwnProperty(k)&&this.setProp(r,t,k),r.parentNodeId=t[f.cT]??null,r.id=t[f.v0]??null}const{activityData:i,arrowData:n,integrationData:d,activityResourceData:P,activityPhaseData:b,rolesData:w,resourcesData:z,phaseData:C,resourceRoleData:M,subProjectData:L}=s,A=this.mapActivities(t,i,n),J=this.mapResources(t,z),l=this.mapPhases(t,C),N=this.mapIntegrations(t,d),R=this.mapRoles(t,w),B=this.mapSubProject(t,L);this.mapActivityResources(t,P,A),this.mapActivityPhases(t,b,A),this.mapResourceRoles(t,M,J);const E=this.projectSerializer.fromJson();return E.activities=A,E.integrations=N,E.profile=o,E.resources=J,E.phases=l,E.roles=R,r.data=E,null!==B&&(E.profile.subProject=B),this.updateNodeMetadata(A,r),r}updateNodeMetadata(t,s){const o=t.filter(i=>!i.chartInfo.isDummy).length,r=t.filter(i=>!i.chartInfo.isDummy&&i.assign.resources.length>0).length;s.metadata={assignmentCompleted:o==r,time:0,cost:0}}mapSubProject(t,s){const o=s.filter(r=>r.nodeId===t.nodeId).map(r=>{const i=this.projectSubProjectSerializer.fromJson(),n=Object.keys(r);for(const d of n)i.hasOwnProperty(d)&&this.setProp(i,r,d);return i});return 1===o.length?o[0]:null}mapResources(t,s){return s.filter(r=>r.nodeId===t.nodeId).map(r=>{const i=this.resProfSerializer.fromJson(),n=Object.keys(r);for(const P of n)i.hasOwnProperty(P)&&this.setProp(i,r,P);const d=this.resSerializer.fromJson();return d.profile=i,d.id=r.id,d.view.color.color=r.colorV,d.view.color.backgroundcolor=r.backgroundcolor,d})}mapRoles(t,s){return s.filter(r=>r.nodeId===t.nodeId).map(r=>{const i=this.roleSerializer.fromJson(),n=Object.keys(r);for(const d of n)i.hasOwnProperty(d)&&this.setProp(i,i,d);return i.view.color=r.backgroundcolor,i})}mapPhases(t,s){return s.filter(r=>r.nodeId===t.nodeId).map(r=>{const i=this.phaseSerializer.fromJson(),n=Object.keys(r);for(const d of n)i.hasOwnProperty(d)&&this.setProp(i,r,d);return i.view.color.color=r.colorV,i.view.color.backgroundcolor=r.backgroundcolor,i})}mapResourceRoles(t,s,o){const r=this.roleSumSerializer;s.filter(i=>i.nodeId===t.nodeId).forEach(i=>{const n=o.find(b=>b.id===i.resourceId),d=r.fromJson(),P=Object.keys(i);for(const b of P)d.hasOwnProperty(b)&&this.setProp(d,i,b);d.color=i.colorV,n?.assign.roles.push(d)})}mapActivityResources(t,s,o){const r=this.resSumSerializer;s.filter(i=>i.nodeId===t.nodeId).forEach(i=>{const n=o.find(b=>b.profile.id===i.activityId),d=r.fromJson(),P=Object.keys(i);for(const b of P)d.hasOwnProperty(b)&&this.setProp(d,i,b);d.color.color=i.colorV,d.color.backgroundcolor=i.backgroundcolor,n?.assign.resources.push(d)})}mapActivityPhases(t,s,o){}mapActivities(t,s,o){const r=this.asResSerializer;return s.filter(n=>n.nodeId===t.nodeId).map(n=>{const d=this.actSerializer.fromJson(),P=this.actProfSerializer.fromJson(),b=Object.keys(n);for(const z of b)P.hasOwnProperty(z)&&this.setProp(P,n,z);d.profile=P;const w=o.filter(z=>z.nodeId===t.nodeId).find(z=>z.id===n.id);if(w){const z=this.chartSerializer.fromJson(),C=Object.keys(w);for(const M of C)z.hasOwnProperty(M)&&this.setProp(z,w,M);d.chartInfo=z}return n.assign=r.fromJson(),this.setActivityDates(d),d}).filter(n=>void 0!==n.chartInfo.source_id&&n.chartInfo.source_id!==n.chartInfo.target_id||void 0===n.chartInfo.source_id)}setActivityDates(t){}mapIntegrations(t,s){return s.filter(r=>r.nodeId===t.nodeId).map(r=>{const i=this.intSerializer.fromJson(),n=Object.keys(r);for(const d of n)i.hasOwnProperty(d)&&this.setProp(i,r,d);return i})}getHistoryEntryWorkbook(t){const s=t.data,o={name:t.name,nodeId:t.id,group:t.group,subgroup:t.subgroup,parentNodeId:t.parentNodeId},r=s.activities.map(l=>({...l.profile,graphId:s.profile.id,nodeId:o.nodeId})),i=s.activities.map(l=>({...l.chartInfo,id:l.profile.id,graphId:s.profile.id,nodeId:o.nodeId})),n=s.integrations.map(l=>({...l,nodeId:o.nodeId})),d={...s.profile,...o},P={...s.profile.subProject,graphId:s.profile.id,nodeId:o.nodeId},b=s.phases.map(l=>({...l,backgroundcolor:l.view.color.backgroundcolor,colorV:l.view.color.color,view:void 0,graphId:s.profile.id,nodeId:o.nodeId})),w=s.resources.map(l=>({...l.profile,colorV:l.view.color.color,backgroundcolor:l.view.color.backgroundcolor,id:l.id,graphId:s.profile.id,nodeId:o.nodeId})),z=s.roles.map(l=>({...l,backgroundcolor:l.view.color.backgroundcolor,colorV:l.view.color.color,view:void 0,graphId:s.profile.id,nodeId:o.nodeId}));let C=[],M=[];s.tags&&s.tags.map(l=>l.tags.map(N=>({...N,group:l.name,graphId:s.profile.id,nodeId:o.nodeId}))).map(l=>M=[...l,...M]),s.activities.map(l=>l.assign.phases.map(N=>({...N,activityId:l.profile.id,graphId:s.profile.id,nodeId:o.nodeId}))).map(l=>C=[...l,...C]);let L=[];s.activities.map(l=>l.assign.resources.map(N=>({...N,colorV:N.color.color,backgroundcolor:N.color.backgroundcolor,activityId:l.profile.id,graphId:s.profile.id,nodeId:o.nodeId}))).map(l=>L=[...l,...L]);let A=[];s.resources.map(l=>l.assign.roles.map(N=>({...N,resourceId:l.id,graphId:s.profile.id,nodeId:o.nodeId}))).map(l=>A=[...l,...A]);const J=[];return s.activities.forEach(l=>{l.tags?.forEach(N=>{N.tags.forEach(R=>{J.push({...R,group:N.name,activityId:l.profile.id,graphId:s.profile.id,nodeId:o.nodeId})})})}),{profiles:r,nodes:n,chartInfos:i,projProfile:d,phases:b,resources:w,roles:z,activityPhases:C,activityResources:L,resourceRoles:A,tagPool:M,activityTags:J,subProject:P}}static#t=this.\u0275fac=function(s){return new(s||O)(h.LFG(a.z),h.LFG(a._),h.LFG(g.Q),h.LFG(I.Ne),h.LFG(I.H4),h.LFG(I.k1),h.LFG(p.Jl),h.LFG(u.Ek),h.LFG(p.tB),h.LFG(D.e),h.LFG(y.w),h.LFG(j.C),h.LFG(_.I),h.LFG(v.i),h.LFG(S.M))};static#e=this.\u0275prov=h.Yz7({token:O,factory:O.\u0275fac,providedIn:"root"})}return O})()},6602:(F,T,c)=>{c.d(T,{W:()=>D});var f=c(2119),h=c(9212),a=c(9728),I=c(6399),p=c(96),u=c(9680);let D=(()=>{class y{constructor(_,v,S,g,m){this.storageApi=_,this.mapper=v,this.projSerializer=S,this.treeSerializer=g,this.sanitizer=m}import(_){return this.importFromProjectList(_)}importFromTreeNodeList(_){return new Promise((v,S)=>{const g=new FileReader;g.readAsText(_),g.onload=m=>{const t=JSON.parse(m.target.result).map(s=>this.mapper.mapTreeNode(s));v(t)}})}importFromProjectList(_){return new Promise((v,S)=>{const g=new FileReader;g.readAsText(_),g.onload=m=>{const e=JSON.parse(m.target.result),t=new f.z,s=e.map(n=>t.fromJson(n)),i=[this.mapper.createTreeHeadNode(),...s.map(n=>this.mapper.mapProjectToNode(n))];v(i)}})}export(_){const v=_.map(O=>{const e=this.treeSerializer.fromJson(O);if(e.children=[],e.parent=null,O.data){const t=this.projSerializer.fromJson(O.data);this.sanitizer.sanatizeForSave(t),e.data=t}return e}),S=JSON.stringify(v),g=new Blob([S],{type:"application/json"}),m=document.createElement("a");m.href=window.URL.createObjectURL(g),m.download="data.json",m.click()}importTree(_){return new Promise((v,S)=>{const g=new FileReader;g.readAsText(_),g.onload=m=>{const e=JSON.parse(m.target.result);v(e)}})}static#t=this.\u0275fac=function(v){return new(v||y)(h.LFG(a.K),h.LFG(I.h),h.LFG(f.z),h.LFG(p.Q),h.LFG(u.B))};static#e=this.\u0275prov=h.Yz7({token:y,factory:y.\u0275fac,providedIn:"root"})}return y})()},96:(F,T,c)=>{c.d(T,{Q:()=>h});var f=c(9212);let h=(()=>{class a{fromJson(p){return p=p??{},{name:p?.name??null,group:p?.group??null,subgroup:p?.subgroup??null,metadata:p?.metadata??null,data:p?.data??null,children:p?.children??[],id:p?.id??null,parent:p.parent??null,parentNodeId:p?.parentNodeId??null}}toJson(p){}head(){return{id:0,group:0,subgroup:0,name:"head",data:null,children:[],parent:null,metadata:null,parentNodeId:null}}static#t=this.\u0275fac=function(u){return new(u||a)};static#e=this.\u0275prov=f.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"})}return a})()}}]);