"use strict";(self.webpackChunkcritical_web=self.webpackChunkcritical_web||[]).push([[249],{7249:(It,F,i)=>{i.r(F),i.d(F,{HistoryModule:()=>Dt});var M=i(6814),j=i(7586),I=i(7778),Y=i(4347),Q=i(3994),u=i(3633),L=i(2181),O=i(4595),t=i(9212),$=i(2357),N=i(7007),E=i(1970),R=i(5269),W=i(5861),Z=i(3830),G=i(6181),r=i(4403),X=i(2119),K=i(9680),V=i(7649),q=i(2787),tt=i(2425),ot=i(155),a=i(1486),et=i(6399);let nt=(()=>{class s{constructor(o){this.mapper=o}export(o,n="history"){let e=[],c=[],l=[],p=[],d=[],v=[],y=[],m=[],b=[],_=[],P=[],x=[],C=[];for(const zt of o){const g=this.mapper.getHistoryEntryWorkbook(zt);e=[...e,...g.profiles],c=[...c,...g.chartInfos],l=[...l,...g.nodes],p=[...p,g.projProfile],d=[...d,g.subProject],v=[...v,...g.phases],y=[...y,...g.roles],m=[...m,...g.resources],b=[...b,...g.activityResources],_=[..._,...g.activityPhases],P=[...P,...g.resourceRoles],C=[...C,...g.tagPool],x=[...x,...g.activityTags]}const T=a.P6.json_to_sheet(e),k=a.P6.json_to_sheet(l),w=a.P6.json_to_sheet(c),H=a.P6.json_to_sheet(p),J=a.P6.json_to_sheet(d),D=a.P6.json_to_sheet(v),S=a.P6.json_to_sheet(y),B=a.P6.json_to_sheet(m),St=a.P6.json_to_sheet(b),Bt=a.P6.json_to_sheet(_),Ft=a.P6.json_to_sheet(P),Nt=a.P6.json_to_sheet(C),Wt=a.P6.json_to_sheet(x),h=a.P6.book_new();a.P6.book_append_sheet(h,T,r.SI),a.P6.book_append_sheet(h,w,r.tu),a.P6.book_append_sheet(h,k,r.dt),a.P6.book_append_sheet(h,H,r.nE),a.P6.book_append_sheet(h,J,r.N4),a.P6.book_append_sheet(h,D,r.nQ),a.P6.book_append_sheet(h,S,r.FU),a.P6.book_append_sheet(h,B,r.u_),a.P6.book_append_sheet(h,St,r.vx),a.P6.book_append_sheet(h,Bt,r.Lc),a.P6.book_append_sheet(h,Ft,r._w),a.P6.book_append_sheet(h,Nt,r.Nz),a.P6.book_append_sheet(h,Wt,r.MP),a.NC(h,`${n}.cp.xlsx`)}import(o){return new Promise((n,e)=>{const c=new FileReader;c.readAsBinaryString(o),c.onload=l=>{const d=a.ij(l.target.result,{type:"binary",cellDates:!0}),v=this.getWorksheetData(d,r.SI),y=this.getWorksheetData(d,r.tu),m=this.getWorksheetData(d,r.dt),b=this.getWorksheetData(d,r.nE),_=this.getWorksheetData(d,r.N4),D={phaseData:this.getWorksheetData(d,r.nQ),rolesData:this.getWorksheetData(d,r.FU),resourcesData:this.getWorksheetData(d,r.u_),activityResourceData:this.getWorksheetData(d,r.vx),activityPhaseData:this.getWorksheetData(d,r.Lc),resourceRoleData:this.getWorksheetData(d,r._w),activityData:v,arrowData:y,integrationData:m,tagPoolData:this.getWorksheetData(d,r.Nz),activityTagData:this.getWorksheetData(d,r.MP),subProjectData:_},S=b.map(B=>this.mapper.getNode(B,D));n(S)}})}getWorksheetData(o,n){return a.P6.sheet_to_json(o.Sheets[n])}static#t=this.\u0275fac=function(n){return new(n||s)(t.LFG(et.h))};static#o=this.\u0275prov=t.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})();var st=i(6602),it=i(9975),U=i(2596),A=i(6223),rt=i(2671);function at(s,f){if(1&s){const o=t.EpF();t.TgZ(0,"i",25),t.NdJ("click",function(){t.CHM(o);const e=t.oxw();return t.KtG(e.redo())}),t.qZA()}}function ct(s,f){1&s&&t._UZ(0,"i",26)}function lt(s,f){if(1&s){const o=t.EpF();t.TgZ(0,"i",27),t.NdJ("click",function(){t.CHM(o);const e=t.oxw();return t.KtG(e.undo())}),t.qZA()}}function dt(s,f){1&s&&t._UZ(0,"i",28)}function pt(s,f){if(1&s){const o=t.EpF();t.TgZ(0,"i",29),t.NdJ("click",function(){t.CHM(o);const e=t.oxw();return t.KtG(e.showPeek=!1)}),t.qZA()}}function ht(s,f){if(1&s){const o=t.EpF();t.TgZ(0,"i",30),t.NdJ("click",function(){t.CHM(o);const e=t.oxw();return t.KtG(e.peekStorage())}),t.qZA()}}function gt(s,f){if(1&s&&(t.TgZ(0,"div",31),t._UZ(1,"cp-arrow-snapshot",32),t.qZA()),2&s){const o=t.oxw();t.xp6(1),t.Q6J("project",o.peekProj)("width",390)("height",250)}}let ut=(()=>{class s extends G.O{constructor(o,n,e,c,l,p,d,v,y,m,b,_,P,x,C,T){super(o,n,e,c,l,p,d,v,T),this.zametekApi=y,this.fCompiler=m,this.fileManager=b,this.jsonFileManager=_,this.treeNodeSerializer=P,this.dependencyCrawler=x,this.historyApi=C,this.fileType=r.S6.JSON,this.isSelFileType=!1,this.resourceCount=null,this.allowSave=!1,this.saveMenuHeight="50px",this.inferDeps=!0,this.isProcessing=!1,e.get(O.cu).subscribe(k=>{this.history=k})}unstashTree(){var o=this;return(0,W.Z)(function*(){o.showPeek=!1,o.showPeek=!1;try{const n=yield o.storageApi.get(Z.H3);if(null!==n){o.dashboard.updateProject(n,!1);const e=o.treeNodeSerializer.head();e.data=n,o.eventService.get(O.kV).next([e])}}catch(n){return o.toastr.error("Unstash Chart","Error occured."),void console.error(n)}o.toastr.success("Unstash Chart","Success!")})()}downloadHistory(o){o===r.S6.XLSX?this.fileManager.export(this.history):o===r.S6.JSON?this.jsonFileManager.export(this.history):o===r.S6.ELECTRON_SAVE&&this.historyApi.post(this.project.profile.id,this.history).subscribe(n=>{this.ngZone.run(()=>{n?this.toastr.success("History saved","Success"):this.toastr.error("History not saved","Error")})})}loadFile(o){const n=o.name.split(".").pop();n===r.S6.XLSX?this.fileManager.import(o).then(e=>{this.eventService.get(O.kV).next(e)}):n===r.S6.JSON&&this.jsonFileManager.importFromTreeNodeList(o).then(e=>{this.eventService.get(O.kV).next(e)})}autoAssignResourceCount(){const o=this.dashboard.activeProject$.value;this.isProcessing=!0,null!==o&&this.inferDeps&&this.dependencyCrawler.setDependencyDataFromGraph(o),this.zametekApi.autoAssignResourceCount(this.dashboard.activeProject$.value,this.resourceCount).subscribe(n=>{null!==n&&(this.fCompiler.compileProjectFromFile(n),this.dashboard.updateProject(n,!0)),this.toastr.success("Auto assign resources succeeded.","Resources Assigned."),this.isProcessing=!1},n=>{this.toastr.error("Auto assign resources failed.","Error occured."),console.error(n),this.isProcessing=!1})}navToSingleGraph(){this.router.navigateByUrl(`history/(${this.id}//sidebar:arrow/${this.id})`)}navToMetaGraph(){this.router.navigateByUrl(`history/(${this.id}//sidebar:lasso/${this.id})`)}ngOnDestroy(){super.ngOnDestroy()}static#t=this.\u0275fac=function(n){return new(n||s)(t.Y36(j.F0),t.Y36(u.Ou),t.Y36(u.WO),t.Y36(X.z),t.Y36(K.B),t.Y36(tt._W),t.Y36(u.$y),t.Y36(u.$6),t.Y36(ot.v),t.Y36(V.h),t.Y36(nt),t.Y36(st.W),t.Y36(it.Q),t.Y36(q.v),t.Y36(u.gF),t.Y36(t.R0b))};static#o=this.\u0275cmp=t.Xpm({type:s,selectors:[["cp-history-action-buttons"]],features:[t.qOj],decls:39,vars:26,consts:[[1,"btn-row"],["href","javascript:void(0)",1,"btn","btn-secondary",3,"click"],[1,"undo-redo"],["class","fas fa-redo",3,"click",4,"ngIf"],["class","fas fa-redo disabled",4,"ngIf"],["class","fas fa-undo",3,"click",4,"ngIf"],["class","fas fa-undo disabled",4,"ngIf"],[1,"baseline"],["type","number",1,"auto-resources",3,"ngModel","ngModelChange"],["matTooltip","Existing assignments override the auto resource number",1,"btn","btn-secondary",3,"click"],["tooltip","matTooltip"],[1,"custom-control","custom-checkbox"],["type","checkbox","id","infer",1,"custom-control-input",3,"ngModel","ngModelChange"],["for","infer",1,"custom-control-label"],[1,"stash"],["href","javascript:void(0)",1,"btn","border-right",3,"click"],["href","javascript:void(0)",1,"btn",3,"click"],["href","javascript:void(0)",1,"btn"],["class","fas fa-chevron-up",3,"click",4,"ngIf"],["class","fas fa-chevron-down",3,"click",4,"ngIf"],["class","peek",4,"ngIf"],[3,"disableButtons","enableSave","save","load"],[1,"alert-msg",3,"hidden"],[1,"overlay",3,"hidden"],[1,"overlay-txt"],[1,"fas","fa-redo",3,"click"],[1,"fas","fa-redo","disabled"],[1,"fas","fa-undo",3,"click"],[1,"fas","fa-undo","disabled"],[1,"fas","fa-chevron-up",3,"click"],[1,"fas","fa-chevron-down",3,"click"],[1,"peek"],[3,"project","width","height"]],template:function(n,e){1&n&&(t.TgZ(0,"div",0)(1,"div")(2,"a",1),t.NdJ("click",function(){return e.navToSingleGraph()}),t._uU(3,"Base Controls"),t.qZA(),t.TgZ(4,"a",1),t.NdJ("click",function(){return e.navToMetaGraph()}),t._uU(5,"Meta Controls"),t.qZA()(),t.TgZ(6,"div",2),t.YNc(7,at,1,0,"i",3)(8,ct,1,0,"i",4)(9,lt,1,0,"i",5)(10,dt,1,0,"i",6),t.qZA(),t.TgZ(11,"div",7)(12,"input",8),t.NdJ("ngModelChange",function(l){return e.resourceCount=l}),t.qZA(),t.TgZ(13,"button",9,10),t.NdJ("click",function(){return e.autoAssignResourceCount()}),t._uU(15," Set Resource Count "),t.qZA(),t.TgZ(16,"div",11)(17,"input",12),t.NdJ("ngModelChange",function(l){return e.inferDeps=l}),t.qZA(),t.TgZ(18,"label",13),t._uU(19,"Infer Dependencies"),t.qZA()()(),t.TgZ(20,"div")(21,"div",14)(22,"a",15),t.NdJ("click",function(){return!e.disableButtons&&e.stash()}),t._uU(23,"Stash"),t.qZA(),t.TgZ(24,"a",16),t.NdJ("click",function(){return!e.disableButtons&&e.unstashTree()}),t._uU(25," Unstash"),t.qZA(),t.TgZ(26,"a",17),t.YNc(27,pt,1,0,"i",18)(28,ht,1,0,"i",19),t.qZA(),t.YNc(29,gt,2,3,"div",20),t.qZA(),t.TgZ(30,"da-file-action-buttons",21),t.NdJ("save",function(l){return e.downloadHistory(l)})("load",function(l){return e.loadFile(l)}),t.qZA()()(),t.TgZ(31,"div",22),t._uU(32),t.qZA(),t.TgZ(33,"div",23)(34,"div",24),t._uU(35),t.qZA()(),t.TgZ(36,"div",23)(37,"div",24),t._uU(38,"Processing"),t.qZA()()),2&n&&(t.xp6(7),t.Q6J("ngIf",e.canRedo),t.xp6(1),t.Q6J("ngIf",!e.canRedo),t.xp6(1),t.Q6J("ngIf",e.canUndo),t.xp6(1),t.Q6J("ngIf",!e.canUndo),t.xp6(2),t.Q6J("ngModel",e.resourceCount),t.xp6(1),t.ekj("disabled",e.disableButtons),t.xp6(4),t.Q6J("ngModel",e.inferDeps),t.xp6(5),t.ekj("disabled",e.disableButtons),t.xp6(2),t.ekj("disabled",e.disableButtons),t.xp6(3),t.Q6J("ngIf",e.showPeek),t.xp6(1),t.Q6J("ngIf",!e.showPeek),t.xp6(1),t.Q6J("ngIf",e.showPeek),t.xp6(1),t.Q6J("disableButtons",e.disableButtons)("enableSave",!!e.history),t.xp6(1),t.ekj("success","Saved"==e.alertMessage)("error","Error"==e.alertMessage),t.Q6J("hidden",""==e.alertMessage),t.xp6(1),t.Oqu(e.alertMessage),t.xp6(1),t.Q6J("hidden",""===e.actionText),t.xp6(2),t.Oqu(e.actionText),t.xp6(1),t.Q6J("hidden",!e.isProcessing))},dependencies:[M.O5,U.gM,N.J,A.Fj,A.wV,A.Wl,A.JJ,A.On,rt.D],styles:[".btn-secondary[_ngcontent-%COMP%]{border:1px solid #ddd;border-radius:2px;background-color:#f9f9f9;color:#666}.btn-secondary[_ngcontent-%COMP%]:hover{color:#fff;background-color:#5a6268;border-color:#545b62}.btn[_ngcontent-%COMP%]{font-size:.87rem}.border-right[_ngcontent-%COMP%]{border-right:1px solid #333}.stash[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{color:#45f}.btn-row[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between}.btn-row[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;flex-direction:row}.btn-row[_ngcontent-%COMP%]   div[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{margin:0 7px}.btn-row[_ngcontent-%COMP%]   div.file-types[_ngcontent-%COMP%]{display:block}.btn-row[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{margin:0 5px}.btn-row[_ngcontent-%COMP%]   .stash[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{margin:0}.btn-row[_ngcontent-%COMP%]   .btns[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}.btn-row[_ngcontent-%COMP%]   .btns[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{padding-top:3px}.help-btn[_ngcontent-%COMP%]{color:#999;cursor:pointer}.peek[_ngcontent-%COMP%]{width:410px;height:270px;position:absolute;border:1px solid #e9e9e9;z-index:1;background-color:#f9f9f9;top:38px;display:flex;align-items:center;justify-content:center}.file-types[_ngcontent-%COMP%]{width:88px;height:70px;position:absolute;border:1px solid #e9e9e9;z-index:1;background-color:#f9f9f9;top:34px;margin-left:-20px}.stash[_ngcontent-%COMP%], .pos-rel[_ngcontent-%COMP%]{position:relative}.help[_ngcontent-%COMP%]{position:absolute;top:18px;right:0;width:400px;height:auto;background-color:#fff;border-radius:5px;z-index:1000;padding:20px;box-shadow:1px 3px 5px #0000006b}.help[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{position:absolute;padding-top:10px}.help-container[_ngcontent-%COMP%]{position:relative}.help-close[_ngcontent-%COMP%]{position:absolute;right:13px;cursor:pointer;top:13px}.help-pointer[_ngcontent-%COMP%]{cursor:pointer;color:#999}.help-list[_ngcontent-%COMP%]{padding:55px 49px 35px}.alert-msg[_ngcontent-%COMP%]{background:#4a4;border:1px solid #ddd;position:fixed;height:70px;width:102px;text-align:center;vertical-align:center;padding-top:19px;left:50%;color:#fff;top:50%;font-size:18px;border-radius:15px;z-index:2000}.saved[_ngcontent-%COMP%]{background:#4a4;border:1px solid #ddd}.error[_ngcontent-%COMP%]{background:#a44;border:1px solid #ddd}.save-proj[_ngcontent-%COMP%]{display:inline}a.btn-primary[_ngcontent-%COMP%]{color:#fff}.top-buttons[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.overlay[_ngcontent-%COMP%]{position:fixed;width:100vw;height:100vh;inset:0;color:#fff;background-color:#00000080;z-index:100000;cursor:pointer}.overlay-txt[_ngcontent-%COMP%]{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);font-size:20px;font-weight:700}.btn-secondary.disabled[_ngcontent-%COMP%], .btn-secondary[_ngcontent-%COMP%]:disabled{color:#fff;background-color:#6c757d;border-color:#6c757d}.file-input[_ngcontent-%COMP%]{display:none}.baseline[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:baseline}.auto-resources[_ngcontent-%COMP%]{width:42px;height:30px;border:1px solid #ccc;text-align:right}.btn-row[_ngcontent-%COMP%]   div.baseline[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{margin:0 2px}.undo-redo[_ngcontent-%COMP%]{align-items:center;gap:7px}.undo-redo[_ngcontent-%COMP%] > i[_ngcontent-%COMP%]{cursor:pointer}.undo-redo[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]{color:#999;cursor:not-allowed}.overlay[_ngcontent-%COMP%]{position:fixed;top:0;width:100%;height:100%;background-color:#00000080}.overlay-txt[_ngcontent-%COMP%]{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);font-size:20px;font-weight:700;color:#fff}"]})}return s})();const ft=s=>({"selected-chart":s});function vt(s,f){if(1&s){const o=t.EpF();t.TgZ(0,"div",12),t.ALo(1,"async"),t.TgZ(2,"a",13),t.NdJ("click",function(){const c=t.CHM(o).$implicit,l=t.oxw(2);return t.KtG(l.load(c))}),t._UZ(3,"cp-arrow-snapshot",14),t.qZA()()}if(2&s){const o=f.$implicit,n=t.oxw(2);t.Q6J("ngClass",t.VKq(6,ft,t.lcZ(1,4,n.selectedTreeNode$)===o.id)),t.xp6(3),t.Q6J("project",o.data)("width",300)("height",200)}}function yt(s,f){if(1&s&&(t.ynx(0),t.TgZ(1,"div",2)(2,"div",3),t._UZ(3,"cp-history-action-buttons",4),t.qZA(),t.TgZ(4,"div",5),t._UZ(5,"cp-arrow-chart",6),t.qZA(),t.TgZ(6,"div",7)(7,"div",8),t._UZ(8,"cp-tree-buttons"),t.qZA(),t.TgZ(9,"div",8),t._UZ(10,"cp-project-tree",9),t.qZA(),t._UZ(11,"div",8),t.qZA(),t.TgZ(12,"div",10),t.YNc(13,vt,4,8,"div",11),t.ALo(14,"async"),t.qZA()(),t.BQk()),2&s){const o=t.oxw();t.xp6(3),t.Q6J("id",o.id),t.xp6(2),t.Q6J("id",o.id)("width",1214)("height",700)("rebuild",!0),t.xp6(5),t.Q6J("width",390)("height",700)("id",o.id),t.xp6(3),t.Q6J("ngForOf",t.lcZ(14,9,o.historyArray$))}}function mt(s,f){1&s&&(t.TgZ(0,"div",15),t._uU(1,"Loading..."),t.qZA())}let bt=(()=>{class s{constructor(o,n,e){this.dashboard=n,this.eventService=e,this.refresh=0,this.id=+o.snapshot.params.id,this.project$=this.dashboard.activeProject$,this.historyArray$=this.eventService.get(O.cu),this.selectedTreeNode$=this.eventService.get(O.Xq)}ngOnInit(){this.subscription=this.project$.pipe((0,L.h)(o=>!!o)).subscribe(o=>this.refresh++)}canDeactivate(){return this.refresh<2}load(o){this.dashboard.resetUndoRedo(),this.dashboard.updateProject(o.data,!1),this.selectedTreeNode$.next(o.id)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe(),this.dashboard.resetUndoRedo(),this.eventService.onDestroy()}static#t=this.\u0275fac=function(n){return new(n||s)(t.Y36(j.gz),t.Y36(u.Ou),t.Y36(u.WO))};static#o=this.\u0275cmp=t.Xpm({type:s,selectors:[["cp-history-layout"]],decls:4,vars:4,consts:[[4,"ngIf","ngIfElse"],["loading",""],[1,"page-content"],[1,"action-buttons"],[3,"id"],[1,"current-view"],[3,"id","width","height","rebuild"],[1,"right-content"],[1,"sb-chart"],[3,"width","height","id"],[1,"snapshots"],["class","sb-chart default-border",3,"ngClass",4,"ngFor","ngForOf"],[1,"sb-chart","default-border",3,"ngClass"],[3,"click"],[3,"project","width","height"],[1,"loader"]],template:function(n,e){if(1&n&&(t.YNc(0,yt,15,11,"ng-container",0),t.ALo(1,"async"),t.YNc(2,mt,2,0,"ng-template",null,1,t.W1O)),2&n){const c=t.MAs(3);t.Q6J("ngIf",!!t.lcZ(1,2,e.project$))("ngIfElse",c)}},dependencies:[M.mk,M.sg,M.O5,$.w,N.J,E.P,R.u,ut,M.Ov],styles:["cp-history-layout{z-index:0}cp-history-layout *{padding:0;margin:0}cp-history-layout .current-view{grid-row:2/-1;grid-column:1/4;height:700px}cp-history-layout .current-view{height:700px}cp-history-layout .page-content{grid-row:2/-1;grid-column:2/-1;display:grid;grid-gap:20px;margin:12px}cp-history-layout .page-content{grid-template-columns:repeat(4,1fr);grid-template-rows:18px auto;background-color:#f9f9f9}cp-history-layout .page-content{padding:15px 15px 0;min-width:1655px;min-height:945px}cp-history-layout .action-buttons{grid-row:1/2;grid-column:1/4}cp-history-layout .action-buttons{margin-top:-5px}cp-history-layout .right-content{display:flex;flex-direction:column;grid-row:1/-1}cp-history-layout [hidden]{display:none}cp-history-layout .loader{position:absolute;top:48%;left:calc(50% + 115px);transform:translate(-50%,-50%)}cp-history-layout cp-arrow-chart{position:relative;display:block}cp-history-layout .snapshots{display:grid;grid-column:1/-1;grid-template-columns:repeat(5,1fr);grid-gap:15px}cp-history-layout .default-border{border:3px solid white;background-color:#fff}cp-history-layout .selected-chart{border:3px solid red;background-color:#fff}\n"],encapsulation:2})}return s})();var z=i(1374),_t=i(9397),Pt=i(9315),xt=i(8962);let Ct=(()=>{class s{constructor(o,n,e,c,l,p){this.dashboard=o,this.projectApi=n,this.storageApi=e,this.historyApi=c,this.eventService=l,this.nodeConnector=p}resolve(o){var n=this;return(0,W.Z)(function*(){if(n.dashboard.secondaryProject$.next(null),+o.params.id===Z.ph){const e=yield n.storageApi.get(Z._k);return null!==e&&(e.profile.view.autoZoom=!0,n.dashboard.cleanSlateForNewPage(e)),n.dashboard.activeProject$.pipe((0,z.P)()).toPromise()}{const e=n.projectApi.get(o.params.id),c=n.historyApi.get(o.params.id);return(0,Pt.D)([e,c]).pipe((0,_t.b)(([l,p])=>{p&&p.length>0?(n.importHistory(p),n.eventService.get("project.tree.history.file").next(p)):(n.nodeConnector.connectArrowsToNodes(l),n.dashboard.initializeActiveProject(l),n.eventService.get("project.tree.history.file").next(null))}),(0,z.P)()).toPromise()}})()}importHistory(o){o.forEach(n=>{this.nodeConnector.connectArrowsToNodes(n.data)})}static#t=this.\u0275fac=function(n){return new(n||s)(t.LFG(u.Ou),t.LFG(u.$6),t.LFG(u.$y),t.LFG(u.gF),t.LFG(u.WO),t.LFG(xt.E))};static#o=this.\u0275prov=t.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})();var Mt=i(5836);const Ot=[{path:"",component:I.r,children:[{path:":id",component:bt,resolve:{items:Ct},canDeactivate:[Mt.I]},{path:"arrow/:id",component:Y.m,outlet:"sidebar"},{path:"lasso/:id",component:Q.l,outlet:"sidebar"}]}];let At=(()=>{class s{static#t=this.\u0275fac=function(n){return new(n||s)};static#o=this.\u0275mod=t.oAB({type:s});static#e=this.\u0275inj=t.cJS({imports:[j.Bz.forChild(Ot),j.Bz]})}return s})();var Tt=i(5547),kt=i(1281),jt=i(2457),Zt=i(3680),wt=i(5616),Ht=i(2032),Jt=i(5488);let Dt=(()=>{class s{static#t=this.\u0275fac=function(n){return new(n||s)};static#o=this.\u0275mod=t.oAB({type:s});static#e=this.\u0275inj=t.cJS({imports:[M.ez,At,wt.FA,Ht.c,Zt.XK,U.AV,Tt.S,kt.E,jt.n,A.u5,Jt.L]})}return s})()}}]);