<ng-container *ngIf="!showLoading; else loadingMsg">
    <div class="page">
        <main>
            <div class="container">
                <div class="row video-ui">
                    <div class="col-xl-3 col-lg-12" [hidden]="isAuthorized || loginError">
                        <div>
                            <div>Welcome</div>
                            <h4 class="alert-text">You are not yet authorized</h4>
                            <div>You have created an account but still need to request authorization.</div>
                            <div class="contact">Contact <span class="address"> info&#64;criticalpath.design </span> to request access</div>
                            <button class="logout-btn" (click)="logout()">Logout</button>
                        </div>
                    </div>
                    <div class="col-xl-3 col-lg-12 col-sm-12" [hidden]="!isAuthorized && !loginError">
                        <div>
                            <h2>Welcome {{ name }}</h2>
                            <div>
                                To get started, watch a training video or dive into an example project by clicking a chart. Click the right menu to see more
                                videos. A link to the library of examples is provided below. Once you are ready click on the "Open App" button below.
                            </div>
                            <div>
                                <button class="lib-btn" [ngClass]="{ disabled: !isAuthorized }" (click)="loadLibrary()">Open App</button>
                            </div>
                            <div>
                                <button class="logout-btn" (click)="logout()">Logout</button>
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-8 col-lg-12">
                        <div *ngIf="isAuthorized && !loginError" class="materials row">
                            <div class="col-xl-11 col-lg-12">
                                <h3>Training Videos</h3>
                                <div class="video">
                                    <div>
                                        <iframe
                                            width="860"
                                            height="505"
                                            [src]="selectedVideo.src"
                                            title="{{selectedVideo.videoTitle}}"
                                            frameborder="0"
                                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                                            referrerpolicy="strict-origin-when-cross-origin"
                                            allowfullscreen
                                        ></iframe>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-1 col-lg-12 menu">
                                <div class="video-list">
                                    @for(video of videos; track video){
                                    <div (click)="selectedVideo = video" [ngClass]="{'selected': selectedVideo === video}">{{video.menuName}}</div>
                                    }
                                    <div>
                                        <a routerLink="/tutorials">More Videos...</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row pt-4">
                            <div class="col-12">
                                <h3>Example Projects</h3>
                                <a (click)="navigateToExamples()" [hidden]="projectLoadState !== 'success'"href="javascript:void(0)">More Examples</a>
                                <div>
                                    <div [ngSwitch]="projectLoadState">
                                        <div *ngSwitchCase="'loading'">
                                            <div class="page-content">
                                                <div class="loading-placeholder"></div>
                                                <div class="loading-txt">Loading</div>
                                            </div>
                                        </div>
                                        <div *ngSwitchCase="'error'">
                                            <div class="page-content">
                                                <div class="loading-placeholder"></div>
                                                <div class="loading-txt error">We were unable to load the sample projects</div>
                                            </div>
                                        </div>
                                        <div *ngSwitchCase="'success'">
                                            <div class="page-content" *ngIf="projects?.length === 0">
                                                <div class="loading-placeholder"></div>
                                                <div class="loading-txt error">No Example Projects Avaiable</div>
                                            </div>
                                            <div *ngIf="projects.length > 0" class="page-content">
                                                <div *ngFor="let project of projects" class="user-proj">
                                                    <a (click)="navigate(project.profile.id)">
                                                        <cp-arrow-snapshot [project]="project" [width]="330" [height]="220"></cp-arrow-snapshot>
                                                    </a>
                                                    <div class="simple-label">{{ project.profile.name }} <span class="is-writable"> (w)</span></div>
                                                    <div class="project-description">
                                                        <i class="fa fa-code-fork network-icon" (click)="navigateSketch(project.profile.id)"></i>
                                                        <i class="fas fa-male assign-icon" (click)="navigateAssign(project.profile.id)"></i>
                                                        <i class="fa fa-network-wired" (click)="navigateMetaGraph(project.profile.id)"></i>
                                                        {{ project.profile.description }}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div *ngSwitchDefault>
                                            <div class="page-content">
                                                <div class="loading-txt error">Unloaded</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
</ng-container>
<ng-template #loadingMsg>
    <div class="loading-container">
        <div class="loading-msg">Loading...</div>
    </div>
</ng-template>
