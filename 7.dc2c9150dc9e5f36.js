"use strict";(self.webpackChunkcritical_web=self.webpackChunkcritical_web||[]).push([[7],{2357:(Ht,Ct,X)=>{X.d(Ct,{w:()=>ce});var C=X(9212),v=X(3920),q=X(4595),Bt=X(5619),Z=X(2181),et=X(3633),L=X(4745),z=X(9989);let nt=(()=>{class G{constructor(){}getNodeById(s,f){return f.integrations.find(m=>m.id===s)}getInEdges(s,f){return f.activities.filter(m=>m.chartInfo.target_id===s)}getOutEdges(s,f){return f.activities.filter(m=>m.chartInfo.source_id===s)}joinNodes(s,f,m){const S=this.getInEdges(s.id,m),D=this.getOutEdges(s.id,m);for(const B of S)B.chartInfo.target_id=f.id,B.chartInfo.target=f;for(const B of D)B.chartInfo.source_id=f.id,B.chartInfo.source=f;m.integrations.splice(m.integrations.indexOf(s),1)}splitUpNode(s,f){if(null==s)return null;const m=this.getInEdges(s.id,f),S=this.getOutEdges(s.id,f);let D=Math.max(...f.integrations.map(A=>A.id));const B=s.y,J=s.x,ct=m.length,lt=new Map,N=new Map;let W=0;m.forEach(A=>{D++;const P=B-6*(ct-W),R=(new z.i).new(D,D.toString(),0,J,P);A.chartInfo.target_id=D,A.chartInfo.target=R,f.integrations.push(R),N.set(D,R),W++,A.chartInfo.dPath=void 0});const mt=S.length;return W=0,S.forEach(A=>{D++;const P=B+6*(mt-W),R=(new z.i).new(D,D.toString(),0,J,P);A.chartInfo.source_id=D,A.chartInfo.source=R,f.integrations.push(R),lt.set(D,R),A.chartInfo.dPath=void 0}),f.integrations.splice(f.integrations.indexOf(s),1),{sources:lt,targets:N}}static#t=this.\u0275fac=function(f){return new(f||G)};static#e=this.\u0275prov=C.Yz7({token:G,factory:G.\u0275fac,providedIn:"root"})}return G})();var ot=X(4961),gt=X(9304);let ht=(()=>{class G{constructor(){this.blockDelete=!1,this.selected_node=null,this.last_selected_node=null,this.activity_created=null,this.selected_link=null,this.links=null,this.mousedown_node=null,this.drag_node=null,this.mouseover_node=null,this.mouseup_node=null,this.mousedown_link=null,this.ctrl_down=!1,this.lastKeyDown=null,this.macMetaDown=!1,this.allowDeletes=!0,this.width=null,this.height=null,this.prevProjId=null,this.nodeRisk=new Map,this.arrowRisk=new Map}static#t=this.\u0275fac=function(f){return new(f||G)};static#e=this.\u0275prov=C.Yz7({token:G,factory:G.\u0275fac,providedIn:"root"})}return G})();var Tt=X(9127);let it=(()=>{class G{constructor(s,f,m){this.st=s,this.actBuilder=f,this.msFactory=m}addProjectActivity(s,f,m){const D=Math.max(...m.activities.map(J=>J.profile.id),0)+1,B=(new gt.w).new(D,D.toString(),s.id,f.id,0,0);return B.chartInfo.isDummy=m.profile.view.createAsDummy,B.chartInfo.source=s,B.chartInfo.target=f,B.subProject.subGraphId=-1,B.profile.sortOrder=D,m.activities.push(B),m.profile.view.selectedActivity=B,B}handleNodeCreation(s,f,m){if(this.st.blockDelete=!1,s||this.st.mousedown_node||this.st.mousedown_link)return!1;this.clearSelectedLink(m),this.clearSelectedNode(m);const S=Math.max(...m.integrations.map(B=>B.id),0)+1,D=(new z.i).new(S,S.toString(),0,f[0],f[1]);return D.x=Math.round(f[0]),D.y=Math.round(f[1]),m.integrations.push(D),!0}addFastActivity(s,f,m,S){const D=s.key,J=s.target.value.trim();if("Enter"===D&&""!==J){const ct=J.split(","),lt=ct[0].trim();let N=0;if(ct.length>1){const W=ct[1].trim();isNaN(+W)||(N=+W)}return f.profile.view.autoZoom=!0,this.actBuilder.addActivity(f,lt,N,m,S)}return null}clearSelectedLink(s){const f=this.st.selected_link;f&&(f.chartInfo.isSelected=!1,this.st.selected_link=null),s.profile.view.selectedActivity=null}clearSelectedNode(s){const f=this.st.selected_node;f&&(f.selected=!1,this.st.selected_node=null),s.profile.view.selectedIntegration=null}updateStartEndNodes(s,f,m=null){let S;const D=this.filterOutMilestones(f);if("end"!==m&&f.profile.start===s.id){let B=0,J=null;S=D.forEach(ct=>{ct.chartInfo.source.id===s.id&&(B++,J=ct.chartInfo.target.id)}),1===B&&null!==J&&(f.profile.start=J)}if("start"!==m&&f.profile.end===s.id){let B=0,J=null;S=D.forEach(ct=>{ct.chartInfo.target.id===s.id&&(B++,J=ct.chartInfo.source.id)}),1===B&&null!==J&&(f.profile.end=J)}}filterOutMilestones(s){return s.activities.filter(f=>null===f.chartInfo.milestoneNodeId)}deleteSelectedNodeOrLink(s){const f=this.filterOutMilestones(s);if(!this.st.blockDelete){let m;if(null!=this.st.selected_node)this.updateStartEndNodes(this.st.selected_node,s),this.msFactory.removeMilestoneByNode(this.st.selected_node,s);else if(this.st.selected_link){const S=this.st.selected_link,D=s.activities.find(N=>N.profile.id===S.profile.id);if(void 0===D)return;const{source:B,target:J}=D.chartInfo;if(void 0===B||void 0===J)return;this.updateStartEndNodes(B,s,"start"),this.updateStartEndNodes(J,s,"end"),m=s.activities.indexOf(D),s.activities.splice(m,1);const ct=f.find(N=>N.chartInfo.source_id===B.id||N.chartInfo.target_id===B.id),lt=f.find(N=>N.chartInfo.source_id===J.id||N.chartInfo.target_id===J.id);if(null==ct){const N=s.integrations.indexOf(B);s.integrations.splice(N,1)}if(null==lt){const N=s.integrations.indexOf(J);s.integrations.splice(N,1)}}this.clearSelectedLink(s),this.st.selected_link=null,this.st.selected_node=null,s.profile.view.selectedActivity=null}}static#t=this.\u0275fac=function(f){return new(f||G)(C.LFG(ht),C.LFG(Tt.I),C.LFG(ot.y))};static#e=this.\u0275prov=C.Yz7({token:G,factory:G.\u0275fac,providedIn:"root"})}return G})(),j=(()=>{class G{constructor(s,f,m,S){this.networkOps=s,this.msFactory=f,this.elFactory=m,this.st=S}checkDeselect(s){return!(!this.st.selected_node&&null===s.profile.view.selectedActivity&&null===s.profile.view.selectedIntegration&&!this.st.selected_link)}deselectActivity(s){s.activities.forEach(f=>f.chartInfo.isSelected=!1),s.profile.view.selectedActivity=null,this.st.selected_link=null,this.st.links?.classed("selected",!1)}filterOutMilestones(s){return s.activities.filter(f=>null===f.chartInfo.milestoneNodeId)}deselectNode(s){s.integrations.forEach(f=>f.selected=!1),s.profile.view.selectedActivity=null,s.profile.view.selectedIntegration=null,this.st.selected_node=null,this.st.links?.classed("selected",!1)}selectNode(s,f){f.integrations.forEach(m=>m.selected=m.id===s.id),f.profile.view.selectedIntegration=s}sortNodes(s,f){f.sort((m,S)=>m.id!==s.id?1:-1)}initNodeDragState(s,f,m){this.st.nodes.classed("selected",S=>s==S),this.deselectNode(m),s.selected||(s.selected=!0),this.st.nodes.select("circle").classed("active",!1),this.st.drag_node=s,this.sortNodes(this.st.drag_node,this.st.nodes)}deactivateSelectedNode(s,f){this.deselectNode(s),f.select("circle").classed("active",!1)}activateSelectedNode(s,f,m){f.classed("selected",s.selected=!0),this.st.selected_node=this.st.mousedown_node,this.st.last_selected_node=this.st.mousedown_node,this.selectNode(this.st.selected_node,m),f.select("circle").classed("active",!0)}hideDragLine(){this.st.drag_line.classed("hidden",!0).style("marker-end","")}updateDragLine(s){this.st.drag_line.style("marker-end","url(#end-arrow)").classed("hidden",!1).attr("d",`M${s.x},${s.y}L${s.x},${s.y}`)}createArrowEvent(s,f){if(!this.st.mousedown_node)return!1;if(this.hideDragLine(),this.st.mouseup_node=s,this.st.mouseup_node===this.st.mousedown_node)return this.resetState(),!1;this.st.nodes.selectAll("circle").attr("transform",B=>"");const m=this.st.mousedown_node,S=this.st.mouseup_node;if(m===S)return!1;let D=this.filterOutMilestones(f).filter(B=>B.chartInfo.source===m&&B.chartInfo.target===S)[0];if(!D){D=this.elFactory.addProjectActivity(m,S,f);const B=this.st.activity_created;null!=B&&"name"===f.profile.view.displayText&&setTimeout(()=>{B.next(!0)},100)}return this.st.selected_link=D,this.setLinkIsSelected(D,f,!0),null!=this.st.selected_node&&(this.st.selected_node.selected=!1),f.profile.view.selectedIntegration=null,this.st.selected_node=null,!0}setLinkIsSelected(s,f,m){s?.chartInfo&&(s.chartInfo.isSelected=m,f.profile.view.selectedActivity=s),m||(f.profile.view.selectedActivity=null)}resetState(){this.st.mousedown_node=null,this.st.mouseup_node=null,this.st.mousedown_link=null,this.st.drag_node=null}setNodeDownStates(s,f,m,S){this.deselectActivity(S),this.st.blockDelete=!1,f?this.initNodeDragState(s,m,S):(this.st.mousedown_node=s,this.st.nodes.select("circle").classed("active",!1),null!==this.st.selected_node&&this.st.mousedown_node.id===this.st.selected_node.id?this.deactivateSelectedNode(S,m):this.activateSelectedNode(s,m,S),this.updateDragLine(this.st.mousedown_node))}joinNodesOrCreateArrow(s,f){this.st.nodes.filter(B=>B==s);const S=this.st.mouseover_node;let D=!1;if(s.x=Math.round(s.x),s.y=Math.round(s.y),null!=S){const B=S.el.select("circle");D=this.joinNodesEvent(S.d,B,f),D||(D=this.createArrowEvent(S.d,f)),this.st.nodes?.classed("selected",!1)}return this.clearSelectionAndHideLine(),D}clearSelectionAndHideLine(){return this.st.mousedown_node&&(this.st.drag_line.classed("hidden",!0).style("marker-end",""),this.st.nodes?.classed("selected",!1)),this.st.mainG.classed("active",!1),this.resetState()}setMouseOverNodeStates(s,f){this.st.mouseover_node={d:s,el:f},null!=this.st.drag_node&&s!==this.st.drag_node&&f.select("circle").attr("transform",m=>s===m?"scale(1.3)":""),this.st.mousedown_node&&s!==this.st.mousedown_node&&f.select("circle").attr("transform",m=>s===m?"scale(1.1)":"")}clearMouseOverNodeStates(s,f){this.st.mouseover_node=null,null!=this.st.drag_node&&s!==this.st.drag_node&&f.select("circle").attr("transform",m=>""),this.st.mousedown_node&&s!==this.st.mousedown_node&&f.select("circle").attr("transform",m=>"")}setSelectedLinkState(s,f,m){return!f&&(this.st.blockDelete=!1,this.st.mousedown_link=s,null!==this.st.selected_link&&this.st.mousedown_link.profile.id===this.st.selected_link.profile.id?(this.setLinkIsSelected(null,m,!1),this.st.links.classed("selected",!1),this.st.selected_link=null):(this.st.selected_link=this.st.mousedown_link,this.setLinkIsSelected(this.st.selected_link,m,!0),this.st.links.classed("selected",S=>S===s)),null!=this.st.selected_node&&(this.st.selected_node.selected=!1),this.st.selected_node=null,m.profile.view.selectedIntegration=null,this.st.nodes.select("circle").classed("selected",!1),this.st.nodes.select("circle").classed("active",!1),!0)}joinNodesEvent(s,f,m){if(null!=this.st.drag_node){if(s===this.st.drag_node)return this.resetState(),!1;f.select("circle").attr("transform",B=>"");const S=this.st.drag_node,D=s;return D.id!==S.id&&!this.existsDirectConnectingLink(D.id,S.id,m)&&(this.st.drag_node=null,this.networkOps.joinNodes(D,S,m),!0)}return!1}existsDirectConnectingLink(s,f,m){return m.activities.some(S=>S.chartInfo.source_id===s&&S.chartInfo.target_id===f||S.chartInfo.source_id===f&&S.chartInfo.target_id===s)}makeDummy(){this.st.selected_node&&(this.st.selected_node.isDummy=!this.st.selected_node.isDummy)}makeMilestone(s){this.st.selected_node&&this.msFactory.createMilestone(s,this.st.selected_node)}splitUpNode(s,f){this.networkOps.splitUpNode(s,f),f.profile.view.selectedIntegration=null}static#t=this.\u0275fac=function(f){return new(f||G)(C.LFG(nt),C.LFG(ot.y),C.LFG(it),C.LFG(ht))};static#e=this.\u0275prov=C.Yz7({token:G,factory:G.\u0275fac,providedIn:"root"})}return G})(),at=(()=>{class G{constructor(s){this.st=s}getNodeCss(s,f){const m=this.filterOutMilestones(f);if(f.profile.view.showOrphaned){const S=m.filter(B=>B.chartInfo.source_id===s.id),D=m.filter(B=>B.chartInfo.target_id===s.id);return 0===S.length?"risk-end":0===D.length?"risk-start":"unprocessed risk-0"}return null===s.lft?"unprocessed risk-"+s.risk:"risk-"+s.risk}getNodeName(s){return s.isMilestone?s.milestoneName:s.name}getTextAboveNode(s,f){return"label"===f.profile.view.showEftLft&&s.label?s.label:"eft"===f.profile.view.showEftLft&&s.eft?s.eft+"/"+s.lft:"pcd"===f.profile.view.showEftLft&&null!=s.maxPCD?s.maxPCD:"milestone"===f.profile.view.showEftLft&&s.milestoneActivity?s.milestoneActivity.profile.name:""}getTagColor(s,f){if(s.tags){const m=s.tags.find(S=>S.name===f);if(m){const S=m.tags[0];return S?S.backgroundcolor:q.xU.UNPROCESSED}return q.xU.UNPROCESSED}return q.xU.UNPROCESSED}getRiskColor(s){let f;switch(s){case q.uF.NEW:f=q.xU.NEW;break;case q.uF.LOW:f=q.xU.LOW;break;case q.uF.MEDIUM:f=q.xU.MEDIUM;break;case q.uF.HIGH:f=q.xU.HIGH;break;case q.uF.CRITICAL:f=q.xU.CRITICAL;break;default:f=q.xU.UNPROCESSED}return f}getArrowColor(s,f,m,S,D){const B=m.profile.view.selectedTagGroup;if(B)return this.getTagColor(f,B);let J=f.chartInfo.risk;const ct=S.get(f.profile.id);!D&&s&&S&&void 0!==ct&&(J=ct);let lt=this.getRiskColor(J);return null===f.chartInfo.tf&&(lt=q.xU.UNPROCESSED),f.chartInfo.tf===1/0&&(lt=q.xU.UNPROCESSED),m.profile.view.showOrphaned&&(lt=q.xU.UNPROCESSED),(m.profile.view.fade&&f.processInfo.completed||m.profile.view.fade&&f.processInfo.completed)&&(lt=q.xU.COMPLETED),lt}getWrappedTextColor(s,f){const m=this.getArrowColor(!1,s,f,new Map,!0),S=this.expandColor(m);return this.darkenColor(S,.3)}expandColor(s){return 4===s.length?"#"+s[1]+s[1]+s[2]+s[2]+s[3]+s[3]:s}darkenColor(s,f){const m=parseInt(s.slice(1,3),16),S=parseInt(s.slice(3,5),16),D=parseInt(s.slice(5,7),16),B=Math.floor(m*(1-f)),J=Math.floor(S*(1-f)),ct=Math.floor(D*(1-f));return"#"+B.toString(16).padStart(2,"0")+J.toString(16).padStart(2,"0")+ct.toString(16).padStart(2,"0")}getNodeColor(s,f,m,S,D){if(m.profile.view.selectedTagGroup)return q.xU.UNASSIGNED;let J=f.risk;const ct=S.get(f.id);!D&&s&&S&&void 0!==ct&&(J=ct);let lt=this.getRiskColor(J);if((null===f.lft||f.lft===1/0)&&(lt=q.xU.UNPROCESSED),m.profile.view.fade&&f.completed&&(lt=q.xU.COMPLETED),m.profile.view.showOrphaned){const N=m.activities.filter(mt=>mt.chartInfo.source_id===f.id),W=m.activities.filter(mt=>mt.chartInfo.target_id===f.id);lt=q.xU.UNPROCESSED,0===N.length&&(lt=q.xU.END),0===W.length&&(lt=q.xU.START)}return lt}getLinkCss(s,f){return f.profile.view.selectedTagGroup?"assigning":null==s.chartInfo.tf?s.chartInfo.isDummy?"dummy unprocessed":"unprocessed":f.profile.view.showOrphaned?"risk-0":s.chartInfo.isDummy?"dummy risk-"+s.chartInfo.risk:"risk-"+s.chartInfo.risk}isCompleted(s,f){return f.profile.view.markCompleted&&s.processInfo.completed}isHighlighted(s,f){return s.subProject.subGraphId===f.profile.view.activeSubProjectId}isSelected(s,f){return s===this.st.selected_link||s===f.profile.view.selectedActivity}getLinkEndMarker(s,f){return null==s.chartInfo.tf||s.chartInfo.tf===1/0||f.profile.view.showOrphaned?"url(#end-u)":f.profile.view.markCompleted&&s.processInfo.completed?"url(#end-completed)":`url(#end-${s.chartInfo.risk})`}getLowerLinkText(s,f){return"float"!==f.profile.view.lowerArrowText||null===s.chartInfo.ff||null===s.chartInfo.tf||s.chartInfo.isDummy?"subproj"===f.profile.view.lowerArrowText&&(null!==s.subProject.subGraphLoaded||s.subProject.isParent||s.risk.criticalCount>0||s.risk.greenCount>0)?`g${s.risk.greenCount}  y${s.risk.yellowCount}  r${s.risk.redCount}  c${s.risk.criticalCount}`:"":s.chartInfo.ff+"/"+s.chartInfo.tf}getLowerLinkTextYPos(s,f){return void 0===s.chartInfo.source?.y||void 0===s.chartInfo.target?.y?(console.error("getLowerLinkTextYPos link node is missing y position"),0):s.chartInfo.source.y+(s.chartInfo.target.y-s.chartInfo.source.y)/2+14}getLowerLinkTextXPos(s,f){return void 0===s.chartInfo.source?.x||void 0===s.chartInfo.target?.x?(console.error("getLowerLinkTextXPos link node is missing x position"),0):"subproj"===f.profile.view.lowerArrowText?s.chartInfo.source.x+(s.chartInfo.target.x-s.chartInfo.source.x)/2:s.chartInfo.source.x+(s.chartInfo.target.x-s.chartInfo.source.x)/2-10}getActivityFontSize(s,f){return"subproj"===f.profile.view.lowerArrowText?"9px":"8px"}getLinkTextPosY(s,f){return void 0===s.chartInfo.source?.y||void 0===s.chartInfo.target?.y?(console.error("getLinkTextPosY link node is missing y position"),0):"name"===f.profile.view.displayText?s.chartInfo.source.y+(s.chartInfo.target.y-s.chartInfo.source.y)/2-14:s.chartInfo.source.y+(s.chartInfo.target.y-s.chartInfo.source.y)/2-6}getLinkTextPosX(s,f){return void 0===s.chartInfo.source?.x||void 0===s.chartInfo.target?.x?(console.error("getLinkTextPosX link node is missing x position"),0):s.chartInfo.source.x+(s.chartInfo.target.x-s.chartInfo.source.x)/2-10}getLinkText(s,f){let m;if("id"===f.profile.view.displayText){if(!f.profile.view.showDummies&&s.chartInfo.isDummy)return"";m=s.profile.id}else if("duration"===f.profile.view.displayText)m=s.profile.duration;else if("name"===f.profile.view.displayText){if(s.chartInfo.isDummy&&!f.profile.view.showDummies)return"";m=s.profile.name}else{if("resource"===f.profile.view.displayText)return s.assign.resources.map(S=>S.name).join(", ");if("abbreviated"===f.profile.view.displayText){if(s.chartInfo.isDummy&&!f.profile.view.showDummies)return"";if(+s.profile.name==+s.profile.id)return s.profile.id.toString();m=s.profile.id+" "+s.profile.name.split(" ").map(S=>S.substring(0,3)).join(" ")+" "+s.profile.duration+"d"}else if(f.profile.view.displayText.startsWith("tag")){const S=parseInt(f.profile.view.displayText.split(".")[1])??-1;if(-1===S)return s.assign.resources.map(D=>D.name).join(", ");{const D=s.tags?.find(B=>B.name===f.tags?.[S].name);if(D&&D.tags[0])return D.tags.map(J=>J.name).join(", ")}return""}}return m=this.getSubProjMarkerText(s,m?.toString()??""),m}getSubProjMarkerText(s,f){return null!==s.subProject.subGraphLoaded||s.subProject.isParent||s.risk.criticalCount>0||s.risk.greenCount>0?f+=":":-1!==s.subProject.subGraphId&&!s.chartInfo.isDummy&&(f+="*"),f}filterOutMilestones(s){return s.activities.filter(f=>null===f.chartInfo.milestoneNodeId)}static#t=this.\u0275fac=function(f){return new(f||G)(C.LFG(ht))};static#e=this.\u0275prov=C.Yz7({token:G,factory:G.\u0275fac,providedIn:"root"})}return G})(),K=(()=>{class G{constructor(s){this.st=s}nudgeGroup(s,f,m,S){this.moveNode(s,f),this.repositionConnectedArrows(),this.repositionArrowText("text.label",S),this.repositionArrowText("text.glow",S),this.repositionArrowText("foreignObject",S,null,-25,-15),this.repositionArrowFloatText(S)}updateGroupPosition(s,f){this.repositionConnectedArrows(f),this.repositionArrowText("text.label",s,f),this.repositionArrowText("text.glow",s,f),this.repositionArrowText("foreignObject",s,null,-25,-15),this.repositionArrowFloatText(s,f)}moveNode(s,f){this.st.nodes.filter(m=>m===this.st.drag_node).attr("transform",m=>(m.x+=s,m.y+=f,`translate(${m.x},${m.y})`))}repositionConnectedArrows(s=null){this.st.links.filter(f=>s?s.includes(f.chartInfo.source_id):f.chartInfo.source.selected).select("path").attr("d",f=>(f.chartInfo.dPath=void 0,this.getPath(f))),this.st.links.filter(f=>s?s.includes(f.chartInfo.target_id):f.chartInfo.target.selected).select("path").attr("d",f=>(f.chartInfo.dPath=void 0,this.getPath(f)))}repositionArrowText(s,f,m=null,S=0,D=0){this.st.links.filter(B=>m?m.includes(B.chartInfo.source.id)||m.includes(B.chartInfo.target.id):B.chartInfo.target.selected||B.chartInfo.source.selected).select(s).attr("y",B=>{const J=B.chartInfo;return"name"===f.profile.view.displayText?J.source.y+(J.target.y-J.source.y)/2-14:J.source.y+(J.target.y-J.source.y)/2-6+D}).attr("x",function(B){const J=B.chartInfo;return"name"===f.profile.view.displayText?J.source.x+(J.target.x-J.source.x)/4:J.source.x+(J.target.x-J.source.x)/2+S})}repositionArrowFloatText(s,f=null){this.st.links.filter(m=>f?f.includes(m.chartInfo.source.id)||f.includes(m.chartInfo.target.id):m.chartInfo.target.selected||m.chartInfo.source.selected).select("text.float").attr("y",m=>m.chartInfo.source.y+(m.chartInfo.target.y-m.chartInfo.source.y)/2+14).attr("x",m=>{const S=m.subProject,D=m.risk,B=m.chartInfo;return null!==S.subGraphLoaded||S.isParent||D.criticalCount>0||D.greenCount>0?B.source.x+(B.target.x-B.source.x)/2-25:B.source.x+(B.target.x-B.source.x)/2-3})}getPath(s){if(s.chartInfo.dPath)return s.chartInfo.dPath;const f=s.chartInfo.target.x-s.chartInfo.source.x,m=s.chartInfo.target.y-s.chartInfo.source.y,S=Math.sqrt(f*f+m*m),D=f/S,B=m/S;return"M"+(s.chartInfo.source.x+12*D)+","+(s.chartInfo.source.y+12*B)+"L"+(s.chartInfo.target.x-17*D)+","+(s.chartInfo.target.y-17*B)}setElPositions(s,f,m,S,D){this.st.ctrl_down?(this.st.drag_line.classed("hidden",!0).style("marker-end",""),this.nudgeGroup(f,m,S,D)):this.updateLinePos(s)}updateLinePos(s){const f=this.st.mousedown_node;f&&this.st.drag_line.attr("d",`M${f.x},${f.y}L${s[0]},${s[1]}`)}static#t=this.\u0275fac=function(f){return new(f||G)(C.LFG(ht))};static#e=this.\u0275prov=C.Yz7({token:G,factory:G.\u0275fac,providedIn:"root"})}return G})(),wt=(()=>{class G{constructor(s,f,m,S){this.events=s,this.props=f,this.factory=m,this.positioner=S}getPath(s){return this.positioner.getPath(s)}onNodeGroupDrag(s,f,m,S,D){return this.positioner.setElPositions(s,f,m,S,D)}updateLinePos(s){return this.positioner.updateLinePos(s)}handleNodeCreation(s,f,m){return this.factory.handleNodeCreation(s,f,m)}deleteSelectedNodeOrLink(s){return this.factory.deleteSelectedNodeOrLink(s)}addFastActivity(s,f,m,S){return this.factory.addFastActivity(s,f,m,S)}getNodeName(s){return this.props.getNodeName(s)}getTextAboveNode(s,f){return this.props.getTextAboveNode(s,f)}getNodeColor(s,f,m,S,D){return this.props.getNodeColor(s,f,m,S,D)}isCompleted(s,f){return this.props.isCompleted(s,f)}isSelected(s,f){return this.props.isSelected(s,f)}isHighlighted(s,f){return this.props.isHighlighted(s,f)}getArrowColor(s,f,m,S,D){return this.props.getArrowColor(s,f,m,S,D)}getWrappedTextColor(s,f){return this.props.getWrappedTextColor(s,f)}getLinkTextPosY(s,f){return this.props.getLinkTextPosY(s,f)}getLinkTextPosX(s,f){return this.props.getLinkTextPosX(s,f)}getLowerLinkTextYPos(s,f){return this.props.getLowerLinkTextYPos(s,f)}getLowerLinkTextXPos(s,f){return this.props.getLowerLinkTextXPos(s,f)}getActivityFontSize(s,f){return this.props.getActivityFontSize(s,f)}getLinkText(s,f){return this.props.getLinkText(s,f)}getLinkEndMarker(s,f){return this.props.getLinkEndMarker(s,f)}getLinkCss(s,f){return this.props.getLinkCss(s,f)}getNodeCss(s,f){return this.props.getNodeCss(s,f)}getLowerLinkText(s,f){return this.props.getLowerLinkText(s,f)}setMouseDownLink(s,f,m){return this.events.setSelectedLinkState(s,f,m)}onNodeGroupMouseUp(s,f){return this.events.joinNodesOrCreateArrow(s,f)}onNodeGroupMouseDown(s,f,m,S){return this.events.setNodeDownStates(s,f,m,S)}onNodeMouseOver(s,f){this.events.setMouseOverNodeStates(s,f)}onNodeMouseOut(s,f){this.events.clearMouseOverNodeStates(s,f)}clearClassesAndHideLine(){return this.events.clearSelectionAndHideLine()}splitUpNode(s,f){return this.events.splitUpNode(s,f)}makeDummy(){return this.events.makeDummy()}makeMilestone(s){return this.events.makeMilestone(s)}deselectNode(s){return this.events.deselectNode(s)}deselectActivity(s){return this.events.deselectActivity(s)}checkDeselect(s){return this.events.checkDeselect(s)}updateGroupPosition(s,f){return this.positioner.updateGroupPosition(s,f)}static#t=this.\u0275fac=function(f){return new(f||G)(C.LFG(j),C.LFG(at),C.LFG(it),C.LFG(K))};static#e=this.\u0275prov=C.Yz7({token:G,factory:G.\u0275fac,providedIn:"root"})}return G})(),bt=(()=>{class G{constructor(s,f,m){this.dashboard=s,this.arrowController=f,this.st=m,this.transform={k:1,x:0,y:0},this.lassoStart=null,this.lassoEnd=null,this.pivotNode=null,this.clickCount=0,this.clickTimer=null,this.originalDragPoint=null,this.previousPos=null,this.skipDrag=!1}setTransform(s){this.transform=s}buildLasso(s){!0===s.profile.view.lassoOn?this.init(s,this.id):this.remove(this.id)}init(s,f){this.id=f,this.st.svg.selectAll(".lasso").remove(),this.mainG=this.st.svg,this.lassoG=this.st.svg.append("g"),this.lassoG.classed("lasso",!0),this.targetArea=this.lassoG.append("rect"),this.selectedNodes=s.profile.view.lassoedNodes,this.selectedActivities=s.profile.view.lassoedLinks,this.targetArea.attr("width","100%").attr("height","100%").style("fill","red").style("opacity",.1),this.project=s,this.dynPath=this.lassoG.append("path").attr("class","drawn"),this.closePath=this.lassoG.append("path").attr("class","loop_close"),this.originNode=this.lassoG.append("circle").attr("class","origin"),this.drawnCoords=[],this.tpath="";const m=v.ohM().filter(S=>!S.button).on("start",S=>this.dragstart(S)).on("drag",S=>this.dragmove(S)).on("end",()=>this.dragend());this.targetArea.call(m),this.st.nodes.classed("possible",S=>this.selectedNodes.indexOf(S.id)>-1),this.st.links.classed("possible",S=>this.selectedActivities.indexOf(S.profile.id)>-1),this.st.nodes.classed("pivot",S=>this.pivotNode?.id===S.id)}keydown(s){if(s.keyCode===L.s.Ctrl&&!0===this.project?.profile.view.lassoOn){this.previousPos=null;const f=v.ohM().filter(m=>!m.button).on("start",this.nodeMoveDragStart).on("drag",m=>this.nodeMoveDragMove(m)).on("end",this.nodeMoveDragEnd);this.targetArea.call(f)}}keyup(s){s.keyCode===L.s.Ctrl&&!0===this.project?.profile.view.lassoOn&&this.init(this.project,this.id)}nodeMoveDragStart(){}nodeMoveDragMove(s){const f=v.cx$(s,this.mainG.node()),[m,S]=this.unTransformPt(f);if(null!==this.pivotNode&&null!==this.originalDragPoint){const[D,B]=this.originalDragPoint;this.transformPoints([m-D,S-B]),this.arrowController.updateGroupPosition(this.project,this.selectedNodes)}else if(this.previousPos){const[D,B]=this.previousPos,J=m-D,ct=S-B;this.st.nodes.attr("transform",lt=>this.selectedNodes.indexOf(lt.id)>-1?(lt.x=lt.x+J,lt.y=lt.y+ct,`translate(${lt.x}, ${lt.y})`):`translate(${lt.x}, ${lt.y})`),this.arrowController.updateGroupPosition(this.project,this.selectedNodes)}this.previousPos=[m,S],this.originalDragPoint=[m,S]}nodeMoveDragEnd(){this.previousPos=null,this.originalDragPoint=null}remove(s){this.id=s,this.st.svg.selectAll(".lasso").remove()}isInsideNode(s){const[f,m]=s,S=this.project.integrations.find(D=>{const B=this.transformPt([D.x,D.y]);return Math.sqrt(Math.pow(f-B[0],2)+Math.pow(m-B[1],2))<20});if(S&&this.selectedNodes.indexOf(S.id)>-1)return this.pivotNode&&S&&this.pivotNode.id===S.id?void(this.pivotNode=null):(this.pivotNode=S??null,S);this.pivotNode=null}transformPoints(s){if(!this.pivotNode||!this.originalDragPoint)return;const[f,m]=s,[S,D]=this.originalDragPoint,B=S+f,J=D+m,ct=Math.sqrt(Math.pow(S-this.pivotNode.x,2)+Math.pow(D-this.pivotNode.y,2)),N=Math.sqrt(Math.pow(B-this.pivotNode.x,2)+Math.pow(J-this.pivotNode.y,2))/ct,W=Math.atan2(D-this.pivotNode.y,S-this.pivotNode.x),A=Math.atan2(J-this.pivotNode.y,B-this.pivotNode.x)-W;this.st.nodes.attr("transform",P=>{if(this.selectedNodes.indexOf(P.id)>-1){if(!this.pivotNode||void 0===this.pivotNode.x||void 0===this.pivotNode.y)return`translate(${P.x}, ${P.y})`;const R=P.x-this.pivotNode.x,rt=P.y-this.pivotNode.y;let ft=R*Math.cos(A)-rt*Math.sin(A),kt=R*Math.sin(A)+rt*Math.cos(A);ft*=N,kt*=N;const Zt=ft+this.pivotNode.x,Rt=kt+this.pivotNode.y;return P.x=Zt,P.y=Rt,`translate(${Zt}, ${Rt})`}return`translate(${P.x}, ${P.y})`})}dragstart(s){if(this.clickCount>0){console.log("double click detected!");const f=v.cx$(s,this.mainG.node());this.isInsideNode(f),this.clickCount=0,this.skipDrag=!0}this.clickTimer||(this.clickTimer=setTimeout(()=>{this.clickCount=0,clearTimeout(this.clickTimer),this.clickTimer=null},300)),this.clickCount++,this.drawnCoords=[],this.dynPath.attr("d",null),this.closePath.attr("d",null)}dragmove(s){if(this.skipDrag)return void(this.skipDrag=!1);const{x:f,y:m}=s,[S,D]=v.cx$(s,this.mainG.node());""===this.tpath?(this.tpath=this.tpath+"M "+S+" "+D,this.origin=[f,m],this.torigin=[S,D],this.originNode.attr("cx",S).attr("cy",D).attr("r",7).attr("display",null)):this.tpath=this.tpath+" L "+S+" "+D,this.drawnCoords.push([f,m]);const B=Math.sqrt(Math.pow(f-this.origin[0],2)+Math.pow(m-this.origin[1],2)),J="M "+S+" "+D+" L "+this.torigin[0]+" "+this.torigin[1];this.dynPath.attr("d",this.tpath),this.closePath.attr("d",J);const N=B<=75;this.selectedNodes=[],this.project.integrations.forEach(W=>{const A=this.transformPt([W.x,W.y]);this.pointInPolygon(A,this.drawnCoords)&&this.selectedNodes.push(W.id)}),this.st.nodes.classed("possible",W=>this.selectedNodes.indexOf(W.id)>-1),this.st.nodes.classed("pivot",W=>this.pivotNode?.id===W.id),this.closePath.attr("display",N?null:"none")}transformPt(s){return[s[0]*this.transform.k+this.transform.x,s[1]*this.transform.k+this.transform.y]}unTransformPt(s){return[s[0]/this.transform.k-this.transform.x,s[1]/this.transform.k-this.transform.y]}dragend(){this.tpath="",this.drawnCoords=[],this.dynPath.attr("d",null),this.closePath.attr("d",null),this.originNode.attr("display","none"),this.selectedActivities=[],this.selectActivities(),this.project.profile.view.isSubProjSelected=this.isSubProject(),this.project.profile.view.lassoedLinks=this.selectedActivities,this.project.profile.view.lassoedNodes=this.selectedNodes,this.project.profile.view.lassoStart=this.lassoStart,this.project.profile.view.lassoEnd=this.lassoEnd,this.lassoEnd=null,this.lassoStart=null,this.selectedNodes=[],this.dashboard.updateProject(this.project,!1)}isSubProject(){if(this.selectedNodes.length<3)return!1;const s=[],f=[];this.project.activities.forEach(N=>{this.selectedNodes.indexOf(N.chartInfo.target_id)>-1&&-1===this.selectedNodes.indexOf(N.chartInfo.source_id)&&s.push(N),this.selectedNodes.indexOf(N.chartInfo.source_id)>-1&&-1===this.selectedNodes.indexOf(N.chartInfo.target_id)&&f.push(N)});const m=[],S=[];if(this.selectedNodes.forEach(N=>{this.project.activities.filter(R=>R.chartInfo.source_id===N).find(R=>this.selectedNodes.indexOf(R.chartInfo.target_id)>-1)||S.push(N),this.project.activities.filter(R=>R.chartInfo.target_id===N).find(R=>this.selectedNodes.indexOf(R.chartInfo.source_id)>-1)||m.push(N)}),S.length>1||m.length>1||this.project.activities.find(N=>N.chartInfo.target_id===S[0]&&N.chartInfo.source_id===m[0]))return!1;this.lassoStart=m[0],this.lassoEnd=S[0];const B=s.map(N=>N.chartInfo.target_id),J=f.map(N=>N.chartInfo.source_id),ct=B.filter(N=>-1===m.indexOf(N)&&-1===S.indexOf(N)),lt=J.filter(N=>-1===m.indexOf(N)&&-1===S.indexOf(N));return 0===ct.length&&0===lt.length}selectActivities(){this.project.activities.forEach(s=>{this.selectedNodes.indexOf(s.chartInfo.source_id)>-1&&this.selectedNodes.indexOf(s.chartInfo.target_id)>-1&&this.selectedActivities.push(s.profile.id)}),this.st.links.classed("possible",s=>this.selectedActivities.indexOf(s.profile.id)>-1)}pointInPolygon(s,f){let m,S,D,B,ct;const lt=s[0],N=s[1];let W=!1;for(let mt=0,A=f.length-1;mt<f.length;A=mt++)m=f[mt][0],D=f[mt][1],S=f[A][0],B=f[A][1],ct=D>N!=B>N&&lt<(S-m)*(N-D)/(B-D)+m,ct&&(W=!W);return W}static#t=this.\u0275fac=function(f){return new(f||G)(C.LFG(et.Ou),C.LFG(wt),C.LFG(ht))};static#e=this.\u0275prov=C.Yz7({token:G,factory:G.\u0275fac,providedIn:"root"})}return G})();var Mt=X(1568);let U=(()=>{class G{constructor(s,f,m,S){this.st=s,this.controller=f,this.lassoTool=m,this.dashboard=S}bindGlobalEvents(){this.st.svg.on("dblclick",s=>{s.preventDefault(),this.dblclick(s)}).on("click",s=>{this.st.allowDeletes=!0,this.st.last_selected_node=null}).on("mousemove",s=>this.mousemove(s)).on("mouseup",()=>this.mouseup()),v.Ys(window).on("keydown",s=>{this.keydown(s),this.lassoTool.keydown(s)}).on("keyup",s=>{this.keyup(s),this.lassoTool.keyup(s)})}dblclick(s){(!s.ctrlKey||null!=this.st.drag_node)&&s.stopPropagation(),this.st.mainG.classed("active",!0);const f=this.dashboard.activeProject$.getValue();this.controller.handleNodeCreation(s.ctrlKey,v.cx$(s,this.st.mainG.node()),f)&&this.dashboard.updateProject(f,!0,!0)}mousemove(s){s.ctrlKey||s.stopPropagation(),this.controller.updateLinePos(v.cx$(this.st.mainG.node()))}mouseup(){this.controller.clearClassesAndHideLine()}keydown(s){const f=this.dashboard.activeProject$.getValue();(this.st.lastKeyDown===L.s.Ctrl||this.st.macMetaDown)&&s.keyCode===L.s.X&&(s.preventDefault(),null!=this.st.selected_node&&this.controller.splitUpNode(this.st.selected_node,f),this.dashboard.updateProject(f,!0,!0)),(this.st.lastKeyDown===L.s.Ctrl||this.st.macMetaDown)&&s.keyCode===L.s.D&&(s.preventDefault(),this.controller.makeDummy(),this.dashboard.updateProject(f,!0,!0)),(this.st.lastKeyDown===L.s.Ctrl||this.st.macMetaDown)&&s.keyCode===L.s.M&&(s.preventDefault(),this.controller.makeMilestone(f),this.dashboard.updateProject(f,!0,!0)),s.keyCode===L.s.Backspace&&s.metaKey&&this.st.allowDeletes&&(this.controller.deleteSelectedNodeOrLink(f),this.dashboard.updateProject(f,!0,!0)),this.st.lastKeyDown||(this.st.lastKeyDown=s.keyCode,s.metaKey&&(s.preventDefault(),this.st.macMetaDown=!0,this.st.ctrl_down=!0),s.keyCode===L.s.Ctrl&&(this.st.ctrl_down=!0),s.keyCode!==L.s.Delete)||this.st.allowDeletes&&(this.controller.deleteSelectedNodeOrLink(f),this.dashboard.updateProject(f,!0,!0))}keyup(s){this.st.lastKeyDown=null,this.st.macMetaDown&&!s.metaKey&&(this.st.macMetaDown=!1,this.st.ctrl_down=!1),s.keyCode===L.s.Ctrl&&(this.st.ctrl_down=!1)}static#t=this.\u0275fac=function(f){return new(f||G)(C.LFG(ht),C.LFG(wt),C.LFG(bt),C.LFG(et.Ou))};static#e=this.\u0275prov=C.Yz7({token:G,factory:G.\u0275fac,providedIn:"root"})}return G})(),yt=(()=>{class G{constructor(s,f,m){this.st=s,this.controller=f,this.dashboard=m}createNodes(s){this.st.nodes=this.st.mainG.append("g").attr("class","node").selectAll("g");let f=this.st.mainG.select("g.node");f.empty()&&(f=this.st.mainG.append("g").attr("class","node"));const m=f.selectAll("g"),S=v.eRy().duration(q.aV).ease(q.I2),D=m.data(s.integrations,N=>N.id);D.exit().remove();const B=D.enter().append("g").attr("class",N=>this.controller.getNodeCss(N,s)).classed("milestone",N=>N.isMilestone).classed("completed",N=>s.profile.view.markCompleted&&N.completed).attr("transform",N=>`translate(${N.x},${N.y})`);B.append("circle").attr("r",N=>N.isMilestone?14:12).classed("node",!0).classed("dummy",N=>N.isDummy).classed("active",N=>N===this.st.selected_node).classed("last-selected",N=>N===this.st.last_selected_node),B.append("text").attr("class","label").attr("text-anchor","middle").attr("y",".3em").text(N=>this.controller.getNodeName(N)),"none"!==s.profile.view.showEftLft&&B.append("text").attr("class","label float risk-stats").attr("text-anchor","middle").attr("y",N=>N.isMilestone?"-2.3em":"-1.9em").text(N=>this.controller.getTextAboveNode(N,s));const J=v.ohM().filter(N=>!N.button).on("start",N=>{}).on("drag",(N,W)=>{this.controller.onNodeGroupDrag([N.x,N.y],N.dx,N.dy,W,s)}).on("end",(N,W)=>{const mt=this.controller.onNodeGroupMouseUp(W,s);this.dashboard.updateProject(s,!0,mt)});B.on("mousedown",(N,W)=>{this.st.allowDeletes=!0,this.controller.onNodeGroupMouseDown(W,this.st.ctrl_down||this.st.macMetaDown,v.Ys(N.currentTarget),s)}).on("mouseover",(N,W)=>this.controller.onNodeMouseOver(W,v.Ys(N.currentTarget))).on("mouseout",(N,W)=>this.controller.onNodeMouseOut(W,v.Ys(N.currentTarget))).call(J);const ct=B.merge(D),lt=this.st.prevProjId!==s.profile.id;ct.style("stroke",N=>this.controller.getNodeColor(!0,N,s,this.st.nodeRisk,lt)).transition(S).style("stroke",N=>this.controller.getNodeColor(!1,N,s,this.st.nodeRisk,lt)),this.st.nodes=ct}createArrows(s){let f=this.st.mainG.select("g.link");f.empty()&&(f=this.st.mainG.append("g").attr("class","link"));const m=f.selectAll("g.activity"),S=s.activities.filter(N=>!N.chartInfo.milestoneNodeId),D=m.data(S,N=>N.profile.id);D.exit().remove();const B=D.enter().append("g").attr("class","activity").on("mouseover",N=>v.Ys(N.currentTarget).classed("hover",!0)).on("mouseout",N=>v.Ys(N.currentTarget).classed("hover",!1)).on("mousedown",(N,W)=>{this.st.allowDeletes=!0,this.controller.setMouseDownLink(W,this.st.ctrl_down,s),this.dashboard.updateProject(s,!0),N.stopPropagation()});this.createArrowBody(s,B),this.createMainArrowText(s,B),this.createTextGlow(s,B),this.createLowerText(s,B);const J=B.merge(D),ct=v.eRy().duration(q.aV).ease(q.I2),lt=this.st.prevProjId!==s.profile.id;J.attr("class",N=>this.controller.getLinkCss(N,s)).classed("completed",N=>this.controller.isCompleted(N,s)).classed("selected",N=>this.controller.isSelected(N,s)).classed("sub-project",N=>this.controller.isHighlighted(N,s)).style("stroke",N=>this.controller.getArrowColor(!0,N,s,this.st.arrowRisk,lt)).transition(ct).style("stroke",N=>this.controller.getArrowColor(!1,N,s,this.st.arrowRisk,lt)),this.st.links=J,s.profile.view.activeSubProjectId=void 0}createMainArrowText(s,f){if(s.profile.view.wrapText){const m=this;f.append("foreignObject").attr("x",S=>this.controller.getLinkTextPosX(S,s)-25).attr("y",S=>this.controller.getLinkTextPosY(S,s)-15).attr("width","80px").each(function(S){let D=null;S!==s.profile.view.selectedActivity&&(D=m.controller.getWrappedTextColor(S,s));const B=v.Ys(this).append("xhtml:div").style("font-size",m.controller.getActivityFontSize(S,s)).style("color","#aaa").style("font-weight","bold").style("color",()=>D),J=m.controller.getLinkText(S,s).split(",");if(B.selectAll("div").data(J).enter().append("xhtml:div").style("font-size",m.controller.getActivityFontSize(S,s)).text(ct=>ct),B){const ct=B.node().getBoundingClientRect();v.Ys(this).attr("height",ct.height+"px")}})}else f.append("text").attr("class","label").classed("selected",m=>m===this.st.selected_link).attr("y",m=>this.controller.getLinkTextPosY(m,s)).attr("x",m=>this.controller.getLinkTextPosX(m,s)).style("font-size",m=>this.controller.getActivityFontSize(m,s)).style("text-anchor","middle").text(m=>this.controller.getLinkText(m,s))}createArrowBody(s,f){f.append("svg:path").attr("class","link main").classed("dummy",m=>m.chartInfo.isDummy).classed("selected",m=>m===this.st.selected_link).attr("d",m=>this.controller.getPath(m)).style("marker-end",m=>this.controller.getLinkEndMarker(m,s))}createTextGlow(s,f){s.profile.view.wrapText||f.insert("text","text").attr("class","glow").style("font-size",m=>this.controller.getActivityFontSize(m,s)).attr("y",m=>this.controller.getLinkTextPosY(m,s)).attr("x",m=>this.controller.getLinkTextPosX(m,s)).text(m=>this.controller.getLinkText(m,s))}createLowerText(s,f){f.append("text").attr("class","label float").attr("y",m=>this.controller.getLowerLinkTextYPos(m,s)).attr("x",m=>this.controller.getLowerLinkTextXPos(m,s)).style("text-anchor","middle").text(m=>this.controller.getLowerLinkText(m,s)).style("font-size",m=>this.controller.getActivityFontSize(m,s))}createArrowHeads(){const s=this.st.mainG.append("svg:defs").selectAll("marker");this.addArrowHead(s,"end-0","risk-0"),this.addArrowHead(s,"end-1","risk-1"),this.addArrowHead(s,"end-2","risk-2"),this.addArrowHead(s,"end-3","risk-3"),this.addArrowHead(s,"end-undefined","risk-undefined"),this.addArrowHead(s,"end-u","unprocessed"),this.addArrowHead(s,"end-completed","completed"),s.data(["end-arrow"]).enter().append("svg:marker").attr("id",String).attr("class","endarrow").attr("viewBox","0 -5 10 10").attr("refX",6).attr("markerWidth",3).attr("markerHeight",3).attr("orient","auto").append("svg:path").attr("d","M0,-5L10,0L0,5").attr("fill","#000")}addArrowHead(s,f,m){s=s.data([f]).enter().append("svg:marker").attr("id",String).attr("viewBox","0 -5 10 10").attr("refX",6).attr("markerWidth",3).attr("markerHeight",3).attr("orient","auto").attr("class",m).append("svg:path").attr("d","M0,-5L10,0L0,5")}clearElements(){this.st.mainG.selectAll("g.link").remove(),this.st.mainG.selectAll("g.node").remove(),this.st.mainG.selectAll("defs").remove(),this.st.mainG.selectAll("g.missing-data").remove()}static#t=this.\u0275fac=function(f){return new(f||G)(C.LFG(ht),C.LFG(wt),C.LFG(et.Ou))};static#e=this.\u0275prov=C.Yz7({token:G,factory:G.\u0275fac,providedIn:"root"})}return G})(),ut=(()=>{class G{constructor(s,f){this.st=s,this.lassoTool=f}zoom(s){if(1==s.profile.view.lassoOn)return void this.st.svg.on(".zoom",null);if(s.integrations.length<2)return void(s.profile.view.autoZoom=!1);const f=this.getSvgZoom(s);if(f){const m=this.getZoomOrigin(s);v.sPX().translateTo(this.st.svg,m.translate[0],m.translate[1]),v.sPX().scaleTo(this.st.svg,m.scale)}this.st.svg.call(v.sPX().on("zoom",(m,S)=>{this.st.mainG.attr("transform",m.transform),this.lassoTool.setTransform(m.transform)})),this.st.svg.on("dblclick.zoom",null),null!=f&&(this.st.mainG.attr("transform",`translate(${f.translate})scale(${f.scale})`),this.lassoTool.setTransform({k:f.scale,x:f.translate[0],y:f.translate[1]}))}getSvgZoom(s){if(null==s||0===s.integrations.length)return{scale:1,translate:[0,0]};if(!s.profile.view.autoZoom)return null;s.profile.view.autoZoom=!1;const S=s.integrations.map(Rt=>Rt.x),D=s.integrations.map(Rt=>Rt.y),B=Math.max(...S),J=Math.min(...S),ct=Math.max(...D),lt=Math.min(...D),P=(B+J)/2,R=(ct+lt)/2,rt=.9/Math.max((B-J)/this.st.width,(ct-lt)/this.st.height);return{translate:[this.st.width/2-rt*P-0,this.st.height/2-rt*R-0],scale:rt}}getZoomOrigin(s){const f=s.integrations.map(P=>P.x),m=s.integrations.map(P=>P.y),S=Math.max(...f),D=Math.min(...f),B=Math.max(...m),J=Math.min(...m);return{translate:[(S-D)/2+D,(B-J)/2+J],scale:.9/Math.max((S-D)/this.st.width,(B-J)/this.st.height)}}static#t=this.\u0275fac=function(f){return new(f||G)(C.LFG(ht),C.LFG(bt))};static#e=this.\u0275prov=C.Yz7({token:G,factory:G.\u0275fac,providedIn:"root"})}return G})(),Ot=(()=>{class G{constructor(s,f,m,S,D,B,J,ct,lt,N){this.dashboard=s,this.eventService=f,this.ngZone=m,this.lassoTool=S,this.controller=D,this.nodeArranger=B,this.events=J,this.elements=ct,this.svgZoom=lt,this.st=N,this.projIsEmpty=new Bt.X(!0)}init(s,f,m,S,D){this.id=m,this.st.width=s,this.st.height=f,this.rebuild=S,this.initSvg(s,f,D),this.events.bindGlobalEvents(),this.data=this.dashboard.activeProject$,this.sub=this.data.pipe((0,Z.h)(B=>!!B)).subscribe(B=>{this.ngZone.runOutsideAngular(()=>{this.createChart(B)})}),this.st.activity_created=this.eventService.get(q.BT)}destroy(){this.sub&&this.sub.unsubscribe()}createFastActivity(s,f,m=!1){const S=this.controller.addFastActivity(s,this.proj,f,this.st.last_selected_node);S&&(f===q.T5&&(this.st.last_selected_node=S.chartInfo.target??null),!0===m&&this.nodeArranger.arrangeNodes(this.proj),this.dashboard.updateProject(this.proj,!0,!0))}deselectItem(){this.st.allowDeletes=!1,this.controller.checkDeselect(this.proj)&&(this.controller.deselectActivity(this.proj),this.controller.deselectNode(this.proj),this.dashboard.updateProject(this.proj,!1))}disableDeletes(){this.st.allowDeletes=!1}initSvg(s,f,m){const S=this.st,D="big-arrow-"+this.id;if(this.rebuild&&v.Ys(m).select("svg").remove(),!this.st.svg||this.rebuild){const B=v.Ys(m).append("svg").attr("class",D);this.st.svg=B.style("width","100%").style("height",null).attr("preserveAspectRatio","xMinYMin meet").attr("viewBox",`0 0 ${s} ${f}`),S.mainG=S.svg.append("g"),S.mainG.classed("main-arrow",!0),S.drag_line=S.mainG.append("svg:path").attr("class","link dragline hidden").attr("d","M0,0L0,0")}}createChart(s){this.proj=s;const f=0===s.integrations.length;this.projIsEmpty.next(f),this.rebuild&&this.elements.clearElements(),!f&&(this.svgZoom.zoom(s),this.elements.createArrowHeads(),this.elements.createNodes(s),this.elements.createArrows(s),this.buildDict(s),this.lassoTool.buildLasso(s),this.st.prevProjId=s.profile.id)}buildDict(s){this.st.arrowRisk=new Map,s.activities.forEach((f,m)=>this.st.arrowRisk.set(f.profile.id,f.chartInfo.risk)),this.st.nodeRisk=new Map,s.integrations.forEach((f,m)=>this.st.nodeRisk.set(f.id,f.risk))}static#t=this.\u0275fac=function(f){return new(f||G)(C.LFG(et.Ou),C.LFG(et.WO),C.LFG(C.R0b),C.LFG(bt),C.LFG(wt),C.LFG(Mt.g),C.LFG(U),C.LFG(yt),C.LFG(ut),C.LFG(ht))};static#e=this.\u0275prov=C.Yz7({token:G,factory:G.\u0275fac,providedIn:"root"})}return G})();const Lt=["chart"];function _t(G,Me){if(1&G){const s=C.EpF();C.TgZ(0,"div",8)(1,"div")(2,"div"),C._uU(3,"Add Activity"),C.qZA(),C.TgZ(4,"input",9),C.NdJ("ngModelChange",function(m){C.CHM(s);const S=C.oxw();return C.KtG(S.activityTxt=m)})("keydown",function(m){C.CHM(s);const S=C.oxw();return C.KtG(S.processActivityTxt(m))}),C.qZA()(),C.TgZ(5,"div",10)(6,"div"),C._uU(7,"Mode"),C.qZA(),C.TgZ(8,"div",11)(9,"div",12)(10,"input",13),C.NdJ("ngModelChange",function(m){C.CHM(s);const S=C.oxw();return C.KtG(S.creationMode=m)}),C.qZA(),C.TgZ(11,"label",14),C._uU(12,"Subgroup"),C.qZA()(),C.TgZ(13,"div",12)(14,"input",15),C.NdJ("ngModelChange",function(m){C.CHM(s);const S=C.oxw();return C.KtG(S.creationMode=m)}),C.qZA(),C.TgZ(15,"label",16),C._uU(16,"Multigroup"),C.qZA()(),C.TgZ(17,"div",17)(18,"input",18),C.NdJ("change",function(){C.CHM(s);const m=C.oxw();return C.KtG(m.autoArrange=!m.autoArrange)}),C.qZA(),C.TgZ(19,"label",19),C._uU(20,"Auto Arrange"),C.qZA()()()()()}if(2&G){const s=C.oxw();C.xp6(4),C.Q6J("ngModel",s.activityTxt),C.xp6(6),C.Q6J("ngModel",s.creationMode),C.xp6(4),C.Q6J("ngModel",s.creationMode),C.xp6(4),C.Q6J("checked",s.autoArrange)}}const Vt=()=>["mat-calendar-body-cell-content","keep-selected-item"];let ce=(()=>{class G{constructor(){this.showFastCreator=!0,this.creationMode=q.MB,this.autoArrange=!1,this.showList=!1,this.ui=(0,C.f3M)(Ot)}ngOnInit(){this.isEmpty=this.ui.projIsEmpty,this.ui.init(this.width,this.height,this.id,this.rebuild,this.chart.nativeElement)}deselectItem(s){this.ui.deselectItem()}disableDeletes(s){this.ui.disableDeletes()}processActivityTxt(s){this.ui.createFastActivity(s,this.creationMode,this.autoArrange),"Enter"===s.key&&(this.activityTxt="")}ngOnDestroy(){this.ui.destroy()}static#t=this.\u0275fac=function(f){return new(f||G)};static#e=this.\u0275cmp=C.Xpm({type:G,selectors:[["cp-arrow-chart"]],viewQuery:function(f,m){if(1&f&&C.Gf(Lt,7),2&f){let S;C.iGM(S=C.CRH())&&(m.chart=S.first)}},hostAttrs:[1,"cp-arrow-chart"],inputs:{id:"id",width:"width",height:"height",rebuild:"rebuild",showFastCreator:"showFastCreator"},features:[C._Bn([Ot,wt,ut,j,U,it,bt,yt,ht,K,at])],decls:11,vars:7,consts:[[1,"arrow-empty-message",3,"hidden"],[1,"arrow-component-wrapper"],["class","create-txt",4,"ngIf"],["outsideClick","",1,"arrow-chart-container",3,"skipList","outListSelect","inListSelect"],["chart",""],[1,"arrow-list"],[1,"list",3,"hidden"],[1,"toggle","fas","fa-list",3,"click"],[1,"create-txt"],["type","text",3,"ngModel","ngModelChange","keydown"],[1,"create-mode"],[1,"creation-config"],[1,"custom-control","custom-radio","custom-control-inline"],["type","radio","id","sub","name","create","value","sub",1,"custom-control-input",3,"ngModel","ngModelChange"],["for","sub",1,"custom-control-label"],["type","radio","id","multi","name","create","value","multi",1,"custom-control-input",3,"ngModel","ngModelChange"],["for","multi",1,"custom-control-label"],[1,"custom-control","custom-checkbox","custom-control-inline"],["type","checkbox","id","arrange",1,"custom-control-input",3,"checked","change"],["for","arrange",1,"custom-control-label"]],template:function(f,m){1&f&&(C.TgZ(0,"div",0),C.ALo(1,"async"),C._uU(2,"Arrow diagram: click to add nodes and arrows"),C.qZA(),C.TgZ(3,"div",1),C.YNc(4,_t,21,4,"div",2),C.TgZ(5,"div",3,4),C.NdJ("outListSelect",function(D){return m.deselectItem(D)})("inListSelect",function(D){return m.disableDeletes(D)}),C.qZA(),C.TgZ(7,"div",5)(8,"div",6),C._UZ(9,"cp-arrow-list"),C.qZA(),C.TgZ(10,"i",7),C.NdJ("click",function(){return m.showList=!m.showList}),C.qZA()()()),2&f&&(C.Q6J("hidden",!C.lcZ(1,4,m.isEmpty)),C.xp6(4),C.Q6J("ngIf",m.showFastCreator),C.xp6(1),C.Q6J("skipList",C.DdM(6,Vt)),C.xp6(3),C.Q6J("hidden",!m.showList))},styles:[".cp-arrow-chart{display:block;position:relative}.cp-arrow-chart .arrow-component-wrapper{position:relative;top:0;left:0}.cp-arrow-chart .arrow-component-wrapper .create-txt{position:absolute;top:10px;left:5px;padding:7px;border-radius:7px;background-color:#f9f9f9;z-index:12;display:flex}.cp-arrow-chart .arrow-component-wrapper .create-txt .create-mode{padding-left:20px}.cp-arrow-chart .arrow-component-wrapper svg{background-color:#fff}.cp-arrow-chart path.dragline{stroke:#000}.cp-arrow-chart path.link{stroke-width:4px;cursor:default}.cp-arrow-chart svg:not(.active):not(.ctrl) path.link{cursor:pointer}.cp-arrow-chart path.link{fill:none;stroke-width:4px;cursor:default}.cp-arrow-chart .link{stroke-opacity:.6}.cp-arrow-chart .node{stroke-width:1px;fill:#fff}.cp-arrow-chart g.selected *{stroke-opacity:1}.cp-arrow-chart g.selected .node{fill:#aaf}.cp-arrow-chart .node .risk-0{stroke-opacity:.5}.cp-arrow-chart .node .risk-1,.cp-arrow-chart .node .risk-2{stroke-opacity:.6}.cp-arrow-chart .node .risk-3{stroke-opacity:.9}.cp-arrow-chart .link .risk-0 text{stroke-opacity:.5}.cp-arrow-chart .link .risk-1 text{stroke-opacity:.6}.cp-arrow-chart .link .risk-2 text{stroke-opacity:.6}.cp-arrow-chart .link .risk-3 text{stroke-opacity:.5}.cp-arrow-chart .risk-undefined{stroke:#bbb;stroke-opacity:.9}.cp-arrow-chart g.completed{fill:#fdf;stroke-opacity:.9}.cp-arrow-chart marker.risk-0{fill:#1c1;opacity:1}.cp-arrow-chart marker.risk-1{fill:#ffd800;opacity:1}.cp-arrow-chart marker.risk-2{fill:red;opacity:1}.cp-arrow-chart marker.risk-3{fill:#000;opacity:1}.cp-arrow-chart marker.risk-undefined{fill:#bbb;opacity:1}.cp-arrow-chart marker.unprocessed{fill:#bbb;opacity:1}.cp-arrow-chart marker.completed{fill:#fdf;opacity:1}.cp-arrow-chart .risk-0 path.link{stroke-opacity:.4}.cp-arrow-chart .risk-1 path.link{stroke-opacity:.6}.cp-arrow-chart .risk-2 path.link{stroke-opacity:.6}.cp-arrow-chart .risk-3 path.link{stroke-opacity:.9}.cp-arrow-chart .risk-undefined path.link{opacity:1}.cp-arrow-chart .completed path.link{stroke:#fdf;stroke-opacity:.8}.cp-arrow-chart .unprocessed path.link{stroke-opacity:.9}.cp-arrow-chart .glow{text-anchor:middle;font-size:13px;stroke:#fff;stroke-width:6;stroke-opacity:.7;fill:#fff}.cp-arrow-chart g path.dummy{stroke-dasharray:10,2}.cp-arrow-chart .dummy text{stroke-dasharray:10,0}.cp-arrow-chart g.sub-project path.link.main{stroke:purple;opacity:.9}.cp-arrow-chart circle.last-selected{stroke:purple}.cp-arrow-chart g.selected text.label{stroke:#00f}.cp-arrow-chart g.selected foreignObject>div{color:#00f}.cp-arrow-chart foreignObject>div{text-shadow:rgb(255,255,255) 0px 0px 3px,rgb(255,255,255) 0px 0px 4px,rgb(255,255,255) 0px 0px 3px,rgb(255,255,255) 0px 0px 3px;font-size:15px}.cp-arrow-chart text.glow,.cp-arrow-chart text.label,.cp-arrow-chart foreignObject>div{pointer-events:all;cursor:pointer}.cp-arrow-chart path.link.dragline{pointer-events:none}.cp-arrow-chart path.link.hidden{stroke-width:0}.cp-arrow-chart circle.node{stroke-width:1.5px;cursor:pointer}.cp-arrow-chart text,.cp-arrow-chart foreignObject>div{font:12px sans-serif;pointer-events:none}.cp-arrow-chart text.id{text-anchor:middle;font-weight:700}.cp-arrow-chart .activity-labels div{float:left;width:158px}.cp-arrow-chart .activity-labels div:first-child{width:23px}.cp-arrow-chart .dim{opacity:.8}.cp-arrow-chart g.dummy path{stroke-dasharray:10,2}.cp-arrow-chart g circle.dummy{stroke-dasharray:7,3;stroke-width:2.5px}.cp-arrow-chart g.milestone circle{stroke-width:4px}.cp-arrow-chart g.milestone{stroke-opacity:.8;fill:#000}.cp-arrow-chart g.selected path.link.main{stroke:#00f;opacity:.9}.cp-arrow-chart circle.active{stroke:#00f;stroke-width:2.5}.cp-arrow-chart .hover path{stroke-width:5.5px}.cp-arrow-chart text.risk-stats{font-size:8px;stroke-opacity:.4;fill:#000;font-weight:400}.cp-arrow-chart .arrow-empty-message{position:absolute;top:40%;left:50%;z-index:11;transform:translate(-50%,-50%)}.cp-arrow-chart .risk-end{stroke-opacity:.8;stroke-width:3px}.cp-arrow-chart .risk-end circle.node,.cp-arrow-chart .risk-start circle.node{stroke-width:3px}.cp-arrow-chart .risk-start{stroke-opacity:.8;stroke-width:3px}.cp-arrow-chart .arrow-empty-message{font-weight:700}.cp-arrow-chart .creation-config{display:flex;align-items:baseline}.cp-arrow-chart .lasso path{stroke:#505050;stroke-width:2px}.cp-arrow-chart .lasso .drawn{fill-opacity:.05}.cp-arrow-chart .lasso .loop_close{fill:none;stroke-dasharray:4,4}.cp-arrow-chart .lasso .origin{fill:#39f;fill-opacity:.5}.cp-arrow-chart .not_possible{fill:#c8c8c8}.cp-arrow-chart .possible circle,.cp-arrow-chart .possible path,.cp-arrow-chart .unprocessed.possible path.link{fill:#ec888c;stroke:#ec888c}.cp-arrow-chart .pivot circle{fill:#00f;stroke:#00f}.cp-arrow-chart .arrow-list{position:absolute;right:0;top:0;display:flex}.cp-arrow-chart .toggle{padding:5px}.cp-arrow-chart .arrow-list{height:100%}.cp-arrow-chart .list{padding-left:5px;height:100%;width:350px;overflow-y:auto;box-shadow:-6px 0 6px -4px #00000040;background-color:#fff}\n"],encapsulation:2})}return G})()},5547:(Ht,Ct,X)=>{X.d(Ct,{S:()=>it});var C=X(6814),v=X(2357),q=X(6223),Bt=X(179),Z=X(3633),et=X(2181),L=X(9212);const z=j=>({selected:j});function nt(j,at){if(1&j){const K=L.EpF();L.ynx(0),L.TgZ(1,"div",3),L.NdJ("click",function(){L.CHM(K);const bt=L.oxw().$implicit,Mt=L.oxw(2);return L.KtG(Mt.selectActivity(bt))}),L._uU(2),L.qZA(),L.TgZ(3,"div")(4,"input",4),L.NdJ("ngModelChange",function(bt){L.CHM(K);const Mt=L.oxw().$implicit;return L.KtG(Mt.profile.name=bt)})("ngModelChange",function(){L.CHM(K);const bt=L.oxw(3);return L.KtG(bt.updateProject())}),L.qZA()(),L.TgZ(5,"div")(6,"input",5),L.NdJ("ngModelChange",function(bt){L.CHM(K);const Mt=L.oxw().$implicit;return L.KtG(Mt.profile.depends_on=bt)})("ngModelChange",function(){L.CHM(K);const bt=L.oxw(3);return L.KtG(bt.updateProject())}),L.qZA()(),L.TgZ(7,"div")(8,"input",6),L.NdJ("ngModelChange",function(bt){L.CHM(K);const Mt=L.oxw().$implicit;return L.KtG(Mt.profile.duration=bt)})("ngModelChange",function(){L.CHM(K);const bt=L.oxw(3);return L.KtG(bt.updateProject())}),L.qZA()(),L.BQk()}if(2&j){const K=L.oxw().$implicit,wt=L.oxw(2);L.xp6(1),L.Q6J("ngClass",L.VKq(6,z,wt.selectedActivity===K)),L.xp6(1),L.Oqu(K.profile.id),L.xp6(2),L.Q6J("title",K.profile.name)("ngModel",K.profile.name),L.xp6(2),L.Q6J("ngModel",K.profile.depends_on),L.xp6(2),L.Q6J("ngModel",K.profile.duration)}}function ot(j,at){if(1&j&&(L.TgZ(0,"div",2),L.YNc(1,nt,9,8,"ng-container",0),L.qZA()),2&j){const K=at.$implicit;L.xp6(1),L.Q6J("ngIf",!K.chartInfo.isDummy)}}function gt(j,at){if(1&j&&(L.TgZ(0,"div"),L.YNc(1,ot,2,1,"div",1),L.qZA()),2&j){const K=L.oxw();L.xp6(1),L.Q6J("ngForOf",K.project.activities)}}let ht=(()=>{class j{constructor(K,wt){this.dashboard=K,this.eventService=wt}ngOnInit(){this.sub=this.dashboard.activeProject$.pipe((0,et.h)(K=>!!K)).subscribe(K=>{this.project=K})}selectActivity(K){this.selectedActivity=K,this.project.profile.view.selectedActivity=K,this.dashboard.updateProject(this.project)}ngOnDestroy(){this.sub?.unsubscribe()}updateProject(){null!==this.project&&this.dashboard.updateProject(this.project,!0)}static#t=this.\u0275fac=function(wt){return new(wt||j)(L.Y36(Z.Ou),L.Y36(Z.WO))};static#e=this.\u0275cmp=L.Xpm({type:j,selectors:[["cp-arrow-list"]],decls:3,vars:1,consts:[[4,"ngIf"],["class","activity",4,"ngFor","ngForOf"],[1,"activity"],[1,"cursor-pointer",3,"ngClass","click"],["type","text",3,"title","ngModel","ngModelChange"],["type","text",1,"depends-on",3,"ngModel","ngModelChange"],["type","number",1,"duration",3,"ngModel","ngModelChange"]],template:function(wt,bt){1&wt&&(L.TgZ(0,"p"),L._uU(1,"Activity List"),L.qZA(),L.YNc(2,gt,2,1,"div",0)),2&wt&&(L.xp6(2),L.Q6J("ngIf",void 0!==bt.project))},dependencies:[C.mk,C.sg,C.O5,q.Fj,q.wV,q.JJ,q.On],styles:[".activity[_ngcontent-%COMP%]{display:flex}input[_ngcontent-%COMP%]{border-left:none;border-top:none;border-right:none;border-bottom:1px solid #999}.cursor-pointer[_ngcontent-%COMP%]{cursor:pointer;flex-basis:25px;flex-grow:0;flex-shrink:0}.depends-on[_ngcontent-%COMP%]{max-width:105px}.duration[_ngcontent-%COMP%]{max-width:45px;text-align:right}.selected[_ngcontent-%COMP%]{background-color:#00f;color:#fff}"]})}return j})();var Tt=X(4585);let it=(()=>{class j{static#t=this.\u0275fac=function(wt){return new(wt||j)};static#e=this.\u0275mod=L.oAB({type:j});static#i=this.\u0275inj=L.cJS({imports:[C.ez,q.u5,Bt.g]})}return j})();L.B6R(v.w,[C.O5,q.Fj,q._,q.JJ,q.On,Tt.A,ht],[C.Ov])},4585:(Ht,Ct,X)=>{X.d(Ct,{A:()=>v});var C=X(9212);let v=(()=>{class q{onClick(Z){let et=Z.target,L=!0;for(;et;){if("string"==typeof et.className&&this.skipList.filter(nt=>et.className?.includes(nt)).length){L=!1;break}et=et.parentElement}!this.elementRef.nativeElement.contains(Z.target)&&L?this.outListSelect.emit(Z):!this.elementRef.nativeElement.contains(Z.target)&&this.inListSelect.observers.length>0&&this.inListSelect.emit(Z)}constructor(Z){this.elementRef=Z,this.outListSelect=new C.vpe,this.inListSelect=new C.vpe}static#t=this.\u0275fac=function(et){return new(et||q)(C.Y36(C.SBq))};static#e=this.\u0275dir=C.lG2({type:q,selectors:[["","outsideClick",""]],hostBindings:function(et,L){1&et&&C.NdJ("mousedown",function(nt){return L.onClick(nt)},!1,C.evT)},inputs:{skipList:"skipList"},outputs:{outListSelect:"outListSelect",inListSelect:"inListSelect"}})}return q})()},179:(Ht,Ct,X)=>{X.d(Ct,{g:()=>v});var C=X(9212);let v=(()=>{class q{static#t=this.\u0275fac=function(et){return new(et||q)};static#e=this.\u0275mod=C.oAB({type:q});static#i=this.\u0275inj=C.cJS({})}return q})()},4403:(Ht,Ct,X)=>{X.d(Ct,{FU:()=>L,Lc:()=>ot,MP:()=>Tt,N4:()=>Z,Nz:()=>ht,S6:()=>K,SI:()=>C,_w:()=>gt,cT:()=>it,dZ:()=>at,dt:()=>q,nE:()=>Bt,nQ:()=>et,tu:()=>v,u_:()=>z,v0:()=>j,vx:()=>nt});const C="Activities",v="Arrow Info",q="Integrations",Bt="Profile",Z="Sub-Parent Projects",et="Phases",L="Roles",z="Resources",nt="Activity Assigned Resources",ot="Activity Assinged Phases",gt="Resource Roles",ht="Tag Pool",Tt="Activity Tags",it="parentNodeId",j="nodeId",at="Jira Assignee";let K=(()=>{class wt{static#t=this.XLSX="xlsx";static#e=this.JSON="json";static#i=this.ELECTRON_SAVE="electron-save"}return wt})()},7778:(Ht,Ct,X)=>{X.d(Ct,{r:()=>Z});var C=X(7631),v=X(9212),q=X(7586),Bt=X(7348);let Z=(()=>{class et{ngOnInit(){}navigateHome(){window.location.href=C.N.postLogoutUrl}static#t=this.\u0275fac=function(nt){return new(nt||et)};static#e=this.\u0275cmp=v.Xpm({type:et,selectors:[["cp-left-menu-layout"]],decls:12,vars:0,consts:[[1,"profile-container"],[1,"nav-header"],[1,"logo-block"],[1,"pointer",3,"click"],[1,"cp-logo"],["src","assets/img/logo-white.png"],[1,"left-menu"],[1,"window"],["name","sidebar"],[1,"footer"]],template:function(nt,ot){1&nt&&(v.TgZ(0,"div",0)(1,"div",1),v._UZ(2,"cp-top-nav"),v.qZA(),v.TgZ(3,"div",2)(4,"a",3),v.NdJ("click",function(){return ot.navigateHome()}),v.TgZ(5,"span",4),v._UZ(6,"img",5),v.qZA()()(),v.TgZ(7,"div",6)(8,"div",7),v._UZ(9,"router-outlet",8),v.qZA()(),v._UZ(10,"router-outlet")(11,"div",9),v.qZA())},dependencies:[q.lC,Bt.E],styles:[".profile-container[_ngcontent-%COMP%]{display:grid;grid-template-rows:86px auto 1fr;grid-template-columns:225px 1fr;background-color:#fff;height:100%;margin:auto;background-color:#f9f9f9}[_nghost-%COMP%]     .profile-container>router-outlet+*{grid-column:2/-1}.nav-header[_ngcontent-%COMP%]{grid-column:2/-1;background-color:#333;z-index:100}.left-menu[_ngcontent-%COMP%]{grid-row:1/-1;grid-column:1/2;position:fixed;top:75px;height:100vh;overflow-y:auto;background-color:#333;width:225px}.logo-block[_ngcontent-%COMP%]{background-color:#333;width:225px;top:0;height:75px;grid-column:1/2;position:fixed;padding-top:23px;z-index:1}.logo-block[_ngcontent-%COMP%]   .cp-logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:192px;margin-top:-10px;margin-left:14px;margin-right:7px}.logo-block[_ngcontent-%COMP%]   .cp-brand[_ngcontent-%COMP%]{font-size:20px;line-height:20px;color:#fff;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji}.window[_ngcontent-%COMP%]{height:calc(100vh - 75px);width:100%;overflow-y:auto}cp-top-nav[_ngcontent-%COMP%]{height:100%;display:flex}.left-menu[_ngcontent-%COMP%]{z-index:1;overflow-x:hidden}.nav-header[_ngcontent-%COMP%]{z-index:0}.footer[_ngcontent-%COMP%]{grid-row:3/4;grid-column:2/6;background-color:#f9f9f9}.pointer[_ngcontent-%COMP%]{cursor:pointer}"]})}return et})()},9127:(Ht,Ct,X)=>{X.d(Ct,{I:()=>Z});var C=X(9989),v=X(9304),q=X(9844),Bt=X(9212);let Z=(()=>{class et{constructor(){this.nodeSerializer=new C.i}addActivity(z,nt="",ot=0,gt=q.MB,ht=null){let Tt=0;z.activities.length>0&&(Tt=Math.max(...z.activities.map(G=>G.profile.id)));const it=Tt+1;let j=-1;if(z.integrations.length>0&&(j=Math.max(...z.integrations.map(ce=>ce.id))),ht&&-1!==z.integrations.indexOf(ht))return this.addToExistingActivity(ht,it,j+1,z,nt,ot,gt);const at=j+1,K=at+1,wt=Math.floor(at/20),bt=at%20,ut=120+120*wt,Ot=20*(bt+1)+100,Lt=this.nodeSerializer.new(at,at+"",0,50+120*wt,20*(bt+1)+100),_t=this.nodeSerializer.new(K,K+"",0,ut,Ot);z.integrations.push(Lt),z.integrations.push(_t);const Vt=(new v.w).new(it,nt,at,K,0,ot);return Vt.subProject.subGraphId=-1,Vt.chartInfo.source=Lt,Vt.chartInfo.target=_t,Vt.profile.sortOrder=it,z.activities.push(Vt),Vt}addToExistingActivity(z,nt,ot,gt,ht,Tt,it){const j=(z.x??0)+120,at=z.y??0,K=(new v.w).new(nt,ht,z.id,ot,0,Tt),wt=this.nodeSerializer.new(ot,ot+"",0,j,at);gt.integrations.push(wt),K.subProject.subGraphId=-1,K.chartInfo.source=z,K.chartInfo.target=wt,K.profile.sortOrder=nt,gt.activities.push(K);const bt=gt.activities.filter(Lt=>Lt.chartInfo.source===z),Mt=bt.filter(Lt=>void 0===gt.activities.find(_t=>_t.chartInfo.source===Lt.chartInfo.target)),yt=(bt.filter(Lt=>!Mt.includes(Lt)),z.x??0),ut=z.y??0;let Ot=0;return Mt.forEach((Lt,_t)=>{Ot=this.calculatePos(Lt,gt.activities,yt,ut,Ot),Ot++}),K}calculatePos(z,nt,ot,gt,ht){if(z.chartInfo.target){z.chartInfo.target.x=ot+120;const it=30*(ht%2==0?-1:1)*Math.ceil(ht/2);z.chartInfo.target.y=gt+it,nt.find(at=>!!at.chartInfo.target&&at.profile.id!==z.profile.id&&at.chartInfo.target.y===z.chartInfo.target?.y&&at.chartInfo.target.x===z.chartInfo.target?.x)&&(ht=this.calculatePos(z,nt,ot,gt,ht+1))}return ht}static#t=this.\u0275fac=function(nt){return new(nt||et)};static#e=this.\u0275prov=Bt.Yz7({token:et,factory:et.\u0275fac,providedIn:"root"})}return et})()},2787:(Ht,Ct,X)=>{X.d(Ct,{v:()=>v});var C=X(9212);let v=(()=>{class q{constructor(){}setDependencyDataFromGraph(Z){for(const et of Z.activities){const L=this.getActivityDependencies(Z,et);et.profile.depends_on=L.toString()}}getActivityDependencies(Z,et){if(null!=et.chartInfo.milestoneNodeId)return this.setMilestoneDependencies(Z,et.chartInfo.milestoneNodeId);let L=[];if(et.chartInfo.source){const z=this.getInArrows(et.chartInfo.source,Z);for(const nt of z)if(nt.chartInfo.isDummy){const ot=this.getActivityDependencies(Z,nt);L=this.union(ot,L)}else L.push(nt.profile.id)}return L=this.uniq(L),L}uniq(Z){return[...Array.from(new Set(Z))]}union(Z,et){const L=Array.from(new Set(Z)),z=Array.from(new Set(et));return[...Array.from(new Set([...L,...z]))]}getInArrows(Z,et){return et.activities.filter(L=>L.chartInfo.target===Z)}setMilestoneDependencies(Z,et){if(null===et)return[];const L=Z.integrations.find(z=>z.id===et);if(L){const z=Z.activities.filter(ot=>ot.chartInfo.target_id===L.id);let nt=[];for(const ot of z)if(ot.chartInfo.isDummy){const gt=this.getActivityDependencies(Z,ot);nt=this.union(gt,nt)}else nt.push(ot.profile.id);return nt=this.uniq(nt),nt}return[]}static#t=this.\u0275fac=function(et){return new(et||q)};static#e=this.\u0275prov=C.Yz7({token:q,factory:q.\u0275fac,providedIn:"root"})}return q})()},7808:(Ht,Ct,X)=>{X.d(Ct,{d:()=>v});var C=X(9212);let v=(()=>{class q{constructor(){}getInEdges(Z,et){return et.activities.filter(L=>L.chartInfo.target_id===Z)}setStartEndNodesFromLongestPath(Z){if(0===Z.activities.length)return;if(1===Z.activities.length)return Z.profile.start=Z.activities[0].chartInfo.source?.id,void(Z.profile.end=Z.activities[0].chartInfo.target?.id);const L=Z.activities.filter(z=>null!=Z.activities.find(ot=>z.chartInfo.source_id===ot.chartInfo.target_id||z.chartInfo.target_id===ot.chartInfo.source_id)).filter(z=>0===this.getInEdges(z.chartInfo.source_id,Z).length);if(Z.profile.start=L[0].chartInfo.source?.id,void 0!==Z.profile.start){const z=this.calcLongestPath(Z,Z.profile.start,null);null!=z&&z.length>0&&(Z.profile.end=z[z.length-1].id)}return Z}getOutEdges(Z,et){return Z.activities.filter(L=>L.chartInfo.source_id===et)}calcLongestPath(Z,et,L){const z=Z.integrations.find(ht=>ht.id===et),nt=Z.integrations.find(ht=>ht.id===L),ot=[];return null==z?ot:this.walkTree(Z,z,ot,nt)}walkTree(Z,et,L,z){const nt=L.slice(0);if(void 0===et)return nt;nt.push(et);const ot=this.getOutEdges(Z,et.id);if(et===z||0===ot.length)return nt;let gt=nt;for(const ht of ot){const Tt=this.walkTree(Z,ht.chartInfo.target,nt,z);Tt.length>gt.length&&(gt=Tt)}return gt}static#t=this.\u0275fac=function(et){return new(et||q)};static#e=this.\u0275prov=C.Yz7({token:q,factory:q.\u0275fac,providedIn:"root"})}return q})()},4961:(Ht,Ct,X)=>{X.d(Ct,{y:()=>Bt});var C=X(9304),v=X(9212),q=X(2787);let Bt=(()=>{class Z{constructor(L){this.depCrawler=L}createMilestoneActivity(L,z){let nt=-1/0;z.activities.forEach(it=>{it.profile.id>nt&&(nt=it.profile.id)});let ot=-1;isNaN(nt)&&(ot=0),ot=nt+1;const gt=(new C.w).new(ot,ot.toString(),null,null,0,0);gt.chartInfo.isDummy=!0,gt.chartInfo.milestoneNodeId=L.id,gt.subProject.subGraphId=-1;const ht=z.integrations.filter(it=>it.isMilestone).length;L.milestoneNumber=ht,L.milestoneName="M"+ht,gt.profile.name=L.milestoneName,z.activities.push(gt),L.milestoneActivityId=gt.profile.id,L.milestoneActivity=gt;const Tt=this.depCrawler.getActivityDependencies(z,gt);return gt.profile.depends_on=Tt.join(),gt}createMilestone(L,z){if(null!==z)if(z.isMilestone)this.changeBackToNonMilestone(z,L),z.isMilestone=!1,z.milestoneNumber=0,z.milestoneName="";else{const nt=L.integrations.find(ot=>ot.isMilestone);if(void 0===nt)z.milestoneNumber=0,z.milestoneName="M0",z.isMilestone=!0;else{const ot=Math.max(...L.integrations.map(gt=>gt.milestoneNumber))+1;z.milestoneNumber=nt.milestoneNumber+1,z.milestoneName="M"+ot,z.isMilestone=!0}this.createMilestoneActivity(z,L)}}changeBackToNonMilestone(L,z){const nt=z.activities.findIndex(ot=>ot.profile.id===L.milestoneActivityId);z.activities.splice(nt,1),L.milestoneActivityId=null,L.milestoneActivity=null,L.isMilestone=!1,L.milestoneNumber=0,L.milestoneName=""}removeMilestoneByNode(L,z){const nt=z.activities.find(ht=>ht.profile.id===L.milestoneActivityId);if(nt){const ht=z.activities.indexOf(nt);z.activities.splice(ht,1)}const ot=z.integrations.findIndex(ht=>ht.id===L.id);z.integrations.splice(ot,1),z.activities.filter(ht=>void 0!==ht.chartInfo.source&&void 0!==ht.chartInfo.target&&(ht.chartInfo.source.id===L.id||ht.chartInfo.target.id===L.id)).forEach(ht=>z.activities.splice(z.activities.indexOf(ht),1))}removeMilestoneByActivity(L,z){if(!L||!z||!L.chartInfo.milestoneNodeId)return;const nt=z.activities.findIndex(gt=>gt.profile.id===L.profile.id);z.activities.splice(nt,1);const ot=z.integrations.find(gt=>gt.id===L.chartInfo.milestoneNodeId);ot&&(ot.milestoneName="",ot.milestoneNumber=0,ot.milestoneActivity=null,ot.milestoneActivityId=null,ot.isMilestone=!1)}static#t=this.\u0275fac=function(z){return new(z||Z)(v.LFG(q.v))};static#e=this.\u0275prov=v.Yz7({token:Z,factory:Z.\u0275fac,providedIn:"root"})}return Z})()},1568:(Ht,Ct,X)=>{X.d(Ct,{g:()=>$n});var C=X(3920),v=Object.create,q=Object.defineProperty,Bt=Object.defineProperties,Z=Object.getOwnPropertyDescriptor,et=Object.getOwnPropertyDescriptors,L=Object.getOwnPropertyNames,z=Object.getOwnPropertySymbols,nt=Object.getPrototypeOf,ot=Object.prototype.hasOwnProperty,gt=Object.prototype.propertyIsEnumerable,ht=(t,e)=>{if(e=Symbol[t])return e;throw Error("Symbol."+t+" is not defined")},Tt=(t,e,n)=>e in t?q(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,it=(t,e)=>{for(var n in e||(e={}))ot.call(e,n)&&Tt(t,n,e[n]);if(z)for(var n of z(e))gt.call(e,n)&&Tt(t,n,e[n]);return t},j=(t,e)=>Bt(t,et(e)),at=(t,e)=>{var n={};for(var i in t)ot.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&z)for(var i of z(t))e.indexOf(i)<0&&gt.call(t,i)&&(n[i]=t[i]);return n},K=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),bt=(t,e,n)=>(n=null!=t?v(nt(t)):{},((t,e,n,i)=>{if(e&&"object"==typeof e||"function"==typeof e)for(let r of L(e))!ot.call(t,r)&&undefined!==r&&q(t,r,{get:()=>e[r],enumerable:!(i=Z(e,r))||i.enumerable});return t})(!e&&t&&t.__esModule?n:q(n,"default",{value:t,enumerable:!0}),t)),Mt=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)},U=(t,e,n)=>(Mt(t,e,"read from private field"),n?n.call(t):e.get(t)),yt=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},ut=(t,e,n,i)=>(Mt(t,e,"write to private field"),i?i.call(t,n):e.set(t,n),n),Ot=(t,e,n)=>(Mt(t,e,"access private method"),n),Lt=function(t,e){this[0]=t,this[1]=e},_t=t=>{var i,e=t[ht("asyncIterator")],n=!1,r={};return null==e?(e=t[ht("iterator")](),i=o=>r[o]=a=>e[o](a)):(e=e.call(t),i=o=>r[o]=a=>{if(n){if(n=!1,"throw"===o)throw a;return a}return n=!0,{done:!1,value:new Lt(new Promise(l=>{var d=e[o](a);if(!(d instanceof Object))throw TypeError("Object expected");l(d)}),1)}}),r[ht("iterator")]=()=>r,i("next"),"throw"in e?i("throw"):r.throw=o=>{throw o},"return"in e&&i("return"),r},Vt=K((t,e)=>{function n(i,r,o,a){this.feasible=o,this.evaluation=r,this.bounded=a,this._tableau=i}e.exports=n,n.prototype.generateSolutionSet=function(){for(var i={},r=this._tableau,o=r.varIndexByRow,a=r.variablesPerIndex,l=r.matrix,d=r.rhsColumn,h=r.height-1,c=Math.round(1/r.precision),u=1;u<=h;u+=1){var g=a[o[u]];void 0!==g&&!0!==g.isSlack&&(i[g.id]=Math.round((Number.EPSILON+l[u][d])*c)/c)}return i}}),ce=K((t,e)=>{var n=Vt();function i(r,o,a,l,d){n.call(this,r,o,a,l),this.iter=d}e.exports=i,i.prototype=Object.create(n.prototype),i.constructor=i}),G=K((t,e)=>{var n=Vt(),i=ce();function r(a){this.model=null,this.matrix=null,this.width=0,this.height=0,this.costRowIndex=0,this.rhsColumn=0,this.variablesPerIndex=[],this.unrestrictedVars=null,this.feasible=!0,this.evaluation=0,this.simplexIters=0,this.varIndexByRow=null,this.varIndexByCol=null,this.rowByVarIndex=null,this.colByVarIndex=null,this.precision=a||1e-8,this.optionalObjectives=[],this.objectivesByPriority={},this.savedState=null,this.availableIndexes=[],this.lastElementIndex=0,this.variables=null,this.nVars=0,this.bounded=!0,this.unboundedVarIndex=null,this.branchAndCutIterations=0}function o(a,l){this.priority=a,this.reducedCosts=new Array(l);for(var d=0;d<l;d+=1)this.reducedCosts[d]=0}e.exports=r,r.prototype.solve=function(){return this.model.getNumberOfIntegerVariables()>0?this.branchAndCut():this.simplex(),this.updateVariableValues(),this.getSolution()},o.prototype.copy=function(){var a=new o(this.priority,this.reducedCosts.length);return a.reducedCosts=this.reducedCosts.slice(),a},r.prototype.setOptionalObjective=function(a,l,d){var h=this.objectivesByPriority[a];void 0===h&&(h=new o(a,Math.max(this.width,l+1)),this.objectivesByPriority[a]=h,this.optionalObjectives.push(h),this.optionalObjectives.sort(function(u,p){return u.priority-p.priority})),h.reducedCosts[l]=d},r.prototype.initialize=function(a,l,d,h){this.variables=d,this.unrestrictedVars=h,this.width=a,this.height=l;for(var c=new Array(a),u=0;u<a;u++)c[u]=0;this.matrix=new Array(l);for(var p=0;p<l;p++)this.matrix[p]=c.slice();this.varIndexByRow=new Array(this.height),this.varIndexByCol=new Array(this.width),this.varIndexByRow[0]=-1,this.varIndexByCol[0]=-1,this.nVars=a+l-2,this.rowByVarIndex=new Array(this.nVars),this.colByVarIndex=new Array(this.nVars),this.lastElementIndex=this.nVars},r.prototype._resetMatrix=function(){var c,u,a=this.model.variables,l=this.model.constraints,d=a.length,h=l.length,p=this.matrix[0],g=!0===this.model.isMinimization?-1:1;for(c=0;c<d;c+=1){var _=a[c],y=_.priority,k=g*_.cost;0===y?p[c+1]=k:this.setOptionalObjective(y,c+1,k),this.rowByVarIndex[u=a[c].index]=-1,this.colByVarIndex[u]=c+1,this.varIndexByCol[c+1]=u}for(var I=1,w=0;w<h;w+=1){var x=l[w],E=x.index;this.rowByVarIndex[E]=I,this.colByVarIndex[E]=-1,this.varIndexByRow[I]=E;var O,b,T=x.terms,$=T.length,V=this.matrix[I++];if(x.isUpperBound){for(O=0;O<$;O+=1)V[this.colByVarIndex[(b=T[O]).variable.index]]=b.coefficient;V[0]=x.rhs}else{for(O=0;O<$;O+=1)V[this.colByVarIndex[(b=T[O]).variable.index]]=-b.coefficient;V[0]=-x.rhs}}},r.prototype.setModel=function(a){return this.model=a,this.initialize(a.nVariables+1,a.nConstraints+1,a.variables,a.unrestrictedVariables),this._resetMatrix(),this},r.prototype.getNewElementIndex=function(){if(this.availableIndexes.length>0)return this.availableIndexes.pop();var a=this.lastElementIndex;return this.lastElementIndex+=1,a},r.prototype.density=function(){for(var a=0,l=this.matrix,d=0;d<this.height;d++)for(var h=l[d],c=0;c<this.width;c++)0!==h[c]&&(a+=1);return a/(this.height*this.width)},r.prototype.setEvaluation=function(){var a=Math.round(1/this.precision),d=Math.round((Number.EPSILON+this.matrix[this.costRowIndex][this.rhsColumn])*a)/a;this.evaluation=d,0===this.simplexIters&&(this.bestPossibleEval=d)},r.prototype.getSolution=function(){var a=!0===this.model.isMinimization?this.evaluation:-this.evaluation;return this.model.getNumberOfIntegerVariables()>0?new i(this,a,this.feasible,this.bounded,this.branchAndCutIterations):new n(this,a,this.feasible,this.bounded)}}),Me=K(()=>{var t=G();t.prototype.simplex=function(){return this.bounded=!0,this.phase1(),!0===this.feasible&&this.phase2(),this},t.prototype.phase1=function(){for(var n=this.model.checkForCycles,i=[],r=this.matrix,o=this.rhsColumn,a=this.width-1,l=this.height-1,h=0;;){for(var c=0,u=-this.precision,p=1;p<=l;p++){var g=r[p][o];g<u&&(u=g,c=p)}if(0===c)return this.feasible=!0,h;for(var _=0,y=-1/0,k=r[0],I=r[c],w=1;w<=a;w++){var x=I[w];if(!0===this.unrestrictedVars[this.varIndexByCol[w]]||x<-this.precision){var E=-k[w]/x;y<E&&(y=E,_=w)}}if(0===_)return this.feasible=!1,h;if(n){i.push([this.varIndexByRow[c],this.varIndexByCol[_]]);var O=this.checkForCycles(i);if(O.length>0)return this.model.messages.push("Cycle in phase 1"),this.model.messages.push("Start :"+O[0]),this.model.messages.push("Length :"+O[1]),this.feasible=!1,h}this.pivot(c,_),h+=1}},t.prototype.phase2=function(){for(var p,g,n=this.model.checkForCycles,i=[],r=this.matrix,o=this.rhsColumn,a=this.width-1,l=this.height-1,d=this.precision,h=this.optionalObjectives.length,c=null,u=0;;){var _=r[this.costRowIndex];h>0&&(c=[]);for(var y=0,k=d,I=!1,w=1;w<=a;w++)p=_[w],g=!0===this.unrestrictedVars[this.varIndexByCol[w]],h>0&&-d<p&&p<d?c.push(w):g&&p<0?-p>k&&(k=-p,y=w,I=!0):p>k&&(k=p,y=w,I=!1);if(h>0)for(var x=0;0===y&&c.length>0&&x<h;){var E=[],O=this.optionalObjectives[x].reducedCosts;k=d;for(var b=0;b<c.length;b++)g=!0===this.unrestrictedVars[this.varIndexByCol[w=c[b]]],-d<(p=O[w])&&p<d?E.push(w):g&&p<0?-p>k&&(k=-p,y=w,I=!0):p>k&&(k=p,y=w,I=!1);c=E,x+=1}if(0===y)return this.setEvaluation(),this.simplexIters+=1,u;for(var F=0,T=1/0,V=1;V<=l;V++){var Y=r[V],Q=Y[o],tt=Y[y];if(!(-d<tt&&tt<d)){if(tt>0&&d>Q&&Q>-d){T=0,F=V;break}var dt=I?-Q/tt:Q/tt;dt>d&&T>dt&&(T=dt,F=V)}}if(T===1/0)return this.evaluation=-1/0,this.bounded=!1,this.unboundedVarIndex=this.varIndexByCol[y],u;if(n){i.push([this.varIndexByRow[F],this.varIndexByCol[y]]);var xt=this.checkForCycles(i);if(xt.length>0)return this.model.messages.push("Cycle in phase 2"),this.model.messages.push("Start :"+xt[0]),this.model.messages.push("Length :"+xt[1]),this.feasible=!1,u}this.pivot(F,y,!0),u+=1}};var e=[];t.prototype.pivot=function(n,i){var r=this.matrix,o=r[n][i],a=this.height-1,l=this.width-1,d=this.varIndexByRow[n],h=this.varIndexByCol[i];this.varIndexByRow[n]=h,this.varIndexByCol[i]=d,this.rowByVarIndex[h]=n,this.rowByVarIndex[d]=-1,this.colByVarIndex[h]=-1,this.colByVarIndex[d]=i;for(var c=r[n],u=0,p=0;p<=l;p++)c[p]>=-1e-16&&c[p]<=1e-16?c[p]=0:(c[p]/=o,e[u]=p,u+=1);c[i]=1/o;for(var g,_,y,I=0;I<=a;I++)if(I!==n&&!(r[I][i]>=-1e-16&&r[I][i]<=1e-16)){var w=r[I];if((g=w[i])>=-1e-16&&g<=1e-16)0!==g&&(w[i]=0);else{for(_=0;_<u;_++)(y=c[p=e[_]])>=-1e-16&&y<=1e-16?0!==y&&(c[p]=0):w[p]=w[p]-g*y;w[i]=-g/o}}var x=this.optionalObjectives.length;if(x>0)for(var E=0;E<x;E+=1){var O=this.optionalObjectives[E].reducedCosts;if(0!==(g=O[i])){for(_=0;_<u;_++)0!==(y=c[p=e[_]])&&(O[p]=O[p]-g*y);O[i]=-g/o}}},t.prototype.checkForCycles=function(n){for(var i=0;i<n.length-1;i++)for(var r=i+1;r<n.length;r++){var o=n[i],a=n[r];if(o[0]===a[0]&&o[1]===a[1]){if(r-i>n.length-r)break;for(var l=!0,d=1;d<r-i;d++){var h=n[i+d],c=n[r+d];if(h[0]!==c[0]||h[1]!==c[1]){l=!1;break}}if(l)return[i,r-i]}}return[]}}),s=K((t,e)=>{function n(h,c,u,p){this.id=h,this.cost=c,this.index=u,this.value=0,this.priority=p}function i(h,c,u,p){n.call(this,h,c,u,p)}function r(h,c){n.call(this,h,0,c,0)}function o(h,c){this.variable=h,this.coefficient=c}function a(h,c,u){return 0===u||"required"===u?null:(c=c||1,u=u||1,!1===h.isMinimization&&(c=-c),h.addVariable(c,"r"+h.relaxationIndex++,!1,!1,u))}function l(h,c,u,p){this.slack=new r("s"+u,u),this.index=u,this.model=p,this.rhs=h,this.isUpperBound=c,this.terms=[],this.termsByVarIndex={},this.relaxation=null}function d(h,c){this.upperBound=h,this.lowerBound=c,this.model=h.model,this.rhs=h.rhs,this.relaxation=null}i.prototype.isInteger=!0,r.prototype.isSlack=!0,l.prototype.addTerm=function(h,c){var u=c.index,p=this.termsByVarIndex[u];return void 0===p?(p=new o(c,h),this.termsByVarIndex[u]=p,this.terms.push(p),!0===this.isUpperBound&&(h=-h),this.model.updateConstraintCoefficient(this,c,h)):this.setVariableCoefficient(p.coefficient+h,c),this},l.prototype.removeTerm=function(h){return this},l.prototype.setRightHandSide=function(h){if(h!==this.rhs){var c=h-this.rhs;!0===this.isUpperBound&&(c=-c),this.rhs=h,this.model.updateRightHandSide(this,c)}return this},l.prototype.setVariableCoefficient=function(h,c){var u=c.index;if(-1!==u){var p=this.termsByVarIndex[u];if(void 0===p)this.addTerm(h,c);else if(h!==p.coefficient){var g=h-p.coefficient;!0===this.isUpperBound&&(g=-g),p.coefficient=h,this.model.updateConstraintCoefficient(this,c,g)}return this}console.warn("[Constraint.setVariableCoefficient] Trying to change coefficient of inexistant variable.")},l.prototype.relax=function(h,c){this.relaxation=a(this.model,h,c),this._relax(this.relaxation)},l.prototype._relax=function(h){null!==h&&this.setVariableCoefficient(this.isUpperBound?-1:1,h)},d.prototype.isEquality=!0,d.prototype.addTerm=function(h,c){return this.upperBound.addTerm(h,c),this.lowerBound.addTerm(h,c),this},d.prototype.removeTerm=function(h){return this.upperBound.removeTerm(h),this.lowerBound.removeTerm(h),this},d.prototype.setRightHandSide=function(h){this.upperBound.setRightHandSide(h),this.lowerBound.setRightHandSide(h),this.rhs=h},d.prototype.relax=function(h,c){this.relaxation=a(this.model,h,c),this.upperBound.relaxation=this.relaxation,this.upperBound._relax(this.relaxation),this.lowerBound.relaxation=this.relaxation,this.lowerBound._relax(this.relaxation)},e.exports={Constraint:l,Variable:n,IntegerVariable:i,SlackVariable:r,Equality:d,Term:o}}),f=K(()=>{var t=G(),e=s().SlackVariable;t.prototype.addCutConstraints=function(n){for(var i=n.length,r=this.height,o=r+i,a=r;a<o;a+=1)void 0===this.matrix[a]&&(this.matrix[a]=this.matrix[a-1].slice());this.height=o,this.nVars=this.width+this.height-2;for(var l,d=this.width-1,h=0;h<i;h+=1){var c=n[h],u=r+h,p="min"===c.type?-1:1,g=c.varIndex,_=this.rowByVarIndex[g],y=this.matrix[u];if(-1===_){for(y[this.rhsColumn]=p*c.value,l=1;l<=d;l+=1)y[l]=0;y[this.colByVarIndex[g]]=p}else{var k=this.matrix[_];for(y[this.rhsColumn]=p*(c.value-k[this.rhsColumn]),l=1;l<=d;l+=1)y[l]=-p*k[l]}var w=this.getNewElementIndex();this.varIndexByRow[u]=w,this.rowByVarIndex[w]=u,this.colByVarIndex[w]=-1,this.variablesPerIndex[w]=new e("s"+w,w),this.nVars+=1}},t.prototype._addLowerBoundMIRCut=function(n){if(n===this.costRowIndex)return!1;var r=this.matrix;if(!this.variablesPerIndex[this.varIndexByRow[n]].isInteger)return!1;var a=r[n][this.rhsColumn],l=a-Math.floor(a);if(l<this.precision||1-this.precision<l)return!1;var d=this.height;r[d]=r[d-1].slice(),this.height+=1,this.nVars+=1;var h=this.getNewElementIndex();this.varIndexByRow[d]=h,this.rowByVarIndex[h]=d,this.colByVarIndex[h]=-1,this.variablesPerIndex[h]=new e("s"+h,h),r[d][this.rhsColumn]=Math.floor(a);for(var c=1;c<this.varIndexByCol.length;c+=1)if(this.variablesPerIndex[this.varIndexByCol[c]].isInteger){var p=r[n][c],g=Math.floor(p)+Math.max(0,p-Math.floor(p)-l)/(1-l);r[d][c]=g}else r[d][c]=Math.min(0,r[n][c]/(1-l));for(var _=0;_<this.width;_+=1)r[d][_]-=r[n][_];return!0},t.prototype._addUpperBoundMIRCut=function(n){if(n===this.costRowIndex)return!1;var r=this.matrix;if(!this.variablesPerIndex[this.varIndexByRow[n]].isInteger)return!1;var a=r[n][this.rhsColumn],l=a-Math.floor(a);if(l<this.precision||1-this.precision<l)return!1;var d=this.height;r[d]=r[d-1].slice(),this.height+=1,this.nVars+=1;var h=this.getNewElementIndex();this.varIndexByRow[d]=h,this.rowByVarIndex[h]=d,this.colByVarIndex[h]=-1,this.variablesPerIndex[h]=new e("s"+h,h),r[d][this.rhsColumn]=-l;for(var c=1;c<this.varIndexByCol.length;c+=1){var u=this.variablesPerIndex[this.varIndexByCol[c]],p=r[n][c],g=p-Math.floor(p);r[d][c]=u.isInteger?g<=l?-g:-(1-g)*l/g:p>=0?-p:p*l/(1-l)}return!0},t.prototype.applyMIRCuts=function(){}}),m=K(()=>{var t=G();t.prototype._putInBase=function(e){var n=this.rowByVarIndex[e];if(-1===n){for(var i=this.colByVarIndex[e],r=1;r<this.height;r+=1){var o=this.matrix[r][i];if(o<-this.precision||this.precision<o){n=r;break}}this.pivot(n,i)}return n},t.prototype._takeOutOfBase=function(e){var n=this.colByVarIndex[e];if(-1===n){for(var i=this.rowByVarIndex[e],r=this.matrix[i],o=1;o<this.height;o+=1){var a=r[o];if(a<-this.precision||this.precision<a){n=o;break}}this.pivot(i,n)}return n},t.prototype.updateVariableValues=function(){for(var e=this.variables.length,n=Math.round(1/this.precision),i=0;i<e;i+=1){var r=this.variables[i],a=this.rowByVarIndex[r.index];r.value=-1===a?0:Math.round((this.matrix[a][this.rhsColumn]+Number.EPSILON)*n)/n}},t.prototype.updateRightHandSide=function(e,n){var i=this.height-1,r=this.rowByVarIndex[e.index];if(-1===r){for(var o=this.colByVarIndex[e.index],a=0;a<=i;a+=1){var l=this.matrix[a];l[this.rhsColumn]-=n*l[o]}var d=this.optionalObjectives.length;if(d>0)for(var h=0;h<d;h+=1){var c=this.optionalObjectives[h].reducedCosts;c[this.rhsColumn]-=n*c[o]}}else this.matrix[r][this.rhsColumn]-=n},t.prototype.updateConstraintCoefficient=function(e,n,i){if(e.index===n.index)throw new Error("[Tableau.updateConstraintCoefficient] constraint index should not be equal to variable index !");var r=this._putInBase(e.index),o=this.colByVarIndex[n.index];if(-1===o)for(var a=this.rowByVarIndex[n.index],l=0;l<this.width;l+=1)this.matrix[r][l]+=i*this.matrix[a][l];else this.matrix[r][o]-=i},t.prototype.updateCost=function(e,n){var i=e.index,r=this.width-1,o=this.colByVarIndex[i];if(-1===o){var l,a=this.matrix[this.rowByVarIndex[i]];if(0===e.priority){var d=this.matrix[0];for(l=0;l<=r;l+=1)d[l]+=n*a[l]}else{var h=this.objectivesByPriority[e.priority].reducedCosts;for(l=0;l<=r;l+=1)h[l]+=n*a[l]}}else this.matrix[0][o]-=n},t.prototype.addConstraint=function(e){var n=e.isUpperBound?1:-1,i=this.height,r=this.matrix[i];void 0===r&&(r=this.matrix[0].slice(),this.matrix[i]=r);for(var o=this.width-1,a=0;a<=o;a+=1)r[a]=0;r[this.rhsColumn]=n*e.rhs;for(var l=e.terms,d=l.length,h=0;h<d;h+=1){var c=l[h],u=c.coefficient,p=c.variable.index,g=this.rowByVarIndex[p];if(-1===g)r[this.colByVarIndex[p]]+=n*u;else{var _=this.matrix[g];for(a=0;a<=o;a+=1)r[a]-=n*u*_[a]}}var k=e.index;this.varIndexByRow[i]=k,this.rowByVarIndex[k]=i,this.colByVarIndex[k]=-1,this.height+=1},t.prototype.removeConstraint=function(e){var n=e.index,i=this.height-1,r=this._putInBase(n),o=this.matrix[i];this.matrix[i]=this.matrix[r],this.matrix[r]=o,this.varIndexByRow[r]=this.varIndexByRow[i],this.varIndexByRow[i]=-1,this.rowByVarIndex[n]=-1,this.availableIndexes[this.availableIndexes.length]=n,e.slack.index=-1,this.height-=1},t.prototype.addVariable=function(e){var n=this.height-1,i=this.width,r=!0===this.model.isMinimization?-e.cost:e.cost,o=e.priority,a=this.optionalObjectives.length;if(a>0)for(var l=0;l<a;l+=1)this.optionalObjectives[l].reducedCosts[i]=0;0===o?this.matrix[0][i]=r:(this.setOptionalObjective(o,i,r),this.matrix[0][i]=0);for(var d=1;d<=n;d+=1)this.matrix[d][i]=0;var h=e.index;this.varIndexByCol[i]=h,this.rowByVarIndex[h]=-1,this.colByVarIndex[h]=i,this.width+=1},t.prototype.removeVariable=function(e){var n=e.index,i=this._takeOutOfBase(n),r=this.width-1;if(i!==r){for(var o=this.height-1,a=0;a<=o;a+=1){var l=this.matrix[a];l[i]=l[r]}var d=this.optionalObjectives.length;if(d>0)for(var h=0;h<d;h+=1){var c=this.optionalObjectives[h].reducedCosts;c[i]=c[r]}var u=this.varIndexByCol[r];this.varIndexByCol[i]=u,this.colByVarIndex[u]=i}this.varIndexByCol[r]=-1,this.colByVarIndex[n]=-1,this.availableIndexes[this.availableIndexes.length]=n,e.index=-1,this.width-=1}}),S=K(()=>{G().prototype.log=function(e,n){console.log("****",e,"****"),console.log("Nb Variables",this.width-1),console.log("Nb Constraints",this.height-1),console.log("Basic Indexes",this.varIndexByRow),console.log("Non Basic Indexes",this.varIndexByCol),console.log("Rows",this.rowByVarIndex),console.log("Cols",this.colByVarIndex);var a,l,h,c,u,p,g,y,k,I,w,r="",o=[" "];for(l=1;l<this.width;l+=1)g=(p=void 0===(c=this.variablesPerIndex[u=this.varIndexByCol[l]])?"c"+u:c.id).length,Math.abs(g-5),y=" ",k="\t",g>5?y+=" ":k+="\t",o[l]=y,r+=k+p;console.log(r);var E=this.matrix[this.costRowIndex],O="\t";for(a=1;a<this.width;a+=1)O+="\t",O+=o[a],O+=E[a].toFixed(5);for(O+="\t"+o[0]+E[0].toFixed(5),console.log(O+"\tZ"),h=1;h<this.height;h+=1){for(I=this.matrix[h],w="\t",l=1;l<this.width;l+=1)w+="\t"+o[l]+I[l].toFixed(5);w+="\t"+o[0]+I[0].toFixed(5),p=void 0===(c=this.variablesPerIndex[u=this.varIndexByRow[h]])?"c"+u:c.id,console.log(w+"\t"+p)}console.log("");var b=this.optionalObjectives.length;if(b>0){console.log("    Optional objectives:");for(var F=0;F<b;F+=1){var T=this.optionalObjectives[F].reducedCosts,$="";for(a=1;a<this.width;a+=1)$+=T[a]<0?"":" ",$+=o[a],$+=T[a].toFixed(5);$+=(T[0]<0?"":" ")+o[0]+T[0].toFixed(5),console.log($+" z"+F)}}return console.log("Feasible?",this.feasible),console.log("evaluation",this.evaluation),this}}),D=K(()=>{var t=G();t.prototype.copy=function(){var e=new t(this.precision);e.width=this.width,e.height=this.height,e.nVars=this.nVars,e.model=this.model,e.variables=this.variables,e.variablesPerIndex=this.variablesPerIndex,e.unrestrictedVars=this.unrestrictedVars,e.lastElementIndex=this.lastElementIndex,e.varIndexByRow=this.varIndexByRow.slice(),e.varIndexByCol=this.varIndexByCol.slice(),e.rowByVarIndex=this.rowByVarIndex.slice(),e.colByVarIndex=this.colByVarIndex.slice(),e.availableIndexes=this.availableIndexes.slice();for(var n=[],i=0;i<this.optionalObjectives.length;i++)n[i]=this.optionalObjectives[i].copy();e.optionalObjectives=n;for(var r=this.matrix,o=new Array(this.height),a=0;a<this.height;a++)o[a]=r[a].slice();return e.matrix=o,e},t.prototype.save=function(){this.savedState=this.copy()},t.prototype.restore=function(){if(null!==this.savedState){var i,r,e=this.savedState,n=e.matrix;for(this.nVars=e.nVars,this.model=e.model,this.variables=e.variables,this.variablesPerIndex=e.variablesPerIndex,this.unrestrictedVars=e.unrestrictedVars,this.lastElementIndex=e.lastElementIndex,this.width=e.width,this.height=e.height,i=0;i<this.height;i+=1){var o=n[i],a=this.matrix[i];for(r=0;r<this.width;r+=1)a[r]=o[r]}var l=e.varIndexByRow;for(r=0;r<this.height;r+=1)this.varIndexByRow[r]=l[r];for(;this.varIndexByRow.length>this.height;)this.varIndexByRow.pop();var d=e.varIndexByCol;for(i=0;i<this.width;i+=1)this.varIndexByCol[i]=d[i];for(;this.varIndexByCol.length>this.width;)this.varIndexByCol.pop();for(var h=e.rowByVarIndex,c=e.colByVarIndex,u=0;u<this.nVars;u+=1)this.rowByVarIndex[u]=h[u],this.colByVarIndex[u]=c[u];if(e.optionalObjectives.length>0&&this.optionalObjectives.length>0){this.optionalObjectives=[],this.optionalObjectivePerPriority={};for(var p=0;p<e.optionalObjectives.length;p++){var g=e.optionalObjectives[p].copy();this.optionalObjectives[p]=g,this.optionalObjectivePerPriority[g.priority]=g}}}}}),B=K(()=>{var t=G();function e(n,i){this.index=n,this.value=i}t.prototype.getMostFractionalVar=function(){for(var n=0,i=null,r=null,a=this.model.integerVariables,l=a.length,d=0;d<l;d++){var h=a[d].index,c=this.rowByVarIndex[h];if(-1!==c){var u=this.matrix[c][this.rhsColumn],p=Math.abs(u-Math.round(u));n<p&&(n=p,i=h,r=u)}}return new e(i,r)},t.prototype.getFractionalVarWithLowestCost=function(){for(var n=1/0,i=null,r=null,o=this.model.integerVariables,a=o.length,l=0;l<a;l++){var d=o[l],h=d.index,c=this.rowByVarIndex[h];if(-1!==c){var u=this.matrix[c][this.rhsColumn];if(Math.abs(u-Math.round(u))>this.precision){var p=d.cost;n>p&&(n=p,i=h,r=u)}}}return new e(i,r)}}),J=K(()=>{var t=G();t.prototype.countIntegerValues=function(){for(var e=0,n=1;n<this.height;n+=1)if(this.variablesPerIndex[this.varIndexByRow[n]].isInteger){var i=this.matrix[n][this.rhsColumn];(i-=Math.floor(i))<this.precision&&-i<this.precision&&(e+=1)}return e},t.prototype.isIntegral=function(){for(var e=this.model.integerVariables,n=e.length,i=0;i<n;i++){var r=this.rowByVarIndex[e[i].index];if(-1!==r){var o=this.matrix[r][this.rhsColumn];if(Math.abs(o-Math.round(o))>this.precision)return!1}}return!0},t.prototype.computeFractionalVolume=function(e){for(var n=-1,i=1;i<this.height;i+=1)if(this.variablesPerIndex[this.varIndexByRow[i]].isInteger){var r=this.matrix[i][this.rhsColumn];if(r=Math.abs(r),Math.min(r-Math.floor(r),Math.floor(r+1))<this.precision){if(!e)return 0}else-1===n?n=r:n*=r}return-1===n?0:n}}),ct=K((t,e)=>{Me(),f(),m(),S(),D(),B(),J(),e.exports=G()}),lt=K(()=>{var t=G();function e(r,o,a){this.type=r,this.varIndex=o,this.value=a}function n(r,o){this.relaxedEvaluation=r,this.cuts=o}function i(r,o){return o.relaxedEvaluation-r.relaxedEvaluation}t.prototype.applyCuts=function(r){if(this.restore(),this.addCutConstraints(r),this.simplex(),this.model.useMIRCuts)for(var o=!0;o;){var a=this.computeFractionalVolume(!0);this.applyMIRCuts(),this.simplex(),this.computeFractionalVolume(!0)>=.9*a&&(o=!1)}},t.prototype.branchAndCut=function(){var r=[],o=0,a=this.model.tolerance,l=!0,d=1e99;this.model.timeout&&(d=Date.now()+this.model.timeout);for(var h=1/0,c=null,u=[],p=0;p<this.optionalObjectives.length;p+=1)u.push(1/0);var g=new n(-1/0,[]);for(r.push(g);r.length>0&&!0===l&&Date.now()<d;)if(a>0&&h<(this.model.isMinimization?this.bestPossibleEval*(1+a):this.bestPossibleEval*(1-a))&&(l=!1),!((g=r.pop()).relaxedEvaluation>h)){var y=g.cuts;if(this.applyCuts(y),o++,!1!==this.feasible){var k=this.evaluation;if(!(k>h)){if(k===h){for(var I=!0,w=0;w<this.optionalObjectives.length&&!(this.optionalObjectives[w].reducedCosts[0]>u[w]);w+=1)if(this.optionalObjectives[w].reducedCosts[0]<u[w]){I=!1;break}if(I)continue}if(!0===this.isIntegral()){if(this.__isIntegral=!0,1===o)return void(this.branchAndCutIterations=o);c=g,h=k;for(var x=0;x<this.optionalObjectives.length;x+=1)u[x]=this.optionalObjectives[x].reducedCosts[0]}else{1===o&&this.save();for(var E=this.getMostFractionalVar(),O=E.index,b=[],F=[],T=y.length,$=0;$<T;$+=1){var V=y[$];V.varIndex===O?"min"===V.type?F.push(V):b.push(V):(b.push(V),F.push(V))}var Y=Math.ceil(E.value),Q=Math.floor(E.value),tt=new e("min",O,Y);b.push(tt);var dt=new e("max",O,Q);F.push(dt),r.push(new n(k,b)),r.push(new n(k,F)),r.sort(i)}}}}null!==c&&this.applyCuts(c.cuts),this.branchAndCutIterations=o}}),N=K((t,e)=>{var n=G(),r=(lt(),s()),o=r.Constraint,a=r.Equality,l=r.Variable,d=r.IntegerVariable;function c(u,p){this.tableau=new n(u),this.name=p,this.variables=[],this.integerVariables=[],this.unrestrictedVariables={},this.constraints=[],this.nConstraints=0,this.nVariables=0,this.isMinimization=!0,this.tableauInitialized=!1,this.relaxationIndex=1,this.useMIRCuts=!1,this.checkForCycles=!0,this.messages=[]}e.exports=c,c.prototype.minimize=function(){return this.isMinimization=!0,this},c.prototype.maximize=function(){return this.isMinimization=!1,this},c.prototype._getNewElementIndex=function(){if(this.availableIndexes.length>0)return this.availableIndexes.pop();var u=this.lastElementIndex;return this.lastElementIndex+=1,u},c.prototype._addConstraint=function(u){var p=u.slack;this.tableau.variablesPerIndex[p.index]=p,this.constraints.push(u),this.nConstraints+=1,!0===this.tableauInitialized&&this.tableau.addConstraint(u)},c.prototype.smallerThan=function(u){var p=new o(u,!0,this.tableau.getNewElementIndex(),this);return this._addConstraint(p),p},c.prototype.greaterThan=function(u){var p=new o(u,!1,this.tableau.getNewElementIndex(),this);return this._addConstraint(p),p},c.prototype.equal=function(u){var p=new o(u,!0,this.tableau.getNewElementIndex(),this);this._addConstraint(p);var g=new o(u,!1,this.tableau.getNewElementIndex(),this);return this._addConstraint(g),new a(p,g)},c.prototype.addVariable=function(u,p,g,_,y){if("string"==typeof y)switch(y){case"required":default:y=0;break;case"strong":y=1;break;case"medium":y=2;break;case"weak":y=3}var I,k=this.tableau.getNewElementIndex();return null==p&&(p="v"+k),null==u&&(u=0),null==y&&(y=0),g?(I=new d(p,u,k,y),this.integerVariables.push(I)):I=new l(p,u,k,y),this.variables.push(I),this.tableau.variablesPerIndex[k]=I,_&&(this.unrestrictedVariables[k]=!0),this.nVariables+=1,!0===this.tableauInitialized&&this.tableau.addVariable(I),I},c.prototype._removeConstraint=function(u){var p=this.constraints.indexOf(u);-1!==p?(this.constraints.splice(p,1),this.nConstraints-=1,!0===this.tableauInitialized&&this.tableau.removeConstraint(u),u.relaxation&&this.removeVariable(u.relaxation)):console.warn("[Model.removeConstraint] Constraint not present in model")},c.prototype.removeConstraint=function(u){return u.isEquality?(this._removeConstraint(u.upperBound),this._removeConstraint(u.lowerBound)):this._removeConstraint(u),this},c.prototype.removeVariable=function(u){var p=this.variables.indexOf(u);if(-1!==p)return this.variables.splice(p,1),!0===this.tableauInitialized&&this.tableau.removeVariable(u),this;console.warn("[Model.removeVariable] Variable not present in model")},c.prototype.updateRightHandSide=function(u,p){return!0===this.tableauInitialized&&this.tableau.updateRightHandSide(u,p),this},c.prototype.updateConstraintCoefficient=function(u,p,g){return!0===this.tableauInitialized&&this.tableau.updateConstraintCoefficient(u,p,g),this},c.prototype.setCost=function(u,p){var g=u-p.cost;return!1===this.isMinimization&&(g=-g),p.cost=u,this.tableau.updateCost(p,g),this},c.prototype.loadJson=function(u){this.isMinimization="max"!==u.opType;for(var p=u.variables,g=u.constraints,_={},y={},k=Object.keys(g),I=k.length,w=0;w<I;w+=1){var $,V,x=k[w],E=g[x],O=E.equal,b=E.weight,F=E.priority,T=void 0!==b||void 0!==F;if(void 0===O){var Y=E.min;void 0!==Y&&($=this.greaterThan(Y),_[x]=$,T&&$.relax(b,F));var Q=E.max;void 0!==Q&&(V=this.smallerThan(Q),y[x]=V,T&&V.relax(b,F))}else{$=this.greaterThan(O),_[x]=$,V=this.smallerThan(O),y[x]=V;var tt=new a($,V);T&&tt.relax(b,F)}}var dt=Object.keys(p),xt=dt.length;this.tolerance=u.tolerance||0,u.timeout&&(this.timeout=u.timeout),u.options&&(u.options.timeout&&(this.timeout=u.options.timeout),0===this.tolerance&&(this.tolerance=u.options.tolerance||0),u.options.useMIRCuts&&(this.useMIRCuts=u.options.useMIRCuts),this.checkForCycles=typeof u.options.exitOnCycles>"u"||u.options.exitOnCycles);for(var pt=u.ints||{},vt=u.binaries||{},It=u.unrestricted||{},Nt=u.optimize,Gt=0;Gt<xt;Gt+=1){var At=dt[Gt],zt=p[At],Fe=!!vt[At],Pt=this.addVariable(zt[Nt]||0,At,!!pt[At]||Fe,!!It[At]);Fe&&this.smallerThan(1).addTerm(1,Pt);var me=Object.keys(zt);for(w=0;w<me.length;w+=1){var Yt=me[w];if(Yt!==Nt){var Ce=zt[Yt],je=_[Yt];void 0!==je&&je.addTerm(Ce,Pt);var Qe=y[Yt];void 0!==Qe&&Qe.addTerm(Ce,Pt)}}}return this},c.prototype.getNumberOfIntegerVariables=function(){return this.integerVariables.length},c.prototype.solve=function(){return!1===this.tableauInitialized&&(this.tableau.setModel(this),this.tableauInitialized=!0),this.tableau.solve()},c.prototype.isFeasible=function(){return this.tableau.feasible},c.prototype.save=function(){return this.tableau.save()},c.prototype.restore=function(){return this.tableau.restore()},c.prototype.activateMIRCuts=function(u){this.useMIRCuts=u},c.prototype.debug=function(u){this.checkForCycles=u},c.prototype.log=function(u){return this.tableau.log(u)}}),W=K(t=>{t.CleanObjectiveAttributes=function(e){var n,i,r;if("string"==typeof e.optimize){if(e.constraints[e.optimize]){for(i in n=Math.random(),e.variables)e.variables[i][e.optimize]&&(e.variables[i][n]=e.variables[i][e.optimize]);return e.constraints[n]=e.constraints[e.optimize],delete e.constraints[e.optimize],e}return e}for(r in e.optimize)if(e.constraints[r])if("equal"===e.constraints[r])delete e.optimize[r];else{for(i in n=Math.random(),e.variables)e.variables[i][r]&&(e.variables[i][n]=e.variables[i][r]);e.constraints[n]=e.constraints[r],delete e.constraints[r]}return e}}),mt=K((t,e)=>{e.exports=function(r){return r.length?function n(r){var o={is_blank:/^\W{0,}$/,is_objective:/(max|min)(imize){0,}\:/i,is_int:/^(?!\/\*)\W{0,}int/i,is_bin:/^(?!\/\*)\W{0,}bin/i,is_constraint:/(\>|\<){0,}\=/i,is_unrestricted:/^\S{0,}unrestricted/i,parse_lhs:/(\-|\+){0,1}\s{0,1}\d{0,}\.{0,}\d{0,}\s{0,}[A-Za-z]\S{0,}/gi,parse_rhs:/(\-|\+){0,1}\d{1,}\.{0,}\d{0,}\W{0,}\;{0,1}$/i,parse_dir:/(\>|\<){0,}\=/gi,parse_int:/[^\s|^\,]+/gi,parse_bin:/[^\s|^\,]+/gi,get_num:/(\-|\+){0,1}(\W|^)\d+\.{0,1}\d{0,}/g,get_word:/[A-Za-z].*/},a={opType:"",optimize:"_obj",constraints:{},variables:{}},l={">=":"min","<=":"max","=":"equal"},d="",c=null,u="",p="",g="",_=0;"string"==typeof r&&(r=r.split("\n"));for(var y=0;y<r.length;y++)if(g="__"+y,c=null,o.is_objective.test(d=r[y]))a.opType=d.match(/(max|min)/gi)[0],(c=d.match(o.parse_lhs).map(function(w){return w.replace(/\s+/,"")}).slice(1)).forEach(function(w){u=null===(u=w.match(o.get_num))?"-"===w.substr(0,1)?-1:1:u[0],u=parseFloat(u),p=w.match(o.get_word)[0].replace(/\;$/,""),a.variables[p]=a.variables[p]||{},a.variables[p]._obj=u});else if(o.is_int.test(d))c=d.match(o.parse_int).slice(1),a.ints=a.ints||{},c.forEach(function(w){w=w.replace(";",""),a.ints[w]=1});else if(o.is_bin.test(d))c=d.match(o.parse_bin).slice(1),a.binaries=a.binaries||{},c.forEach(function(w){w=w.replace(";",""),a.binaries[w]=1});else if(o.is_constraint.test(d)){var k=d.indexOf(":");(c=(-1===k?d:d.slice(k+1)).match(o.parse_lhs).map(function(w){return w.replace(/\s+/,"")})).forEach(function(w){u=null===(u=w.match(o.get_num))?"-"===w.substr(0,1)?-1:1:u[0],u=parseFloat(u),p=w.match(o.get_word)[0],a.variables[p]=a.variables[p]||{},a.variables[p][g]=u}),_=parseFloat(d.match(o.parse_rhs)[0]),d=l[d.match(o.parse_dir)[0]],a.constraints[g]=a.constraints[g]||{},a.constraints[g][d]=_}else o.is_unrestricted.test(d)&&(c=d.match(o.parse_int).slice(1),a.unrestricted=a.unrestricted||{},c.forEach(function(w){w=w.replace(";",""),a.unrestricted[w]=1}));return a}(r):function i(r){if(!r)throw new Error("Solver requires a model to operate on");var o="",d={max:"<=",min:">=",equal:"="},h=new RegExp("[^A-Za-z0-9_[{}/.&#$%~'@^]","gi");if(r.opType)for(var c in o+=r.opType+":",r.variables)r.variables[c][c]=r.variables[c][c]?r.variables[c][c]:1,r.variables[c][r.optimize]&&(o+=" "+r.variables[c][r.optimize]+" "+c.replace(h,"_"));else o+="max:";for(var u in o+=";\n\n",r.constraints)for(var p in r.constraints[u])if(typeof d[p]<"u"){for(var g in r.variables)typeof r.variables[g][u]<"u"&&(o+=" "+r.variables[g][u]+" "+g.replace(h,"_"));o+=" "+d[p]+" "+r.constraints[u][p],o+=";\n"}if(r.ints)for(var _ in o+="\n\n",r.ints)o+="int "+_.replace(h,"_")+";\n";if(r.unrestricted)for(var y in o+="\n\n",r.unrestricted)o+="unrestricted "+y.replace(h,"_")+";\n";return o}(r)}}),A=K(()=>{}),P=K(()=>{}),R=K(t=>{function e(n){return(n=(n=n.replace("\\r\\n","\r\n")).split("\r\n")).filter(function(i){var r;return!(!0===(r=new RegExp(" 0$","gi")).test(i)||(r=new RegExp("\\d$","gi"),!1===r.test(i)))}).map(function(i){return i.split(/\:{0,1} +(?=\d)/)}).reduce(function(i,r,o){return i[r[0]]=r[1],i},{})}t.reformat=mt(),t.solve=function(n){return new Promise(function(i,r){typeof window<"u"&&r("Function Not Available in Browser");var o=mt()(n);n.external||r("Data for this function must be contained in the 'external' attribute. Not seeing anything there."),n.external.binPath||r("No Executable | Binary path provided in arguments as 'binPath'"),n.external.args||r("No arguments array for cli | bash provided on 'args' attribute"),n.external.tempName||r("No 'tempName' given. This is necessary to produce a staging file for the solver to operate on"),A().writeFile(n.external.tempName,o,function(l,d){if(l)r(l);else{var h=P().execFile;n.external.args.push(n.external.tempName),h(n.external.binPath,n.external.args,function(c,u){c?1===c.code?i(e(u)):r({code:c.code,meaning:{"-2":"Out of Memory",1:"SUBOPTIMAL",2:"INFEASIBLE",3:"UNBOUNDED",4:"DEGENERATE",5:"NUMFAILURE",6:"USER-ABORT",7:"TIMEOUT",9:"PRESOLVED",25:"ACCURACY ERROR",255:"FILE-ERROR"}[c.code],data:u}):i(e(u))})}})})}}),rt=K((t,e)=>{e.exports={lpsolve:R()}}),ft=K((t,e)=>{e.exports=function(n,i){var l,g,_,y,k,r=i.optimize,o=JSON.parse(JSON.stringify(i.optimize)),a=Object.keys(i.optimize),d=0,h={},c="",u={},p=[];for(delete i.optimize,g=0;g<a.length;g++)o[a[g]]=0;for(g=0;g<a.length;g++){for(k in i.optimize=a[g],i.opType=r[a[g]],l=n.Solve(i,void 0,void 0,!0),a)if(!i.variables[a[k]])for(y in l[a[k]]=l[a[k]]?l[a[k]]:0,i.variables)i.variables[y][a[k]]&&l[y]&&(l[a[k]]+=l[y]*i.variables[y][a[k]]);for(c="base",_=0;_<a.length;_++)c+=l[a[_]]?"-"+(1e3*l[a[_]]|0)/1e3:"-0";if(!h[c]){for(h[c]=1,d++,_=0;_<a.length;_++)l[a[_]]&&(o[a[_]]+=l[a[_]]);delete l.feasible,delete l.result,p.push(l)}}for(g=0;g<a.length;g++)i.constraints[a[g]]={equal:o[a[g]]/d};for(g in i.optimize="cheater-"+Math.random(),i.opType="max",i.variables)i.variables[g].cheater=1;for(g in p)for(y in p[g])u[y]=u[y]||{min:1e99,max:-1e99};for(g in u)for(y in p)p[y][g]?(p[y][g]>u[g].max&&(u[g].max=p[y][g]),p[y][g]<u[g].min&&(u[g].min=p[y][g])):(p[y][g]=0,u[g].min=0);return{midpoint:l=n.Solve(i,void 0,void 0,!0),vertices:p,ranges:u}}}),kt=K((t,e)=>{var n=ct(),i=N(),r=lt(),o=s(),a=W(),l=o.Constraint,d=o.Variable,h=o.Numeral,c=o.Term,u=rt(),p=function(){this.Model=i,this.branchAndCut=r,this.Constraint=l,this.Variable=d,this.Numeral=h,this.Term=c,this.Tableau=n,this.lastSolvedModel=null,this.External=u,this.Solve=function(g,_,y,k){if(k)for(var I in a)g=a[I](g);if(!g)throw new Error("Solver requires a model to operate on");if("object"==typeof g.optimize&&Object.keys(g.optimize>1))return ft()(this,g);if(g.external){var w=Object.keys(u);if(w=JSON.stringify(w),!g.external.solver)throw new Error("The model you provided has an 'external' object that doesn't have a solver attribute. Use one of the following:"+w);if(!u[g.external.solver])throw new Error("No support (yet) for "+g.external.solver+". Please use one of these instead:"+w);return u[g.external.solver].solve(g)}g instanceof i||(g=new i(_).loadJson(g));var x=g.solve();if(this.lastSolvedModel=g,x.solutionSet=x.generateSolutionSet(),y)return x;var E={};return E.feasible=x.feasible,E.result=x.evaluation,E.bounded=x.bounded,x._tableau.__isIntegral&&(E.isIntegral=!0),Object.keys(x.solutionSet).forEach(function(O){0!==x.solutionSet[O]&&(E[O]=x.solutionSet[O])}),E},this.ReformatLP=mt(),this.MultiObjective=function(g){return ft()(this,g)}};"function"==typeof define?define([],function(){return new p}):"object"==typeof window?window.solver=new p:"object"==typeof self&&(self.solver=new p),e.exports=new p}),Zt=K((t,e)=>{var i,r,n=1e-60;do{i=1+.1*(n+=n),r=1+.2*n}while(i<=1||r<=1);e.exports=n}),Rt=K((t,e)=>{e.exports=function n(i,r,o){let a,l;for(let d=1;d<=o;d+=1){i[d][d]=1/i[d][d],l=-i[d][d];for(let h=1;h<d;h+=1)i[h][d]*=l;if(a=d+1,o<a)break;for(let h=a;h<=o;h+=1){l=i[d][h],i[d][h]=0;for(let c=1;c<=d;c+=1)i[c][h]+=l*i[c][d]}}}}),we=K((t,e)=>{e.exports=function n(i,r,o,a){let l,d;for(l=1;l<=o;l+=1){d=0;for(let h=1;h<l;h+=1)d+=i[h][l]*a[h];a[l]=(a[l]-d)/i[l][l]}for(let h=1;h<=o;h+=1){l=o+1-h,a[l]/=i[l][l],d=-a[l];for(let c=1;c<l;c+=1)a[c]+=d*i[c][l]}}}),rr=K((t,e)=>{e.exports=function n(i,r,o,a){let l,d,h;for(let c=1;c<=o;c+=1){if(a[1]=c,h=0,l=c-1,l<1){if(h=i[c][c]-h,h<=0)break;i[c][c]=Math.sqrt(h)}else{for(let u=1;u<=l;u+=1){d=i[u][c];for(let p=1;p<u;p+=1)d-=i[p][c]*i[p][u];d/=i[u][u],i[u][c]=d,h+=d*d}if(h=i[c][c]-h,h<=0)break;i[c][c]=Math.sqrt(h)}a[1]=0}}}),nr=K((t,e)=>{var n=Zt(),i=Rt(),r=we(),o=rr();e.exports=function a(l,d,h,c,u,p,g,_,y,k,I,w,x,E=0,O,b,F){let T,$,V,Y,Q,tt,dt,xt,pt,vt,It,Nt,Gt,At,zt=Math.min(c,I),Dt=2*c+zt*(zt+5)/2+2*I+1;for(let M=1;M<=c;M+=1)b[M]=d[M];for(let M=c+1;M<=Dt;M+=1)b[M]=0;for(let M=1;M<=I;M+=1)x[M]=0,p[M]=0;let Fe=[];if(0===F[1]){if(o(l,h,c,Fe),0!==Fe[1])return void(F[1]=2);r(l,h,c,d),i(l,h,c)}else{for(let M=1;M<=c;M+=1){u[M]=0;for(let st=1;st<=M;st+=1)u[M]+=l[st][M]*d[st]}for(let M=1;M<=c;M+=1){d[M]=0;for(let st=M;st<=c;st+=1)d[M]+=l[M][st]*u[st]}}g[1]=0;for(let M=1;M<=c;M+=1){u[M]=d[M],g[1]+=b[M]*u[M],b[M]=0;for(let st=M+1;st<=c;st+=1)l[st][M]=0}g[1]=-g[1]/2,F[1]=0;let le=c,Kt=le+c,Pt=Kt+zt,me=Pt+zt+1,Yt=me+zt*(zt+1)/2,Ce=Yt+I;for(let M=1;M<=I;M+=1){tt=0;for(let st=1;st<=c;st+=1)tt+=_[st][M]*_[st][M];b[Ce+M]=Math.sqrt(tt)}function je(){O[1]+=1,Dt=Yt;for(let M=1;M<=I;M+=1){Dt+=1,tt=-y[M];for(let st=1;st<=c;st+=1)tt+=_[st][M]*u[st];if(Math.abs(tt)<n&&(tt=0),M>w)b[Dt]=tt;else if(b[Dt]=-Math.abs(tt),tt>0){for(let st=1;st<=c;st+=1)_[st][M]=-_[st][M];y[M]=-y[M]}}for(let M=1;M<=Y;M+=1)b[Yt+x[M]]=0;V=0,Q=0;for(let M=1;M<=I;M+=1)b[Yt+M]<Q*b[Ce+M]&&(V=M,Q=b[Yt+M]/b[Ce+M]);if(0===V){for(let M=1;M<=Y;M+=1)p[x[M]]=b[Pt+M];return 999}return 0}function Qe(){for(let M=1;M<=c;M+=1){tt=0;for(let st=1;st<=c;st+=1)tt+=l[st][M]*_[st][V];b[M]=tt}T=le;for(let M=1;M<=c;M+=1)b[T+M]=0;for(let M=Y+1;M<=c;M+=1)for(let st=1;st<=c;st+=1)b[T+st]=b[T+st]+l[st][M]*b[M];Nt=!0;for(let M=Y;M>=1;M-=1){tt=b[M],Dt=me+M*(M+3)/2,T=Dt-M;for(let st=M+1;st<=Y;st+=1)tt-=b[Dt]*b[Kt+st],Dt+=st;tt/=b[T],b[Kt+M]=tt,!(x[M]<=w)&&(tt<=0||(Nt=!1,$=M))}if(!Nt){dt=b[Pt+$]/b[Kt+$];for(let M=1;M<=Y;M+=1)x[M]<=w||b[Kt+M]<=0||(Q=b[Pt+M]/b[Kt+M],Q<dt&&(dt=Q,$=M))}tt=0;for(let M=le+1;M<=le+c;M+=1)tt+=b[M]*b[M];if(Math.abs(tt)<=n){if(Nt)return F[1]=1,999;for(let M=1;M<=Y;M+=1)b[Pt+M]=b[Pt+M]-dt*b[Kt+M];return b[Pt+Y+1]=b[Pt+Y+1]+dt,700}tt=0;for(let M=1;M<=c;M+=1)tt+=b[le+M]*_[M][V];xt=-b[Yt+V]/tt,Gt=!0,Nt||dt<xt&&(xt=dt,Gt=!1);for(let M=1;M<=c;M+=1)u[M]+=xt*b[le+M],Math.abs(u[M])<n&&(u[M]=0);g[1]+=xt*tt*(xt/2+b[Pt+Y+1]);for(let M=1;M<=Y;M+=1)b[Pt+M]=b[Pt+M]-xt*b[Kt+M];if(b[Pt+Y+1]=b[Pt+Y+1]+xt,!Gt){tt=-y[V];for(let M=1;M<=c;M+=1)tt+=u[M]*_[M][V];if(V>w)b[Yt+V]=tt;else if(b[Yt+V]=-Math.abs(tt),tt>0){for(let M=1;M<=c;M+=1)_[M][V]=-_[M][V];y[V]=-y[V]}return 700}Y+=1,x[Y]=V,Dt=me+(Y-1)*Y/2+1;for(let M=1;M<=Y-1;M+=1)b[Dt]=b[M],Dt+=1;if(Y===c)b[Dt]=b[c];else{for(let M=c;M>=Y+1;M-=1)if(0!==b[M]&&(pt=Math.max(Math.abs(b[M-1]),Math.abs(b[M])),vt=Math.min(Math.abs(b[M-1]),Math.abs(b[M])),Q=b[M-1]>=0?Math.abs(pt*Math.sqrt(1+vt*vt/(pt*pt))):-Math.abs(pt*Math.sqrt(1+vt*vt/(pt*pt))),pt=b[M-1]/Q,vt=b[M]/Q,1!==pt))if(0===pt){b[M-1]=vt*Q;for(let st=1;st<=c;st+=1)Q=l[st][M-1],l[st][M-1]=l[st][M],l[st][M]=Q}else{b[M-1]=Q,It=vt/(1+pt);for(let st=1;st<=c;st+=1)Q=pt*l[st][M-1]+vt*l[st][M],l[st][M]=It*(l[st][M-1]+Q)-l[st][M],l[st][M-1]=Q}b[Dt]=b[Y]}return 0}function Rn(){if(Dt=me+$*($+1)/2+1,T=Dt+$,0===b[T]||(pt=Math.max(Math.abs(b[T-1]),Math.abs(b[T])),vt=Math.min(Math.abs(b[T-1]),Math.abs(b[T])),Q=b[T-1]>=0?Math.abs(pt*Math.sqrt(1+vt*vt/(pt*pt))):-Math.abs(pt*Math.sqrt(1+vt*vt/(pt*pt))),pt=b[T-1]/Q,vt=b[T]/Q,1===pt))return 798;if(0===pt){for(let M=$+1;M<=Y;M+=1)Q=b[T-1],b[T-1]=b[T],b[T]=Q,T+=M;for(let M=1;M<=c;M+=1)Q=l[M][$],l[M][$]=l[M][$+1],l[M][$+1]=Q}else{It=vt/(1+pt);for(let M=$+1;M<=Y;M+=1)Q=pt*b[T-1]+vt*b[T],b[T]=It*(b[T-1]+Q)-b[T],b[T-1]=Q,T+=M;for(let M=1;M<=c;M+=1)Q=pt*l[M][$]+vt*l[M][$+1],l[M][$+1]=It*(l[M][$]+Q)-l[M][$+1],l[M][$]=Q}return 0}function zn(){T=Dt-$;for(let M=1;M<=$;M+=1)b[T]=b[Dt],Dt+=1,T+=1;return b[Pt+$]=b[Pt+$+1],x[$]=x[$+1],$+=1,$<Y?797:0}function ir(){return b[Pt+Y]=b[Pt+Y+1],b[Pt+Y+1]=0,x[Y]=0,Y-=1,O[2]+=1,0}for(Y=E,O[1]=0,O[2]=0,At=0;;){if(At=je(),999===At)return;for(;At=Qe(),0!==At;){if(999===At)return;if(700===At)if($===Y)ir();else{for(;Rn(),At=zn(),797===At;);ir()}}}}}),or=K(t=>{var e=nr();t.solveQP=function n(i,r,o,a=[],l=0,d=[0,0]){let h=[],c=[],u=[],p=[],g=[],_=[],y="",k=i.length-1,I=o[1].length-1;if(!a)for(let E=1;E<=I;E+=1)a[E]=0;if(k!==i[1].length-1&&(y="Dmat is not symmetric!"),k!==r.length-1&&(y="Dmat and dvec are incompatible!"),k!==o.length-1&&(y="Amat and dvec are incompatible!"),I!==a.length-1&&(y="Amat and bvec are incompatible!"),(l>I||l<0)&&(y="Value of meq is invalid!"),""!==y)return{message:y};for(let E=1;E<=I;E+=1)c[E]=0,p[E]=0;let x=Math.min(k,I);for(let E=1;E<=k;E+=1)u[E]=0;h[1]=0;for(let E=1;E<=2*k+x*(x+5)/2+2*I+1;E+=1)g[E]=0;for(let E=1;E<=2;E+=1)_[E]=0;return e(i,r,k,k,u,p,h,o,a,k,I,l,c,0,_,g,d),1===d[1]&&(y="constraints are inconsistent, no solution!"),2===d[1]&&(y="matrix D in quadratic function is not positive definite!"),{solution:u,Lagrangian:p,value:h,unconstrained_solution:r,iterations:_,iact:c,message:y}}}),sr=K((t,e)=>{e.exports=or()});function lr(t){for(let e of t)return e}function $e(t){for(let e of t)return t.delete(e),e}function qe(t,e,n){let i=t.get(e);void 0===i?t.set(e,[n]):i.push(n)}function Ke(t,e,n){let i=t.get(e);void 0===i?t.set(e,new Set([n])):i.add(n)}function vi(t,e,n){let i=t.get(e);void 0!==i&&(i.delete(n),i.size||t.delete(e))}var{toString:cr}=Object.prototype,{propertyIsEnumerable:ur}=Object.prototype;function*Se(t,...e){let i,n=new Set;for(;void 0!==(i=e.pop());)n.has(i)||(yield i,n.add(i),e.push(...t(i)))}function ti(t,e){let n=[];for(let[i,r]of Ft(e))n.push(t[i]),n.push(r);return n.push(t[t.length-1]),n.join("")}function H(t,...e){let n=St(e,i=>function pr(t,e,n){let i=[];return function r(o,a={},l=""){let h,d=a.indent||"\t";h=void 0===a.inlineCharacterLimit?{newline:"\n",newlineOrSpace:"\n",pad:l,indent:l+d}:{newline:"@@__STRINGIFY_OBJECT_NEW_LINE__@@",newlineOrSpace:"@@__STRINGIFY_OBJECT_NEW_LINE_OR_SPACE__@@",pad:"@@__STRINGIFY_OBJECT_PAD__@@",indent:"@@__STRINGIFY_OBJECT_INDENT__@@"};let c=u=>{if(void 0===a.inlineCharacterLimit)return u;let p=u.replace(new RegExp(h.newline,"g"),"").replace(new RegExp(h.newlineOrSpace,"g")," ").replace(new RegExp(h.pad+"|"+h.indent,"g"),"");return p.length<=a.inlineCharacterLimit?p:u.replace(new RegExp(h.newline+"|"+h.newlineOrSpace,"g"),"\n").replace(new RegExp(h.pad,"g"),l).replace(new RegExp(h.indent,"g"),l+d)};if(i.includes(o))return'"[Circular]"';if(null==o||"number"==typeof o||"boolean"==typeof o||"function"==typeof o||"symbol"==typeof o||function hr(t){return"[object RegExp]"===cr.call(t)}(o))return String(o);if(o instanceof Date)return`new Date('${o.toISOString()}')`;if(Array.isArray(o)){if(0===o.length)return"[]";i.push(o);let u="["+h.newline+o.map((p,g)=>{let _=o.length-1===g?h.newline:","+h.newlineOrSpace,y=r(p,a,l+d);return a.transform&&(y=a.transform(o,g,y)),h.indent+y+_}).join("")+h.pad+"]";return i.pop(),c(u)}if(function dr(t){let e=typeof t;return null!==t&&("object"===e||"function"===e)}(o)){let u=function fr(t){return[...Object.keys(t),...Object.getOwnPropertySymbols(t).filter(e=>ur.call(t,e))]}(o);if(a.filter&&(u=u.filter(g=>a.filter(o,g))),0===u.length)return"{}";i.push(o);let p="{"+h.newline+u.map((g,_)=>{let y=u.length-1===_?h.newline:","+h.newlineOrSpace,k="symbol"==typeof g,I=!k&&/^[a-z$_][$\w]*$/i.test(g),w=k||I?g:r(g,a),x=r(o[g],a,l+d);return a.transform&&(x=a.transform(o,g,x)),h.indent+String(w)+": "+x+y}).join("")+h.pad+"}";return i.pop(),c(p)}return o=o.replace(/\\/g,"\\\\"),o=String(o).replace(/[\r\n]/g,u=>"\n"===u?"\\n":"\\r"),!1===a.singleQuotes?`"${o=o.replace(/"/g,'\\"')}"`:`'${o=o.replace(/'/g,"\\'")}'`}(t,e,n)}(i,{indent:"  ",singleQuotes:!1,inlineCharacterLimit:60}));return new Error(ti(t,n))}function mi(t){return`internal error: ${t}; if you encounter this please submit an issue at: https://github.com/erikbrinkman/d3-dag/issues`}function re(t,...e){let n=St(e,i=>i.toString());return new Error(mi(ti(t,n)))}function Xt(t,e,...n){let[i,...r]=t,a=ti(r,St(n,d=>d.toString())),l=e.name||"anonymous";return new Error("d3dagBuiltin"in e?mi(`builtin ${i}'${l}'${a}`):`custom ${i}'${l}'${a}`)}function*Ft(t){let e=0;for(let n of t)yield[e++,n]}function*Ee(t,e){for(let[n,i]of Ft(t))yield*_t(e(i,n))}function*St(t,e){for(let[n,i]of Ft(t))yield e(i,n)}function*Oe(t,e){for(let[n,i]of Ft(t))e(i,n)&&(yield i)}function wi(t,e){for(let[n,i]of Ft(t))if(e(i,n))return!0;return!1}function Et(t,e=0,n=t.length,i=1){if(i>0)return function*mr(t,e,n,i){let r=Math.min(n,t.length);for(let o=e;o<r;o+=i)yield t[o]}(t,e,n,i);if(i<0)return function*wr(t,e,n,i){let r=Math.max(n,-1);for(let o=e;o>r;o+=i)yield t[o]}(t,e,n,i);throw H`can't slice with zero stride`}function*ne(...t){for(let e of t)yield*_t(e)}function*Ut(t){let e=t[Symbol.iterator](),n=e.next();if(!n.done){let r,i=n.value;for(;!(r=e.next()).done;)yield[i,r.value],i=r.value}}function xi(t){let n,e=[],i=new Map;for(let[o,a]of Ft(t.nodes()))i.set(a,o),e.push({x:a.ux,y:a.uy,data:a.data}),a===t&&(n=o);let r=[];for(let{source:o,target:a,data:l,points:d}of t.links())r.push({source:i.get(o),target:i.get(a),points:d,data:l});return{nodes:e,links:r,index:n,v:1}}var Ir=class{constructor(t,e,n,i="inactive"){this.node=t,this.indeg=e,this.outdeg=n,this.stat=i}bucket(){let t=0===this.indeg?-1/0:0===this.outdeg?1/0:this.indeg-this.outdeg;return"top"===this.stat?Math.min(t,0):"bottom"===this.stat?Math.max(t,0):t}isTop(){return this.indeg<=this.outdeg&&"bottom"!==this.stat||"top"===this.stat}};function bi(t,e){let n=t[e];if(void 0===n){let i=new Set;return t[e]=i,i}return n}function _i(t){var e;let n;for(;t.length&&(null==(e=n=t[t.length-1])||!e.size);)t.pop();return n||void 0}function ki(t,e=(()=>{})){let n=new Map,i=new Map,r=new Set,o=new Set,a=[],l=[];function d(x){return x===-1/0?r:x===1/0?o:x<=0?bi(a,-x):bi(l,x-1)}for(let x of t){let E=x.nparentLinks(),O=x.nchildLinks(),b=new Ir(x,E,O),F=e(x);n.set(x,b),void 0===F?(b.stat="active",d(b.bucket()).add(b)):Ke(i,F,b)}let h=[...i].sort(([x],[E])=>x-E).map(([,x])=>x),c=0,u=h.length,p=h.length?h[c++]:new Set,g=h.length>1?h[--u]:new Set;for(let x of p)x.stat="top",d(x.bucket()).add(x);for(let x of g)x.stat="bottom",d(x.bucket()).add(x);function _(){var x;let E;if(E=null!=(x=$e(r))?x:$e(o))return E;let O=_i(a),b=_i(l);return b?$e(a.length>l.length?O:b):O?$e(O):void 0}let w,y=Array(n.size),k=0,I=n.size;for(;w=_();){let{node:x}=w,E=w.isTop()?k++:--I;w.stat="ranked",y[E]=x;for(let[O,b]of x.parentCounts()){let F=n.get(O);d(F.bucket()).delete(F),F.outdeg-=b,"ranked"!==F.stat&&"inactive"!==F.stat&&d(F.bucket()).add(F)}for(let[O,b]of x.childCounts()){let F=n.get(O);d(F.bucket()).delete(F),F.indeg-=b,"ranked"!==F.stat&&"inactive"!==F.stat&&d(F.bucket()).add(F)}if(p.delete(w),!p.size&&c<u){p=h[c++];for(let O of p)O.stat="top",d(O.bucket()).add(O)}if(g.delete(w),!g.size&&c<u){g=h[--u];for(let O of g)O.stat="bottom",d(O.bucket()).add(O)}}return y}function Ii(t,e){let o,n=new Set,i=new Set,r=[];for(let a of t)if(!i.has(a)){for(r.push(a);o=r.pop();)n.delete(o),!i.has(o)&&(i.add(o),r.push(...e(o)));n.add(a)}return n}var he,de,ue,qt,Re,ze,ii,ri,ni,Mr=class{constructor(){yt(this,he,0),yt(this,de,0),yt(this,ue,0),yt(this,qt,!0),yt(this,Re,new Set),yt(this,ze,new Set),yt(this,ii,()=>{ut(this,he,U(this,he)-1)}),yt(this,ri,(t,e)=>{ut(this,de,U(this,de)+1),t?ut(this,ue,U(this,ue)+1):!e&&!0===U(this,qt)&&ut(this,qt,null)}),yt(this,ni,t=>{ut(this,de,U(this,de)-1),t?ut(this,ue,U(this,ue)-1):!1===U(this,qt)&&ut(this,qt,null)})}*nodes(){for(let t of this.split())yield*_t(t.nodes())}topological(t){return ki(this.nodes(),t)}*links(){for(let t of this.nodes())yield*_t(t.childLinks())}nnodes(){return U(this,he)}nlinks(){return U(this,de)}*roots(){for(let t of this.split())yield*_t(t.roots())}*leaves(){for(let t of this.split())yield*_t(t.leaves())}*split(){let t;for(yield*_t(U(this,Re));t=lr(U(this,ze));)yield t,t.nnodes()}connected(){let t=!1;for(let e of this.split()){if(t)return!1;t=!0}return!0}multi(){return!!U(this,ue)}acyclic(){if(null===U(this,qt)){for(let t of this.split())if(!t.acyclic())return ut(this,qt,!1),!1;return ut(this,qt,!0),!0}return U(this,qt)}node(t){return ut(this,he,U(this,he)+1),new Mi(this,U(this,Re),U(this,ze),U(this,ii),U(this,ri),U(this,ni),t)}link(t,e,n){return t.link(t,e,n)}toJSON(){return xi(this)}};function Ci(t){for(let e of t.values())for(let n of e)return n}function ye(t){return t instanceof Mi}he=new WeakMap,de=new WeakMap,ue=new WeakMap,qt=new WeakMap,Re=new WeakMap,ze=new WeakMap,ii=new WeakMap,ri=new WeakMap,ni=new WeakMap;var Wt,Ge,Ve,Ue,oe,fe,te,pe,jt,ge,Qt,Jt,$t,xe,Ae,ee,se,oi,Mi=class{constructor(t,e,n,i,r,o,a){this.data=a,yt(this,xe),yt(this,ee),yt(this,Wt,void 0),yt(this,Ge,void 0),yt(this,Ve,void 0),yt(this,Ue,void 0),yt(this,oe,void 0),yt(this,fe,void 0),yt(this,te,0),yt(this,pe,0),yt(this,jt,new Map),yt(this,ge,0),yt(this,Qt,new Map),yt(this,Jt,void 0),yt(this,$t,void 0),yt(this,oi,l=>{var d,h;let{source:c,target:u}=l,p=c.nchildLinksTo(u)>1;if(p){ut(c,te,U(c,te)-1);let g=Ot(d=c,ee,se).call(d);g.nlinks-=1,g.multis-=1}else{let g=Ot(h=c,xe,Ae).call(h);ut(g,$t,null),U(this,oe).delete(g),U(this,fe).add(c),ut(c,Jt,c),ut(c,$t,null),U(this,fe).add(u),ut(u,Jt,u),ut(u,$t,null)}U(this,Ue).call(this,p),vi(U(c,Qt),u,l),ut(c,ge,U(c,ge)-1),vi(U(u,jt),c,l),ut(u,pe,U(u,pe)-1)}),ut(this,Wt,t),ut(this,oe,e),ut(this,fe,n),ut(this,Ge,i),ut(this,Ve,r),ut(this,Ue,o),ut(this,Jt,this),ut(this,$t,{nnodes:1,nlinks:0,multis:0,acyclic:!0,roots:[this],leaves:[this]}),U(this,oe).add(this)}get x(){if(void 0===this.ux)throw H`can't get \`x\` when \`ux\` is undefined`;return this.ux}set x(t){this.ux=t}get y(){if(void 0===this.uy)throw H`can't get \`y\` when \`uy\` is undefined`;return this.uy}set y(t){this.uy=t}*nodes(){yield*_t(Se(t=>ne(t.children(),t.parents()),this))}topological(t){return ki(this.nodes(),t)}*links(){for(let t of this.nodes())yield*_t(t.childLinks())}nnodes(){return Ot(this,ee,se).call(this).nnodes}nlinks(){return Ot(this,ee,se).call(this).nlinks}*split(){yield this}connected(){return!0}multi(){return Ot(this,ee,se).call(this).multis>0}acyclic(){let t=Ot(this,ee,se).call(this);return null===t.acyclic?t.acyclic=function Cr(t){let i,e=new Map(St(t,r=>[r,r.nparents()])),n=[...St(Oe(e,([,r])=>0===r),([r])=>r)];for(let r of n)e.delete(r);for(;i=n.pop();)for(let r of i.children()){let o=e.get(r)-1;o?e.set(r,o):(e.delete(r),n.push(r))}return!e.size}(this.nodes()):t.acyclic}node(t){if(U(this,Wt))return U(this,Wt).node(t);throw H`can't add a node from a deleted node`}link(t,e,n){var i,r;if(U(this,Wt)){if(t===e)throw H`tried to create a link between the same node, but self loops are not supported`;if(ye(t)&&ye(e)&&U(t,Wt)===U(e,Wt)&&U(this,Wt)===U(t,Wt)){let o=new Sr(U(this,Wt),t,e,U(this,oi),n),a=t.nchildLinksTo(e)>0,l=Ot(i=t,xe,Ae).call(i),d=U(l,$t),h=Ot(r=e,xe,Ae).call(r),c=U(h,$t);if(a&&d)ut(t,te,U(t,te)+1),d.nlinks+=1,d.multis+=1;else if(a)ut(t,te,U(t,te)+1);else if(l===h&&d)d.nlinks+=1,!0===d.acyclic&&(d.acyclic=null);else if(l!==h&&d&&c){let[u,p,g,_]=d.nnodes>c.nnodes?[l,d,h,c]:[h,c,l,d];U(this,oe).delete(g),ut(g,Jt,u),ut(g,$t,void 0),p.nnodes+=_.nnodes,p.nlinks+=_.nlinks+1,p.multis+=_.multis,p.acyclic=!1!==p.acyclic&&!1!==_.acyclic&&(!0===p.acyclic&&!0===_.acyclic||null),p.roots=null,p.leaves=null}else l!==h&&(ut(l,$t,null),ut(h,$t,null));return U(this,Ve).call(this,a,l!==h),ut(t,ge,U(t,ge)+1),Ke(U(t,Qt),e,o),ut(e,pe,U(e,pe)+1),Ke(U(e,jt),t,o),o}throw H`when creating a link, both source and target must be current members of the same graph, and can't have been deleted`}throw H`can't add a link from a deleted node`}nparents(){return U(this,jt).size}nchildren(){return U(this,Qt).size}nparentLinks(){return U(this,pe)}nchildLinks(){return U(this,ge)}nparentLinksTo(t){var e,n;return ye(t)&&null!=(n=null==(e=U(this,jt).get(t))?void 0:e.size)?n:0}*parentLinksTo(t){if(ye(t)){let e=U(this,jt).get(t);e&&(yield*_t(e))}}nchildLinksTo(t){var e,n;return ye(t)&&null!=(n=null==(e=U(this,Qt).get(t))?void 0:e.size)?n:0}*childLinksTo(t){if(ye(t)){let e=U(this,Qt).get(t);e&&(yield*_t(e))}}*parents(){yield*_t(U(this,jt).keys())}*children(){yield*_t(U(this,Qt).keys())}*parentCounts(){for(let[t,e]of U(this,jt))yield[t,e.size]}*childCounts(){for(let[t,e]of U(this,Qt))yield[t,e.size]}*parentLinks(){for(let t of U(this,jt).values())yield*_t(t)}*childLinks(){for(let t of U(this,Qt).values())yield*_t(t)}*ancestors(){yield*_t(Se(t=>t.parents(),this))}*descendants(){yield*_t(Se(t=>t.children(),this))}*roots(){let t=Ot(this,ee,se).call(this);t.roots||(t.roots=[...Ii(this.nodes(),e=>e.children())]),yield*_t(t.roots)}*leaves(){let t=Ot(this,ee,se).call(this);t.leaves||(t.leaves=[...Ii(this.nodes(),e=>e.parents())]),yield*_t(t.leaves)}parent(t,e){return this.link(t,this,e)}child(t,e){return this.link(this,t,e)}delete(){if(U(this,Wt)){let t;for(;t=Ci(U(this,Qt));)t.delete();for(;t=Ci(U(this,jt));)t.delete();U(this,oe).delete(this),U(this,fe).delete(this),U(this,Ge).call(this),ut(this,Wt,null),ut(this,$t,null)}}toJSON(){return xi(this)}};Wt=new WeakMap,Ge=new WeakMap,Ve=new WeakMap,Ue=new WeakMap,oe=new WeakMap,fe=new WeakMap,te=new WeakMap,pe=new WeakMap,jt=new WeakMap,ge=new WeakMap,Qt=new WeakMap,Jt=new WeakMap,$t=new WeakMap,xe=new WeakSet,Ae=function(){let t=this;for(;U(t,Jt)!==t;)ut(t,Jt,U(U(t,Jt),Jt)),t=U(t,Jt);return t},ee=new WeakSet,se=function(){let t=Ot(this,xe,Ae).call(this);if(void 0===U(t,$t))throw re`undefined cached info`;if(null!==U(t,$t))return U(t,$t);{let e=0,n=0,i=0;for(let r of this.nodes())e+=1,n+=r.nchildLinks(),i+=U(r,te),ut(r,Jt,this),ut(r,$t,void 0),U(this,fe).delete(r);return U(this,oe).add(this),ut(this,$t,{nnodes:e,nlinks:n,multis:i,acyclic:null,roots:null,leaves:null})}},oi=new WeakMap;var Le,We,Sr=class{constructor(t,e,n,i,r){this.source=e,this.target=n,this.data=r,yt(this,Le,void 0),yt(this,We,void 0),this.points=[],ut(this,Le,t),ut(this,We,i)}delete(){U(this,Le)&&(U(this,We).call(this,this),ut(this,Le,null))}};function be(){return new Mr}function si(t){if("string"!=typeof t)throw H`id is supposed to be type string but got type ${typeof t}`;return t}function Ye(t){function e(o){var a;let l=be(),d=new Map,h=[];for(let[c,u]of o.entries()){let p=si(t.id(u,c)),g=l.node(u),_=null!=(a=t.parentData(u,c))?a:[];for(let[y,k]of _)h.push([y,g,k]);if(d.has(p))throw H`found a duplicate id: ${n}, but ids passed to \`graphStratify()\` must be unique`;d.set(p,g)}for(let[c,u,p]of h){let g=d.get(c);if(!g)throw H`missing id: ${c}; this id was references in a node's parentIds, but no node with that id exists`;l.link(g,u,p)}return l}function n(o){if(void 0===o)return t.id;{let d=at(t,["id"]);return Ye(j(it({},d),{id:o}))}}return e.id=n,e.parentData=function i(o){if(void 0===o)return t.parentData;{let h=at(t,["parentIds","parentData"]);return Ye(j(it({},h),{parentIds:Tr(o),parentData:o}))}},e.parentIds=function r(o){if(void 0===o)return t.parentIds;{let h=at(t,["parentIds","parentData"]);return Ye(j(it({},h),{parentIds:o,parentData:Oi(o)}))}},e}function Oi(t){function e(n,i){var r;return St(null!=(r=t(n,i))?r:[],o=>[o,void 0])}return e.wrapped=t,e}function Tr(t){function e(n,i){var r;return St(null!=(r=t(n,i))?r:[],([o])=>o)}return e.wrapped=t,e}function Nr(t){if("object"!=typeof t||null===t||!("id"in t))throw H`datum did not have an id field, and no id accessor was specified; try calling \`graphStratify().id(d => d...)\` to set a custom id accessor`;let{id:e}=t;if("string"==typeof e)return e;throw H`datum has an id field that was not a string, and no id accessor was specified; try calling \`graphStratify().id(d => d...)\` to set a custom id accessor`}function Ai(t){if("object"!=typeof t||null===t)throw H`default parentIds function expected datum to be an object but got: ${t}; try setting a custom accessor for parentIds with \`graphStratify().parentIds(d => ...)\``;if(!("parentIds"in t))return;let{parentIds:e}=t;if(void 0===e||function yi(t){return"object"==typeof t&&null!==t&&Symbol.iterator in t&&"function"==typeof t[Symbol.iterator]}(e)&&function vr(t,e){return!wi(t,(n,i)=>!e(n,i))}(e,n=>"string"==typeof n))return e;throw H`default parentIds function expected parentIds to be an iterable of strings but got: ${e}; try setting a custom accessor for parentIds with \`graphStratify().parentIds(d => ...)\``}function Dr(...t){if(t.length)throw H`got arguments to graphStratify(${t}), but constructor takes no arguments; these were probably meant as data which should be called as \`graphStratify()(...)\``;return Ye({id:Nr,parentIds:Ai,parentData:Oi(Ai)})}function Te(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Li(t,e){return(null==t||!(t>=t))-(null==e||!(e>=e))||(t<e?-1:t>e?1:0)}function Pi(t,e){let n;if(void 0===e)for(let i of t)null!=i&&(n<i||void 0===n&&i>=i)&&(n=i);else{let i=-1;for(let r of t)null!=(r=e(r,++i,t))&&(n<r||void 0===n&&r>=r)&&(n=r)}return n}function Ti(t,e){let n;if(void 0===e)for(let i of t)null!=i&&(n>i||void 0===n&&i>=i)&&(n=i);else{let i=-1;for(let r of t)null!=(r=e(r,++i,t))&&(n>r||void 0===n&&r>=r)&&(n=r)}return n}function Ni(t,e,n=0,i=1/0,r){if(e=Math.floor(e),n=Math.floor(Math.max(0,n)),i=Math.floor(Math.min(t.length-1,i)),!(n<=e&&e<=i))return t;for(r=void 0===r?Li:function Fr(t=Te){if(t===Te)return Li;if("function"!=typeof t)throw new TypeError("compare is not a function");return(e,n)=>{let i=t(e,n);return i||0===i?i:(0===t(n,n))-(0===t(e,e))}}(r);i>n;){if(i-n>600){let d=i-n+1,h=e-n+1,c=Math.log(d),u=.5*Math.exp(2*c/3),p=.5*Math.sqrt(c*u*(d-u)/d)*(h-d/2<0?-1:1);Ni(t,e,Math.max(n,Math.floor(e-h*u/d+p)),Math.min(i,Math.floor(e+(d-h)*u/d+p)),r)}let o=t[e],a=n,l=i;for(Ne(t,n,e),r(t[i],o)>0&&Ne(t,n,i);a<l;){for(Ne(t,a,l),++a,--l;r(t[a],o)<0;)++a;for(;r(t[l],o)>0;)--l}0===r(t[n],o)?Ne(t,n,l):(++l,Ne(t,l,i)),l<=e&&(n=l+1),e<=l&&(i=l-1)}return t}function Ne(t,e,n){let i=t[e];t[e]=t[n],t[n]=i}function li(t,e){return function $r(t,e,n){if(t=Float64Array.from(function*Br(t,e){if(void 0===e)for(let n of t)null!=n&&(n=+n)>=n&&(yield n);else{let n=-1;for(let i of t)null!=(i=e(i,++n,t))&&(i=+i)>=i&&(yield i)}}(t,n)),(i=t.length)&&!isNaN(e=+e)){if(e<=0||i<2)return Ti(t);if(e>=1)return Pi(t);var i,r=(i-1)*e,o=Math.floor(r),a=Pi(Ni(t,o).subarray(0,o+1));return a+(Ti(t.subarray(o+1))-a)*(r-o)}}(t,.5,e)}Le=new WeakMap,We=new WeakMap;var Hr=bt(kt());function ke(t,e,n,i,r={}){let o=Hr.Solve.call({},{optimize:t,opType:e,constraints:i,variables:n,ints:r}),{feasible:a}=o,l=at(o,["feasible"]);if(!a)throw re`could not find a feasible simplex solution`;return l}var jr=bt(sr());function qr(t){let e=[...t];if(e.sort((n,i)=>n-i),0!==e.length){if(2===e.length)return(e[0]+e[1])/2;if(e.length%2==0){let n=e.length/2,r=e[n-1],o=e[n],l=r-e[0],d=e[e.length-1]-o;return(r*d+o*l)/(l+d)}return e[(e.length-1)/2]}}function Bi({aggregate:t}){function e(i,r,o){let[a,l]=o?[r,i]:[i,r],d=o?u=>u.parents():u=>u.children(),h=new Map(l.map((u,p)=>[u,p])),c=new Map(a.map(u=>[u,h.get(u)??t(St(d(u),_=>h.get(_)))]));!function Kr(t,e){let n=new Map;for(let c of t){let u=e.get(c);void 0!==u&&qe(n,u,c)}let i=[...n.entries()].sort(([c],[u])=>c-u).flatMap(([,c])=>c),r=new Map(t.map((c,u)=>[c,u])),o=t.filter(c=>void 0===e.get(c)),a=new Array(o.length).fill(null);(function l(c,u,p,g){if(u<=c)return;let _=Math.floor((c+u)/2),k=r.get(o[_]),I=0,w=[I];for(let E=p;E<g;++E)I+=r.get(i[E])<k?-1:1,w.push(I);let x=p+w.indexOf(Math.min(...w));a[_]=x,l(c,_,p,x),l(_+1,u,x,g)})(0,o.length,0,i.length),a.push(i.length+1);let d=0,h=0;for(let[c,u]of i.entries()){for(;a[h]==c;)t[d++]=o[h++];t[d++]=u}for(;a[h]==i.length;)t[d++]=o[h++]}(a,c)}return e.aggregator=function n(i){return void 0===i?t:Bi({aggregate:i})},e.d3dagBuiltin=!0,e}function tn(...t){if(t.length)throw H`got arguments to twolayerAgg(${t}); you probably forgot to construct twolayerAgg before passing to order: \`decrossTwoLayer().order(twolayerAgg())\`, note the trailing "()"`;return Bi({aggregate:qr})}function nn(t,e,n,i){t[n][n]+=i,t[n][e]-=i,t[e][n]-=i,t[e][e]+=i}function Ri(t,e,n,i,r,o){let a=r+o;t[i][i]+=o*o,t[i][n]-=o*a,t[i][e]+=o*r,t[n][i]-=a*o,t[n][n]+=a*a,t[n][e]-=a*r,t[e][i]+=r*o,t[e][n]-=r*a,t[e][e]+=r*r}function Je(t){return function Qr(t){let e=0,n=0;for(let i of t)n++,e+=(i-e)/n;return n?e:void 0}(Ee(t,e=>St(e.children(),n=>n.y-e.y)))}function Gi([t,e,n]){if(t<=0||e<=0||n<=0)throw H`simplex weights must be positive, but got: ${t}, ${e}, ${n}`}function Vi(t){function e(i,r){var o;let a={},l={},d=function on(t,e){if("function"!=typeof e){let[n,i,r]=e;return(o,a)=>{switch(+("node"===o.data.role)+ +("node"===a.data.role)){case 0:return r;case 1:return i;case 2:return n;default:throw re`invalid count`}}}{let n=new Map;for(let i of Ee(t,r=>r))if("node"===i.data.role){let r=i.data.node,o=new Map;for(let a of r.childLinks()){let{target:l}=a,d=e(a);Gi(d),o.set(l,d)}n.set(r,o)}return(i,r)=>{if("link"===i.data.role){let{source:o,target:a}=i.data.link,[,l,d]=n.get(o).get(a);return"link"===r.data.role?d:l}if("link"===r.data.role){let{source:o,target:a}=r.data.link,[,l]=n.get(o).get(a);return l}{let[o]=n.get(i.data.node).get(r.data.node);return o}}}}(i,t.weight),h=new Map,c=0;for(let I of i)for(let w of I)if(!h.has(w)){let x=""+c++;h.set(w,x),a[x]={}}function u(I){return h.get(I)}for(let I of i)for(let[w,x]of Ut(I)){let E=u(w),O=u(x),b=`layer ${E} -> ${O}`,F=r(w,x);l[b]={min:F},a[E][b]=-1,a[O][b]=1}let p=Je(h.keys());for(let I of h.keys()){let w=u(I);for(let x of I.children()){let E=u(x),O=`link ${w} -> ${E}`,b=`${O} parent`;l[b]={min:0};let F=`${O} child`;l[F]={min:0},a[w][b]=1,a[w][F]=-1,a[E][b]=-1,a[E][F]=1;let T=d(I,x);a[O]={opt:T/((x.y-I.y)/p),[b]:1,[F]:1}}}let g=ke("opt","min",a,l);for(let[I,w]of h)I.x=null!=(o=g[w])?o:0;let _=0,y=0;for(let I of i){let w=I[0];_=Math.min(_,w.x-r(void 0,w));let x=I[I.length-1];y=Math.max(y,x.x+r(x,void 0))}for(let I of h.keys())I.x-=_;let k=y-_;if(k<=0)throw H`must assign nonzero width to at least one node; double check the callback passed to \`sugiyama().nodeSize(...)\``;return k}return e.weight=function n(i){if(void 0===i)return t.weight;{"function"!=typeof i&&Gi(i);let a=at(t,["weight"]);return Vi(j(it({},a),{weight:i}))}},e.d3dagBuiltin=!0,e}function sn(...t){if(t.length)throw H`got arguments to coordSimplex(${t}); you probably forgot to construct coordSimplex before passing to coord: \`sugiyama().coord(coordSimplex())\`, note the trailing "()"`;return Vi({weight:[1,2,8]})}function Ui(t,e){let n=new Map,i=new Map(t.map((o,a)=>[o,a]));return function r(o,a){var l;let d=null==(l=n.get(o))?void 0:l.get(a);if(void 0!==d)return d;if(i.has(o)||i.has(a))return-1/0;{let h=0;for(let[p,g]of e(o)){let _=i.get(p);for(let[y,k]of e(a)){let I=i.get(y);h+=Math.sign(_-I)*g*k}}let c=n.get(o);void 0===c?n.set(o,new Map([[a,h]])):c.set(a,h);let u=n.get(a);return void 0===u?n.set(a,new Map([[o,-h]])):u.set(o,-h),h}}}function ci({baseOp:t,doScan:e}){function n(o,a,l){t(o,a,l);let d=l?a:o,h=l?Ui(o,c=>c.parentCounts()):Ui(a,c=>c.childCounts());e?function ln(t,e){let n=Array(t.length*(t.length-1)/2);for(;;){let i=0;for(let h=1;h<t.length;++h){let c=0,u=i;for(let p=h-1;p>=0;--p)n[u]=c,c+=e(t[p],t[h]),u-=t.length-p-1;i+=t.length-h}let r=0,o=0,a=0,l=0;for(let h=0;h<t.length-1;++h){let c=0;for(let u=h+1;u<t.length;++u){c+=e(t[h],t[u]);let p=n[r++]+c;p>o&&(o=p,a=h,l=u)}}if(0===o)break;let d=t[l];t[l]=t[a],t[a]=d}}(d,h):function an(t,e){let i,n=[[0,t.length]];for(;i=n.pop();){let[r,o]=i;if(r>=o)continue;let a=0,l=o;for(let d=r;d<o-1;++d){let h=e(t[d],t[d+1]);h>a&&(a=h,l=d)}if(l!==o){let d=t[l+1];t[l+1]=t[l],t[l]=d,n.push([r,l],[l+2,o])}}}(d,h)}return n.base=function i(o){return void 0===o?t:ci({baseOp:o,doScan:e})},n.scan=function r(o){return void 0===o?e:ci({baseOp:t,doScan:o})},n.d3dagBuiltin=!0,n}function cn(...t){if(t.length)throw H`got arguments to twolayerGreedy(${t}); you probably forgot to construct twolayerGreedy before passing to order: \`decrossTwoLayer().order(twolayerGreedy())\`, note the trailing "()"`;return ci({baseOp:()=>{},doScan:!1})}function hi(t){let e=0;for(let[n,i]of Ut(t)){let r=new Map(i.map((o,a)=>[o,a]));for(let[o,a]of n.entries())for(let l of n.slice(o+1))for(let[d,h]of a.childCounts())for(let[c,u]of l.childCounts())d!==c&&r.get(d)>r.get(c)&&(e+=h*u)}return e}function Wi(t){function e(i){let r;r=t.topDown?Se(o=>[...o.children()].sort((a,l)=>l.nchildren()-a.nchildren()),...Ee(i,o=>[...Oe(o,a=>!a.nparents())].sort((a,l)=>l.nchildren()-a.nchildren()))):Se(o=>[...o.parents()].sort((a,l)=>l.nparents()-a.nparents()),...Ee(Et(i,i.length-1,-1,-1),o=>[...Oe(o,a=>!a.nchildren())].sort((a,l)=>l.nparents()-a.nparents())));for(let o of i)o.splice(0);for(let o of r){let{data:a}=o;if("node"===a.role)for(let l=a.topLayer;l<=a.bottomLayer;++l)i[l].push(o);else i[a.layer].push(o)}}return e.topDown=function n(i){return void 0===i?t.topDown:Wi({topDown:i})},e.d3dagBuiltin=!0,e}function Yi(...t){if(t.length)throw H`got arguments to decrossDfs(${t}); you probably forgot to construct decrossDfs before passing to decross: \`sugiyama().decross(decrossDfs())\`, note the trailing "()"`;return Wi({topDown:!0})}function Xe(t){function e(o){let a=o.slice().reverse(),l=o.map(c=>c.slice()),d=hi(l),h=t.inits.length?t.inits:[()=>{}];for(let c of h){c(o);let u=!0;for(let p=0;p<t.passes&&u;++p){u=!1;for(let[y,k]of Ut(o)){let I=k.slice();t.order(y,k,!0),k.some((w,x)=>I[x]!==w)&&(u=!0)}let g=hi(o);g<d&&(d=g,l=o.map(y=>y.slice()));for(let[y,k]of Ut(a)){let I=k.slice();t.order(k,y,!1),k.some((w,x)=>I[x]!==w)&&(u=!0)}let _=hi(o);_<d&&(d=_,l=o.map(y=>y.slice()))}}o.splice(0,o.length,...l)}return e.order=function n(o){if(void 0===o)return t.order;{let d=at(t,["order"]);return Xe(j(it({},d),{order:o}))}},e.inits=function i(o){if(void 0===o)return[...t.inits];{let d=at(t,["inits"]);return Xe(j(it({},d),{inits:o}))}},e.passes=function r(o){if(void 0===o)return t.passes;if(o<=0)throw H`number of passes must be positive`;return Xe(j(it({},t),{passes:o}))},e.d3dagBuiltin=!0,e}function dn(...t){if(t.length)throw H`got arguments to decrossTwoLayer(${t}); you probably forgot to construct decrossTwoLayer before passing to decross: \`sugiyama().decross(decrossTwoLayer())\`, note the trailing "()"`;return Xe({order:cn().base(tn()),inits:[Yi().topDown(!0),Yi().topDown(!1)],passes:24})}function un(t,e){return+!(!t||!e)}function di(t){function e(r,o){var a;let l={},d={},h=new Map(St(r.nodes(),(w,x)=>[w,x.toString()]));function c(w){return h.get(w)}function u(w){return l[c(w)]}function p(w,x,E,O,b=0){let F=u(x),T=u(E),$=`${w}: ${c(x)} -> ${c(E)}`;d[$]={min:O},F[$]=-1,T[$]=1,F.opt+=b,T.opt-=b}function g(w,x,E){p(`${w} before`,x,E,0),p(`${w} after`,E,x,0)}let _=[],y=new Map;for(let w of r.nodes()){let x=c(w);l[x]={opt:0};let E=t.rank(w);void 0!==E&&_.push([E,w]);let O=t.group(w);if(void 0!==O){let b=y.get(O);b?b.push(w):y.set(O,[w])}}let k=new Set;for(let w of r.topological(t.rank)){for(let[x,E]of w.childCounts())k.has(x)?p("link",x,w,o(x,w),E):p("link",w,x,o(w,x),E);k.add(w)}let I=_.sort(([w],[x])=>w-x);for(let[[w,x],[E,O]]of Ut(I))w<E?p("rank",x,O,o(x,O)):g("rank",x,O);for(let w of y.values())for(let[x,E]of Ut(w))g("group",x,E);try{let w=ke("opt","max",l,d,{}),x=0,E=0;for(let O of r.nodes()){let b=null!=(a=w[c(O)])?a:0;O.y=b,x=Math.min(x,b-o(void 0,O)),E=Math.max(E,b+o(O,void 0))}for(let O of r.nodes())O.y-=x;return E-x}catch{throw y.size?H`could not find a feasible simplex layout; this is likely due to group constraints producing an infeasible layout, try relaxing the functions you're passing to \`layeringSimplex().group(...)\``:re`could not find a feasible simplex solution`}}return e.rank=function n(r){if(void 0===r)return t.rank;{let l=at(t,["rank"]);return di(j(it({},l),{rank:r}))}},e.group=function i(r){if(void 0===r)return t.group;{let l=at(t,["group"]);return di(j(it({},l),{group:r}))}},e.d3dagBuiltin=!0,e}function Hi(){}function fn(...t){if(t.length)throw H`got arguments to layeringSimplex(${t}); you probably forgot to construct layeringSimplex before passing to layering: \`sugiyama().layering(layeringSimplex())\`, note the trailing "()"`;return di({rank:Hi,group:Hi})}function ve(t,e){function n(h){let c;if(h.nnodes()){let[u,p]=function Xr(t){if("function"!=typeof t){let[e,n]=t;return[()=>e,()=>n]}{let e=t;return[n=>e(n)[0],n=>e(n)[1]]}}(function Jr(t){if("function"!=typeof t){let[e,n]=t;if(e<=0||n<=0)throw H`all node sizes must be positive, but got width ${e} and height ${n}`;return()=>[e,n]}{let e=new Map;return n=>{let i=e.get(n);if(void 0===i){i=t(n);let[r,o]=i;if(r<=0||o<=0)throw H`all node sizes must be positive, but got width ${r} and height ${o} for node with data: ${n.data}; make sure the callback passed to \`sugiyama().nodeSize(...)\` is doing that`;e.set(n,i)}return i}}}(t.nodeSize)),[g,_]=e.gap,y=t.layering(h,un)+1,[k,I]=function pn(t,e,n,i,r){let o=be(),a=Array(i).fill(!1),l=new Map;for(let p of t.nodes()){let g=p.uy;if(void 0===g)throw Xt`layering ${r} didn't assign a layer to a node`;if(g<0||g>=i)throw Xt`layering ${r} assigned node an invalid layer: ${g}`;{let _=ne(p.parentCounts(),p.childCounts());!a[g]&&wi(_,([{uy:k},I])=>I>1&&k===g-1)&&(a[g]=!0);let y={node:p,topLayer:g,bottomLayer:g,role:"node"};l.set(p,[y,o.node(y)])}}let d=0,h=a.map(p=>d+=+p);for(let[p]of l.values()){let g=h[p.topLayer];p.topLayer+=g,p.bottomLayer+=g}let c=function Zi(t,e,n,i){for(let[o,[a,l]]of e){let d=a.bottomLayer;for(let h of o.childLinks()){let[c,u]=e.get(h.target),p=c.topLayer;if(p>d){let g=l;for(let _=d+1;_<p;++_){let y=t.node({link:h,layer:_,role:"link"});g.child(y,void 0),g=y}g.child(u)}else{if(!(p<d))throw Xt`layering ${i} assigned nodes with an edge to the same layer`;{let g=u;for(let _=p+1;_<d;++_){let y=t.node({link:h,layer:_,role:"link"});g.child(y,void 0),g=y}g.child(l)}}}}let r=Array(n).fill(null).map(()=>[]);for(let o of t.nodes()){let{data:a}=o;if("node"===a.role){let{topLayer:l,bottomLayer:d}=a;for(let h=l;h<=d;++h)r[h].push(o)}else{let{layer:l}=a;r[l].push(o)}}for(let o of r)if(!o.length)throw Xt`layering ${i} didn't assign a node to every layer`;return r}(o,l,i+d,r),u=-n;for(let p of c){u+=n;let g=Math.max(-n,...St(p,({data:y})=>"node"===y.role?e(y.node):-1/0)),_=u+g/2;for(let y of p)y.y=_;u+=g}return[c,u]}(h,p,_,y,t.layering);t.decross(k);let w=function hn(t,e){return function n(i,r){let l=((i?t(i):0)+(r?t(r):0))/2;return i&&r?l+e:l}}(function vn(t,e=0){return({data:n})=>"node"===n.role?t(n.node):e}(u),g),x=t.coord(k,w);(function mn(t,e,n,i,r=.001){for(let o of t){for(let a of o)if(void 0===a.ux)throw Xt`coord ${i} didn't assign an x to every node`;for(let[[a,l],[d,h]]of Ut(ne([[void 0,0]],St(o,c=>[c,c.x]),[[void 0,n]])))if(h-l<e(a,d)-r)throw Xt`coord ${i} assigned nodes too close for separation`}})(k,w,x,t.coord),function gn(t){for(let e of t)for(let n of e)if("node"===n.data.role){let{node:i}=n.data;i.x=n.x,i.y=n.y;for(let r of n.children()){let a,o=[[n.x,n.y]];for(;"link"===r.data.role;)a=r.data.link,o.push([r.x,r.y]),[r]=r.children();o.push([r.x,r.y]);let l=r.data.node,d=ne(i.childLinksTo(l),i.parentLinksTo(l));a||([a]=d),a.source!==i&&o.reverse(),a.points.splice(0,a.points.length,...o)}}}(k),c={width:x,height:I}}else c={width:0,height:0};for(let u of t.tweaks)c=u(h,c);return c}return n.layering=function i(h){if(void 0===h)return t.layering;{let p=at(t,["layering"]);return ve(j(it({},p),{layering:h}),e)}},n.decross=function r(h){if(void 0===h)return t.decross;{let p=at(t,["decross"]);return ve(j(it({},p),{decross:h}),e)}},n.coord=function o(h){if(void 0===h)return t.coord;{let p=at(t,["coord"]);return ve(j(it({},p),{coord:h}),e)}},n.tweaks=function a(h){if(void 0===h)return t.tweaks;{let p=at(t,["tweaks"]);return ve(j(it({},p),{tweaks:h}),e)}},n.nodeSize=function l(h){if(void 0===h)return t.nodeSize;if("function"!=typeof h&&(h[0]<=0||h[1]<=0)){let[c,u]=h;throw H`constant nodeSize must be positive, but got: [${c}, ${u}]`}{let p=at(t,["nodeSize"]);return ve(j(it({},p),{nodeSize:h}),e)}},n.gap=function d(h){if(void 0!==h){let[c,u]=h;if(c<0||u<0)throw H`gap width (${c}) and height (${u}) must be non-negative`;return ve(t,j(it({},e),{gap:h}))}{let[c,u]=e.gap;return[c,u]}},n}function Ji(t,e){for(let n of t){let i=li([...St(e(n),({x:r})=>r)]);void 0!==i&&(n.x=i)}}function Xi(t,e){for(let n of t){let[i]=e(n);"link"===n.data.role&&"link"===i.data.role&&(n.x=i.x)}}function De(t,e){let n=t[t.length-1],i=n.x,r=[i];for(let o of Et(t,t.length-2,-1,-1)){let a=Math.min(o.x,i-e(n,o));r.push(a),n=o,i=a}r.reverse(),n=t[0],i=n.x,n.x=(i+r[0])/2;for(let[o,a]of Ft(Et(t,1))){let l=Math.max(a.x,i+e(n,a));a.x=(l+r[o+1])/2,n=a,i=l}}function yn(t,e){for(let[n,i]of t.entries()){let r=e[n];for(let[o,{x:a}]of i.entries())if(r[o]!==a)return!1}return!0}function ui(t,e,n){if("function"!=typeof t)return()=>t;{let i=new Map;return r=>{let o=i.get(r);if(void 0===o){let a=t(r);if(a<0)throw new Error(`${e} weights must be non-negative; double check the accessor passed into \`coordQuad().${n}(...)\``);return i.set(r,a),a}return o}}}function Ie(t){function e(l,d){let x,h=function rn(t){let e=new Map,n=0;for(let i of t)for(let r of i)e.has(r)||e.set(r,n++);return e}(l),[c,u,p,g]=function $i(t,e,n,i=0){let r=1+Math.max(...e.values()),o=Array(r).fill(null).map((h,c)=>Array(r).fill(null).map((u,p)=>c===p?i:0)),a=Array(r).fill(0),l=[],d=[];for(let h of t)for(let[c,u]of Ut(h)){let p=e.get(c),g=e.get(u),_=Array(r).fill(0);_[p]=1,_[g]=-1,l.push(_),d.push(-n(c,u))}return[o,a,l,d]}(l,h,d,t.comp),_=function bn(t,e){if("function"!=typeof t)return()=>t;{let n=new Map;for(let i of Ee(e,r=>r))if("node"===i.data.role){let r=i.data.node,o=new Map;for(let a of r.childLinks()){let l=t(a);if(l<0)throw H`link weights must be non-negative; double check the accessor passed into \`coordQuad().vertWeak(...)\``;o.set(a.target,l)}n.set(r,o)}return(i,r)=>n.get(i).get(r)}}(t.vertWeak,l),y=ui(t.vertStrong,"link","vertStrong"),k=ui(t.linkCurve,"link","linkCurve"),I=ui(t.nodeCurve,"node","nodeCurve"),w=Je(h.keys());for(let[E,O]of h){let b=E.data,F="node"===b.role?b.node:b.link.source;for(let T of E.children()){let $=h.get(T),V=T.data,Y="node"===V.role?V.node:V.link.target,Q="node"===b.role?_(F,Y):y(b.link),tt="node"===V.role?_(F,Y):y(V.link),dt="node"===V.role?I(V.node):k(V.link),xt=(T.y-E.y)/w;nn(c,O,$,(Q+tt)/xt);for(let pt of T.children())Ri(c,O,$,h.get(pt),dt/xt,dt/((pt.y-T.y)/w))}}try{x=function zi(t,e,n,i){for(let[a,l]of n)a.x=i[l];let r=1/0,o=-1/0;for(let a of t){let l=a[0],d=a[a.length-1];r=Math.min(r,l.x-e(void 0,l)),o=Math.max(o,d.x+e(d,void 0))}for(let a of n.keys())a.x-=r;return o-r}(l,d,h,function Fi(t,e,n,i,r=0){e.pop(),t.pop(),t.forEach(a=>a.pop()),n.forEach(a=>a.pop());let o=function en(t,e,n,i,r){if(!e.length)return[];let o=[[0]],a=[0],l=[[0]],d=[0];for(let u of t){let p=[0];p.push(...u),o.push(p)}a.push(...e),l.push(...e.map(()=>[0]));for(let u of n)for(let[p,g]of u.entries())l[p+1].push(-g);d.push(...i.map(u=>-u));let{solution:h,message:c}=(0,jr.solveQP)(o,a,l,d,r);if(c.length)throw re`quadratic program failed: ${c}`;return h.shift(),h}(t,e,n,i,r);return o.push(0),o}(c,u,p,g))}catch(E){throw"string"==typeof E?re`${E}`:re`undefined quadprog exception`}if(x<=0)throw H`must assign nonzero width to at least one node; double check the callback passed to \`sugiyama().nodeSize(...)\``;return x}return e.vertWeak=function n(l){if(void 0===l)return t.vertWeak;if("number"==typeof l&&l<0)throw H`vertWeak must be non-negative but was: ${l}`;{let c=at(t,["vertWeak"]);return Ie(j(it({},c),{vertWeak:l}))}},e.vertStrong=function i(l){if(void 0===l)return t.vertStrong;if("number"==typeof l&&l<0)throw H`vertStrong must be non-negative but was: ${l}`;{let c=at(t,["vertStrong"]);return Ie(j(it({},c),{vertStrong:l}))}},e.linkCurve=function r(l){if(void 0===l)return t.linkCurve;if("number"==typeof l&&l<0)throw H`linkCurve must be non-negative but was: ${l}`;{let c=at(t,["linkCurve"]);return Ie(j(it({},c),{linkCurve:l}))}},e.nodeCurve=function o(l){if(void 0===l)return t.nodeCurve;if("number"==typeof l&&l<0)throw H`nodeCurve must be non-negative but was: ${l}`;{let c=at(t,["nodeCurve"]);return Ie(j(it({},c),{nodeCurve:l}))}},e.compress=function a(l){if(void 0===l)return t.comp;if(l<=0)throw H`compress weight must be positive, but was: ${l}`;return Ie(j(it({},t),{comp:l}))},e.d3dagBuiltin=!0,e}function fi(t){function e(r){var o;let a=r.reduce((O,b)=>O+b.length*Math.max(b.length-1,0)/2,0),l=[];if(t.dist)for(let[O,b]of Ut(r)){let F=b.filter(Y=>!Y.nparents()),T=O.map(Y=>[...Y.children()]);l.push([F,T]);let $=O.filter(Y=>!Y.nchildren()),V=b.map(Y=>[...Y.parents()]);l.push([$,V])}let d=function kn(t){var e,n;let i=[],r=new Map,o=new Map;for(let h of t){let[c]=h;c!==i[i.length-1]&&i.push(c);for(let u of Et(h,1)){let p=null!=(e=o.get(u))?e:0;o.set(u,p+1)}for(let[u,p]of Ut(h))qe(r,u,p)}let d,a=new Map,l=0;for(;d=i.pop();){a.set(d,l++);for(let h of null!=(n=r.get(d))?n:[]){let c=o.get(h)-1;o.set(h,c),c||i.push(h)}}return a}(r),h=new Map;function c(O,b){var F;let T=`${O} => ${b}`;return null!=(F=h.get(T))?F:T}let u=new Map;for(let[O,b]of Ft(Et(r,0,r.length-1)))for(let F of b){if("node"!==F.data.role||F.data.bottomLayer===O)continue;let T=d.get(F),$=!0;for(let V of b)if(V===F)$=!1;else if("node"!==V.data.role||V.data.bottomLayer===O){let Y=d.get(V),Q=$?c(Y,T):c(T,Y);for(let tt of V.children()){let dt=d.get(tt),xt=$?c(dt,T):c(T,dt);u.set(xt,Q)}}}let p=new Map;for(let[O,b]of u){let T,F=b;for(;T=u.get(F);)F=T;let $=p.get(F);$?$.push(O):p.set(F,[F,O])}for(let O of p.values()){let b=`{ ${O.join(" & ")} }`;for(let F of O)h.set(F,b)}let g=1/(l.reduce((O,[b,F])=>F.reduce((T,$)=>T+$.length*$.length,0)*b.length,0)/4+1),_=g/(a+1),y={},k={},I={};for(let O of r){for(let[b,F]of O.entries()){let T=d.get(F);for(let $ of Et(O,b+1)){let Y=c(T,d.get($));I[Y]=1,k[Y]={max:1},y[Y]={opt:_,[Y]:1}}}for(let[b,F]of O.entries()){let T=d.get(F);for(let[$,V]of Ft(Et(O,b+1))){let Y=d.get(V);for(let Q of O.slice(b+$+2)){let tt=d.get(Q),dt=c(T,Y),xt=c(T,tt),pt=c(Y,tt),vt=`tri: ${T} - ${Y} - ${tt}`,It=`${vt} +`,Nt=`${vt} -`;k[It]={max:1},y[dt][It]=1,y[xt][It]=-1,y[pt][It]=1,k[Nt]={min:0},y[dt][Nt]=1,y[xt][Nt]=-1,y[pt][Nt]=1}}}}for(let[O,b]of Ft(Et(r,0,r.length-1)))for(let[F,T]of b.entries()){if("node"===T.data.role&&T.data.bottomLayer!==O)continue;let $=d.get(T);for(let V of Et(b,F+1)){if("node"===V.data.role&&V.data.bottomLayer!==O)continue;let Q=c($,d.get(V)),tt=new Map;for(let[dt,xt]of T.childCounts()){let pt=d.get(dt);for(let[vt,It]of V.childCounts()){if(dt===vt)continue;let Nt=d.get(vt),Gt=Math.sign(pt-Nt),At=Gt<0?c(pt,Nt):c(Nt,pt),zt=null!=(o=tt.get(At))?o:0;tt.set(At,Gt*xt*It+zt)}}for(let[dt,xt]of tt){let pt=`slack: ${Q} : ${dt}`,vt=`${pt} +`,It=`${pt} -`;xt<0?(y[pt]={opt:-xt,[vt]:1,[It]:1},k[vt]={min:0},y[Q][vt]=1,y[dt][vt]=-1,k[It]={min:0},y[Q][It]=-1,y[dt][It]=1):xt>0&&(y[pt]={opt:xt,[vt]:1,[It]:1},k[vt]={min:1},y[Q][vt]=1,y[dt][vt]=1,k[It]={min:-1},y[Q][It]=-1,y[dt][It]=-1)}}}for(let[O,b]of l)for(let F of O){let T=d.get(F);for(let $ of b)for(let[V,Y]of Ft($)){let Q=d.get(Y);for(let tt of Et($,V+1)){let dt=d.get(tt),xt=`dist: ${Q} - ${T} - ${dt}`,pt=`${xt} :normal`,vt=`${xt} :reversed`;y[xt]={opt:g,[pt]:1,[vt]:1};let It=0;for(let[Nt,Gt]of[[Q,T],[Q,dt],[T,dt]]){let At=Math.sign(Nt-Gt),zt=At<0?c(Nt,Gt):c(Gt,Nt);It+=At,y[zt][pt]=-At,y[zt][vt]=At}k[pt]={min:(It+1)/-2},k[vt]={min:(It-1)/2}}}}let w=Object.keys(y).length,x=Object.keys(k).length;if("oom"!==t.check&&w>2e3)throw H`size of dag to decrossOpt is too large and will likely crash instead of complete; you probably want to use a cheaper decrossing strategy for sugiyama like \`sugiyama().decross(decrossTwoLayer())\`, but if you still want to continue you can suppress this check with \`sugiyama().decross(decrossOp().check("oom"))\``;if("fast"===t.check&&(w>1e3||x>5e3))throw H`size of dag to decrossOpt is too large and will likely not complete; you probably want to use a cheaper decrossing strategy for sugiyama like \`sugiyama().decross(decrossTwoLayer())\`, but if you still want to continue you can suppress this check with \`sugiyama().decross(decrossOp().check("slow"))\``;let E=ke("opt","min",y,k,I);if(!E.bounded)throw re`optimization result was not bounded`;for(let O of r)O.sort((b,F)=>{let T=d.get(b),$=d.get(F);return T<$?E[c(T,$)]||-1:-(E[c($,T)]||-1)})}return e.check=function n(r){return void 0===r?t.check:fi(j(it({},t),{check:r}))},e.dist=function i(r){return void 0===r?t.dist:fi(j(it({},t),{dist:r}))},e.d3dagBuiltin=!0,e}function pi(t,e){function n(o,a){let l=0,d=o.topological(t.rank);for(let h of d)h.uy=void 0;e.topDown&&d.reverse();for(let h of d){let c=Math.max(a(void 0,h),...St(ne(h.parents(),h.children()),u=>{var p;return(null!=(p=u.uy)?p:-1/0)+a(u,h)}));l=Math.max(l,c+a(h,void 0)),h.y=c}for(let h of d.reverse()){let c=Math.min(...St(Oe(ne(h.parents(),h.children()),u=>h.y<u.y),u=>u.y-a(u,h)));c!==1/0&&(h.y=c)}if(e.topDown)for(let h of d)h.y=l-h.y;return l}return n.rank=function i(o){if(void 0===o)return t.rank;{let d=at(t,["rank"]);return pi(j(it({},d),{rank:o}),e)}},n.topDown=function r(o){return void 0===o?e.topDown:pi(t,j(it({},e),{topDown:o}))},n.d3dagBuiltin=!0,n}function Cn(){}function Qi(...t){if(t.length)throw H`got arguments to layeringLongestPath(${t}); you probably forgot to construct layeringLongestPath before passing to layering: \`sugiyama().layering(layeringLongestPath())\`, note the trailing "()"`;return pi({rank:Cn},{topDown:!0})}function qi(t){function e(i,r){let a,o=0;for(let l of i.topological(t.rank))o+=r(a,l),l.y=o,a=l;return o+=r(a,void 0),o}return e.rank=function n(i){if(void 0===i)return t.rank;{let a=at(t,["rank"]);return qi(j(it({},a),{rank:i}))}},e.d3dagBuiltin=!0,e}function Mn(){}function Sn(...t){if(t.length)throw H`got arguments to layeringTopological(${t}); you probably forgot to construct layeringTopological before passing to layering: \`sugiyama().layering(layeringTopological())\`, note the trailing "()"`;return qi({rank:Mn})}function Ln(t,e,n,i){let[r,o]=t,[a,l]=e,[d,h]=n,[c,u]=i,p=r-a/2,g=r+a/2,_=o-l/2,y=o+l/2;function k(x,E){let O=0;return x<p?O|=1:x>g&&(O|=2),E<_?O|=4:E>y&&(O|=8),O}let I=k(d,h),w=k(c,u);if(!w)throw H`line from [${d}, ${h}] -> [${c}, ${u}] ended inside rectangle centered at [${r}, ${o}] with size [${a}, ${l}]`;for(;;){if(!w)return[c,u];if(I&w)return[d,h];8&w?(c=d+(c-d)*(y-h)/(u-h),u=y):4&w?(c=d+(c-d)*(_-h)/(u-h),u=_):2&w?(u=h+(u-h)*(g-d)/(c-d),c=g):(u=h+(u-h)*(p-d)/(c-d),c=p),w=k(c,u)}}function Pn(t,e,n,i){let[r,o]=t,[a,l]=e,[d,h]=n,[c,u]=i,p=a/2,g=l/2,_=c-d,y=d-r,k=u-h,I=h-o,w=p*p,x=g*g,E=w*k*k+x*_*_,O=_*I-k*y,b=E-O*O;if(b>=0){let F=p*g*Math.sqrt(b),T=_*y*x+k*I*w,V=(T-F)/-E;if((T+F)/-E<1&&1<V)throw H`line from [${d}, ${h}] -> [${c}, ${u}] ended inside ellipse at [${r}, ${o}] with size [${a}, ${l}]`;return 0<=V&&V<=1?[V*_+d,V*k+h]:[d,h]}return[d,h]}function Tn(t,e=Ln){return function n(i,r){for(let o of i.nodes()){let a=[o.x,o.y],l="function"==typeof t?t(o):t;for(let{points:d}of o.parentLinks()){let[h,c]=d.slice(-2),u=e(a,l,c,h);d.splice(-1,1,u)}for(let{points:d}of o.childLinks()){let[h,c]=d,u=e(a,l,h,c);d.splice(0,1,u)}}return r}}var er=X(9212),Fn=X(7382);let $n=(()=>{class t{constructor(n){this.logger=n,this.offset=500,this.scaleFactor=7,this.multiChartOffset=0,this.multiChartscaleFactor=3,this.defaultLayoutProps={xGap:15,yGap:15,decross:!0,greedy:!1,quad:!1,layering:"longestPath",hasCurves:!0,bump:!0}}setXYLocations(n,i,r,o){const a=i.integrations.find(l=>l.id===+n.id);a&&(a.x=n.y*(r+i.activities.length*o),a.y=n.x*(r+i.activities.length*o)),n.children.forEach(l=>{this.setXYLocations(l,i,r,o)})}connectWithFakeStart(n,i){const r=n.integrations.filter(o=>0===n.activities.filter(l=>l.chartInfo.target_id===o.id).length);return r.length>1&&(i.push({id:-1e4,parentIds:[]}),r.forEach((o,a)=>{const l=i.find(d=>d.id===o.id);return l&&i.splice(i.indexOf(l),1),i.push({id:o.id,parentIds:[-1e4]}),{scale:this.multiChartscaleFactor,offset:this.multiChartOffset}})),{scale:this.scaleFactor,offset:this.offset}}arrangeNodes(n,i=this.defaultLayoutProps){const r=[];n.integrations.forEach(x=>{const E=n.activities.filter(O=>O.chartInfo.target_id===x.id).map(O=>O.chartInfo.source_id);r.push({id:x.id,parentIds:E.map(O=>O+"")})}),this.connectWithFakeStart(n,r);const a=Dr().id(x=>x.id+"")(r),d=[36,36],h=i.bump?C.jvg().curve(C.qpX):C.jvg().curve(C.FdL),c=Tn(d,Pn),u=function wn(...t){if(t.length)throw H`got arguments to sugiyama(${t}), but constructor takes no arguments; these were probably meant as data which should be called as \`sugiyama()(...)\``;return ve({layering:fn(),decross:dn(),coord:sn(),nodeSize:[1,1],tweaks:[]},{gap:[1,1]})}();let p;switch(i.layering){case"longestPath":default:p=u.layering(Qi());break;case"topological":p=u.layering(Sn())}i.greedy&&(p=p.coord(function xn(...t){if(t.length)throw H`got arguments to coordGreedy(${t}); you probably forgot to construct coordGreedy before passing to coord: \`sugiyama().coord(coordGreedy())\`, note the trailing "()"`;function e(n,i){let r=0,o=0,a=new Set;for(let c of n)for(let u of c)a.has(u)||(a.add(u),void 0!==u.ux&&(r+=(u.ux-r)/++o));for(let c of n){let u=0,p=0;for(let _ of c)void 0!==_.ux&&(u+=(_.ux-u)/++p);let g=p?u:r;for(let _ of c)void 0===_.ux&&(_.ux=g);De(c,i)}for(let c of Et(n,1))Ji(c,u=>u.parents()),De(c,i);for(let c of Et(n,n.length-2,-1,-1))Ji(c,u=>u.children()),De(c,i);for(let c=0;c<n.length;++c){let u=n.map(p=>p.map(({x:g})=>g));for(let p of Et(n,1))Xi(p,g=>g.parents()),De(p,i);for(let p of Et(n,n.length-2,-1,-1))Xi(p,g=>g.children()),De(p,i);if(yn(n,u))break}let l=1/0,d=-1/0;for(let c of n){let u=c[0];l=Math.min(l,u.x-i(void 0,u));let p=c[c.length-1];d=Math.max(d,p.x+i(p,void 0))}for(let c of a)c.x-=l;let h=d-l;if(h<=0)throw H`must assign nonzero width to at least one node; double check the callback passed to \`sugiyama().nodeSize(...)\``;return h}return e.d3dagBuiltin=!0,e}())),i.quad&&(p=p.coord(function _n(...t){if(t.length)throw H`got arguments to coordQuad(${t}); you probably forgot to construct coordQuad before passing to coord: \`sugiyama().coord(coordQuad())\`, note the trailing "()"`;return Ie({vertWeak:1,vertStrong:0,linkCurve:1,nodeCurve:0,comp:1e-6})}()));const g=p.nodeSize(d).gap([18+i.yGap,18+i.xGap]).tweaks([c]);let _=!1;if(i.decross){const x=p.decross(function In(...t){if(t.length)throw H`got arguments to decrossOpt(${t}); you probably forgot to construct decrossOpt before passing to decross: \`sugiyama().decross(decrossOpt())\`, note the trailing "()"`;return fi({check:"fast",dist:!1})}()).nodeSize(d).gap([18+i.yGap,18+i.xGap]).tweaks([c]);try{x(a),this.logger.debug("decrossing layout")}catch{g(a),this.logger.debug("crossed layout"),_=!0}}else g(a),this.logger.debug("crossed layout");const y=Array.from(a.nodes()),k=Array.from(a.links()),I=new Map;n.activities.filter(x=>!x.chartInfo.milestoneNodeId).forEach(x=>{this.addActivity(I,x.chartInfo.target_id,x.chartInfo.source_id,x)});const w=new Map;return n.integrations.forEach(x=>{w.set(x.id,x)}),y.forEach(x=>{const E=w.get(+x.data.id);E.y=x.ux,E.x=x.uy}),k.forEach(x=>{const E=I.get(+x.target.data.id)?.get(+x.source.data.id);if(E&&x.points){if(!i.hasCurves)return void(E.chartInfo.dPath=void 0);E.chartInfo.dPath=h(x.points.map(O=>[O[1],O[0]]))??void 0}}),n.profile.view.autoZoom=!0,_}addActivity(n,i,r,o){n.has(i)||n.set(i,new Map),n.get(i).set(r,o)}static#t=this.\u0275fac=function(i){return new(i||t)(er.LFG(Fn.m))};static#e=this.\u0275prov=er.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})()},4745:(Ht,Ct)=>{var v;(v=Ct.s||(Ct.s={}))[v.Backspace=8]="Backspace",v[v.Tab=9]="Tab",v[v.Enter=13]="Enter",v[v.Shift=16]="Shift",v[v.Ctrl=17]="Ctrl",v[v.Alt=18]="Alt",v[v.PauseBreak=19]="PauseBreak",v[v.CapsLock=20]="CapsLock",v[v.Escape=27]="Escape",v[v.Space=32]="Space",v[v.PageUp=33]="PageUp",v[v.PageDown=34]="PageDown",v[v.End=35]="End",v[v.Home=36]="Home",v[v.LeftArrow=37]="LeftArrow",v[v.UpArrow=38]="UpArrow",v[v.RightArrow=39]="RightArrow",v[v.DownArrow=40]="DownArrow",v[v.Insert=45]="Insert",v[v.Delete=46]="Delete",v[v.Zero=48]="Zero",v[v.ClosedParen=48]="ClosedParen",v[v.One=49]="One",v[v.ExclamationMark=49]="ExclamationMark",v[v.Two=50]="Two",v[v.AtSign=50]="AtSign",v[v.Three=51]="Three",v[v.PoundSign=51]="PoundSign",v[v.Hash=51]="Hash",v[v.Four=52]="Four",v[v.DollarSign=52]="DollarSign",v[v.Five=53]="Five",v[v.PercentSign=53]="PercentSign",v[v.Six=54]="Six",v[v.Caret=54]="Caret",v[v.Hat=54]="Hat",v[v.Seven=55]="Seven",v[v.Ampersand=55]="Ampersand",v[v.Eight=56]="Eight",v[v.Star=56]="Star",v[v.Asterik=56]="Asterik",v[v.Nine=57]="Nine",v[v.OpenParen=57]="OpenParen",v[v.A=65]="A",v[v.B=66]="B",v[v.C=67]="C",v[v.D=68]="D",v[v.E=69]="E",v[v.F=70]="F",v[v.G=71]="G",v[v.H=72]="H",v[v.I=73]="I",v[v.J=74]="J",v[v.K=75]="K",v[v.L=76]="L",v[v.M=77]="M",v[v.N=78]="N",v[v.O=79]="O",v[v.P=80]="P",v[v.Q=81]="Q",v[v.R=82]="R",v[v.S=83]="S",v[v.T=84]="T",v[v.U=85]="U",v[v.V=86]="V",v[v.W=87]="W",v[v.X=88]="X",v[v.Y=89]="Y",v[v.Z=90]="Z",v[v.LeftWindowKey=91]="LeftWindowKey",v[v.RightWindowKey=92]="RightWindowKey",v[v.SelectKey=93]="SelectKey",v[v.Numpad0=96]="Numpad0",v[v.Numpad1=97]="Numpad1",v[v.Numpad2=98]="Numpad2",v[v.Numpad3=99]="Numpad3",v[v.Numpad4=100]="Numpad4",v[v.Numpad5=101]="Numpad5",v[v.Numpad6=102]="Numpad6",v[v.Numpad7=103]="Numpad7",v[v.Numpad8=104]="Numpad8",v[v.Numpad9=105]="Numpad9",v[v.Multiply=106]="Multiply",v[v.Add=107]="Add",v[v.Subtract=109]="Subtract",v[v.DecimalPoint=110]="DecimalPoint",v[v.Divide=111]="Divide",v[v.F1=112]="F1",v[v.F2=113]="F2",v[v.F3=114]="F3",v[v.F4=115]="F4",v[v.F5=116]="F5",v[v.F6=117]="F6",v[v.F7=118]="F7",v[v.F8=119]="F8",v[v.F9=120]="F9",v[v.F10=121]="F10",v[v.F11=122]="F11",v[v.F12=123]="F12",v[v.NumLock=144]="NumLock",v[v.ScrollLock=145]="ScrollLock",v[v.SemiColon=186]="SemiColon",v[v.Equals=187]="Equals",v[v.Comma=188]="Comma",v[v.Dash=189]="Dash",v[v.Period=190]="Period",v[v.UnderScore=189]="UnderScore",v[v.PlusSign=187]="PlusSign",v[v.ForwardSlash=191]="ForwardSlash",v[v.Tilde=192]="Tilde",v[v.GraveAccent=192]="GraveAccent",v[v.OpenBracket=219]="OpenBracket",v[v.ClosedBracket=221]="ClosedBracket",v[v.Quote=222]="Quote"},617:(Ht,Ct,X)=>{X.d(Ct,{Hw:()=>lt,Ps:()=>N});var C=X(9212),v=X(3680),q=X(2495),Bt=X(6814),Z=X(2096),et=X(8504),L=X(9315),z=X(7394),nt=X(9397),ot=X(7398),gt=X(6306),ht=X(4716),Tt=X(3020),it=X(8180),j=X(9862),at=X(6593);const K=["*"];let wt;function Mt(W){return function bt(){if(void 0===wt&&(wt=null,typeof window<"u")){const W=window;void 0!==W.trustedTypes&&(wt=W.trustedTypes.createPolicy("angular#components",{createHTML:mt=>mt}))}return wt}()?.createHTML(W)||W}function U(W){return Error(`Unable to find icon with the name "${W}"`)}function ut(W){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${W}".`)}function Ot(W){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${W}".`)}class Lt{constructor(mt,A,P){this.url=mt,this.svgText=A,this.options=P}}let _t=(()=>{class W{constructor(A,P,R,rt){this._httpClient=A,this._sanitizer=P,this._errorHandler=rt,this._svgIconConfigs=new Map,this._iconSetConfigs=new Map,this._cachedIconsByUrl=new Map,this._inProgressUrlFetches=new Map,this._fontCssClassesByAlias=new Map,this._resolvers=[],this._defaultFontSetClass=["material-icons","mat-ligature-font"],this._document=R}addSvgIcon(A,P,R){return this.addSvgIconInNamespace("",A,P,R)}addSvgIconLiteral(A,P,R){return this.addSvgIconLiteralInNamespace("",A,P,R)}addSvgIconInNamespace(A,P,R,rt){return this._addSvgIconConfig(A,P,new Lt(R,null,rt))}addSvgIconResolver(A){return this._resolvers.push(A),this}addSvgIconLiteralInNamespace(A,P,R,rt){const ft=this._sanitizer.sanitize(C.q3G.HTML,R);if(!ft)throw Ot(R);const kt=Mt(ft);return this._addSvgIconConfig(A,P,new Lt("",kt,rt))}addSvgIconSet(A,P){return this.addSvgIconSetInNamespace("",A,P)}addSvgIconSetLiteral(A,P){return this.addSvgIconSetLiteralInNamespace("",A,P)}addSvgIconSetInNamespace(A,P,R){return this._addSvgIconSetConfig(A,new Lt(P,null,R))}addSvgIconSetLiteralInNamespace(A,P,R){const rt=this._sanitizer.sanitize(C.q3G.HTML,P);if(!rt)throw Ot(P);const ft=Mt(rt);return this._addSvgIconSetConfig(A,new Lt("",ft,R))}registerFontClassAlias(A,P=A){return this._fontCssClassesByAlias.set(A,P),this}classNameForFontAlias(A){return this._fontCssClassesByAlias.get(A)||A}setDefaultFontSetClass(...A){return this._defaultFontSetClass=A,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(A){const P=this._sanitizer.sanitize(C.q3G.RESOURCE_URL,A);if(!P)throw ut(A);const R=this._cachedIconsByUrl.get(P);return R?(0,Z.of)(G(R)):this._loadSvgIconFromConfig(new Lt(A,null)).pipe((0,nt.b)(rt=>this._cachedIconsByUrl.set(P,rt)),(0,ot.U)(rt=>G(rt)))}getNamedSvgIcon(A,P=""){const R=Me(P,A);let rt=this._svgIconConfigs.get(R);if(rt)return this._getSvgFromConfig(rt);if(rt=this._getIconConfigFromResolvers(P,A),rt)return this._svgIconConfigs.set(R,rt),this._getSvgFromConfig(rt);const ft=this._iconSetConfigs.get(P);return ft?this._getSvgFromIconSetConfigs(A,ft):(0,et._)(U(R))}ngOnDestroy(){this._resolvers=[],this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(A){return A.svgText?(0,Z.of)(G(this._svgElementFromConfig(A))):this._loadSvgIconFromConfig(A).pipe((0,ot.U)(P=>G(P)))}_getSvgFromIconSetConfigs(A,P){const R=this._extractIconWithNameFromAnySet(A,P);if(R)return(0,Z.of)(R);const rt=P.filter(ft=>!ft.svgText).map(ft=>this._loadSvgIconSetFromConfig(ft).pipe((0,gt.K)(kt=>{const Rt=`Loading icon set URL: ${this._sanitizer.sanitize(C.q3G.RESOURCE_URL,ft.url)} failed: ${kt.message}`;return this._errorHandler.handleError(new Error(Rt)),(0,Z.of)(null)})));return(0,L.D)(rt).pipe((0,ot.U)(()=>{const ft=this._extractIconWithNameFromAnySet(A,P);if(!ft)throw U(A);return ft}))}_extractIconWithNameFromAnySet(A,P){for(let R=P.length-1;R>=0;R--){const rt=P[R];if(rt.svgText&&rt.svgText.toString().indexOf(A)>-1){const ft=this._svgElementFromConfig(rt),kt=this._extractSvgIconFromSet(ft,A,rt.options);if(kt)return kt}}return null}_loadSvgIconFromConfig(A){return this._fetchIcon(A).pipe((0,nt.b)(P=>A.svgText=P),(0,ot.U)(()=>this._svgElementFromConfig(A)))}_loadSvgIconSetFromConfig(A){return A.svgText?(0,Z.of)(null):this._fetchIcon(A).pipe((0,nt.b)(P=>A.svgText=P))}_extractSvgIconFromSet(A,P,R){const rt=A.querySelector(`[id="${P}"]`);if(!rt)return null;const ft=rt.cloneNode(!0);if(ft.removeAttribute("id"),"svg"===ft.nodeName.toLowerCase())return this._setSvgAttributes(ft,R);if("symbol"===ft.nodeName.toLowerCase())return this._setSvgAttributes(this._toSvgElement(ft),R);const kt=this._svgElementFromString(Mt("<svg></svg>"));return kt.appendChild(ft),this._setSvgAttributes(kt,R)}_svgElementFromString(A){const P=this._document.createElement("DIV");P.innerHTML=A;const R=P.querySelector("svg");if(!R)throw Error("<svg> tag not found");return R}_toSvgElement(A){const P=this._svgElementFromString(Mt("<svg></svg>")),R=A.attributes;for(let rt=0;rt<R.length;rt++){const{name:ft,value:kt}=R[rt];"id"!==ft&&P.setAttribute(ft,kt)}for(let rt=0;rt<A.childNodes.length;rt++)A.childNodes[rt].nodeType===this._document.ELEMENT_NODE&&P.appendChild(A.childNodes[rt].cloneNode(!0));return P}_setSvgAttributes(A,P){return A.setAttribute("fit",""),A.setAttribute("height","100%"),A.setAttribute("width","100%"),A.setAttribute("preserveAspectRatio","xMidYMid meet"),A.setAttribute("focusable","false"),P&&P.viewBox&&A.setAttribute("viewBox",P.viewBox),A}_fetchIcon(A){const{url:P,options:R}=A,rt=R?.withCredentials??!1;if(!this._httpClient)throw function yt(){return Error("Could not find HttpClient provider for use with Angular Material icons. Please include the HttpClientModule from @angular/common/http in your app imports.")}();if(null==P)throw Error(`Cannot fetch icon from URL "${P}".`);const ft=this._sanitizer.sanitize(C.q3G.RESOURCE_URL,P);if(!ft)throw ut(P);const kt=this._inProgressUrlFetches.get(ft);if(kt)return kt;const Zt=this._httpClient.get(ft,{responseType:"text",withCredentials:rt}).pipe((0,ot.U)(Rt=>Mt(Rt)),(0,ht.x)(()=>this._inProgressUrlFetches.delete(ft)),(0,Tt.B)());return this._inProgressUrlFetches.set(ft,Zt),Zt}_addSvgIconConfig(A,P,R){return this._svgIconConfigs.set(Me(A,P),R),this}_addSvgIconSetConfig(A,P){const R=this._iconSetConfigs.get(A);return R?R.push(P):this._iconSetConfigs.set(A,[P]),this}_svgElementFromConfig(A){if(!A.svgElement){const P=this._svgElementFromString(A.svgText);this._setSvgAttributes(P,A.options),A.svgElement=P}return A.svgElement}_getIconConfigFromResolvers(A,P){for(let R=0;R<this._resolvers.length;R++){const rt=this._resolvers[R](P,A);if(rt)return s(rt)?new Lt(rt.url,null,rt.options):new Lt(rt,null)}}static#t=this.\u0275fac=function(P){return new(P||W)(C.LFG(j.eN,8),C.LFG(at.H7),C.LFG(Bt.K0,8),C.LFG(C.qLn))};static#e=this.\u0275prov=C.Yz7({token:W,factory:W.\u0275fac,providedIn:"root"})}return W})();function G(W){return W.cloneNode(!0)}function Me(W,mt){return W+":"+mt}function s(W){return!(!W.url||!W.options)}const f=(0,v.pj)(class{constructor(W){this._elementRef=W}}),m=new C.OlP("MAT_ICON_DEFAULT_OPTIONS"),S=new C.OlP("mat-icon-location",{providedIn:"root",factory:function D(){const W=(0,C.f3M)(Bt.K0),mt=W?W.location:null;return{getPathname:()=>mt?mt.pathname+mt.search:""}}}),B=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],J=B.map(W=>`[${W}]`).join(", "),ct=/^url\(['"]?#(.*?)['"]?\)$/;let lt=(()=>{class W extends f{get inline(){return this._inline}set inline(A){this._inline=(0,q.Ig)(A)}get svgIcon(){return this._svgIcon}set svgIcon(A){A!==this._svgIcon&&(A?this._updateSvgIcon(A):this._svgIcon&&this._clearSvgElement(),this._svgIcon=A)}get fontSet(){return this._fontSet}set fontSet(A){const P=this._cleanupFontValue(A);P!==this._fontSet&&(this._fontSet=P,this._updateFontIconClasses())}get fontIcon(){return this._fontIcon}set fontIcon(A){const P=this._cleanupFontValue(A);P!==this._fontIcon&&(this._fontIcon=P,this._updateFontIconClasses())}constructor(A,P,R,rt,ft,kt){super(A),this._iconRegistry=P,this._location=rt,this._errorHandler=ft,this._inline=!1,this._previousFontSetClass=[],this._currentIconFetch=z.w0.EMPTY,kt&&(kt.color&&(this.color=this.defaultColor=kt.color),kt.fontSet&&(this.fontSet=kt.fontSet)),R||A.nativeElement.setAttribute("aria-hidden","true")}_splitIconName(A){if(!A)return["",""];const P=A.split(":");switch(P.length){case 1:return["",P[0]];case 2:return P;default:throw Error(`Invalid icon name: "${A}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){const A=this._elementsWithExternalReferences;if(A&&A.size){const P=this._location.getPathname();P!==this._previousPath&&(this._previousPath=P,this._prependPathToReferences(P))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(A){this._clearSvgElement();const P=this._location.getPathname();this._previousPath=P,this._cacheChildrenWithExternalReferences(A),this._prependPathToReferences(P),this._elementRef.nativeElement.appendChild(A)}_clearSvgElement(){const A=this._elementRef.nativeElement;let P=A.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();P--;){const R=A.childNodes[P];(1!==R.nodeType||"svg"===R.nodeName.toLowerCase())&&R.remove()}}_updateFontIconClasses(){if(!this._usingFontIcon())return;const A=this._elementRef.nativeElement,P=(this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet).split(/ +/):this._iconRegistry.getDefaultFontSetClass()).filter(R=>R.length>0);this._previousFontSetClass.forEach(R=>A.classList.remove(R)),P.forEach(R=>A.classList.add(R)),this._previousFontSetClass=P,this.fontIcon!==this._previousFontIconClass&&!P.includes("mat-ligature-font")&&(this._previousFontIconClass&&A.classList.remove(this._previousFontIconClass),this.fontIcon&&A.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(A){return"string"==typeof A?A.trim().split(" ")[0]:A}_prependPathToReferences(A){const P=this._elementsWithExternalReferences;P&&P.forEach((R,rt)=>{R.forEach(ft=>{rt.setAttribute(ft.name,`url('${A}#${ft.value}')`)})})}_cacheChildrenWithExternalReferences(A){const P=A.querySelectorAll(J),R=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let rt=0;rt<P.length;rt++)B.forEach(ft=>{const kt=P[rt],Zt=kt.getAttribute(ft),Rt=Zt?Zt.match(ct):null;if(Rt){let we=R.get(kt);we||(we=[],R.set(kt,we)),we.push({name:ft,value:Rt[1]})}})}_updateSvgIcon(A){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),A){const[P,R]=this._splitIconName(A);P&&(this._svgNamespace=P),R&&(this._svgName=R),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(R,P).pipe((0,it.q)(1)).subscribe(rt=>this._setSvgElement(rt),rt=>{this._errorHandler.handleError(new Error(`Error retrieving icon ${P}:${R}! ${rt.message}`))})}}static#t=this.\u0275fac=function(P){return new(P||W)(C.Y36(C.SBq),C.Y36(_t),C.$8M("aria-hidden"),C.Y36(S),C.Y36(C.qLn),C.Y36(m,8))};static#e=this.\u0275cmp=C.Xpm({type:W,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:8,hostBindings:function(P,R){2&P&&(C.uIk("data-mat-icon-type",R._usingFontIcon()?"font":"svg")("data-mat-icon-name",R._svgName||R.fontIcon)("data-mat-icon-namespace",R._svgNamespace||R.fontSet)("fontIcon",R._usingFontIcon()?R.fontIcon:null),C.ekj("mat-icon-inline",R.inline)("mat-icon-no-color","primary"!==R.color&&"accent"!==R.color&&"warn"!==R.color))},inputs:{color:"color",inline:"inline",svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],features:[C.qOj],ngContentSelectors:K,decls:1,vars:0,template:function(P,R){1&P&&(C.F$t(),C.Hsn(0))},styles:["mat-icon,mat-icon.mat-primary,mat-icon.mat-accent,mat-icon.mat-warn{color:var(--mat-icon-color)}.mat-icon{-webkit-user-select:none;user-select:none;background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px;overflow:hidden}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}.mat-icon.mat-ligature-font[fontIcon]::before{content:attr(fontIcon)}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}"],encapsulation:2,changeDetection:0})}return W})(),N=(()=>{class W{static#t=this.\u0275fac=function(P){return new(P||W)};static#e=this.\u0275mod=C.oAB({type:W});static#i=this.\u0275inj=C.cJS({imports:[v.BQ,v.BQ]})}return W})()}}]);