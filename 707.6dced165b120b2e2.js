"use strict";(self.webpackChunkcritical_web=self.webpackChunkcritical_web||[]).push([[707],{2433:(T,u,l)=>{l.d(u,{CK:()=>c,Fs:()=>d,O0:()=>p,OD:()=>g,RH:()=>A,RO:()=>b,Zs:()=>v,au:()=>m,d4:()=>h,eB:()=>P,sK:()=>y,uB:()=>e,xn:()=>f});const c="project.changetracker.clear",p=-1,e="library/(grid/0//sidebar:libar/0)",h="profile/(-2//sidebar:grid/-2)",m="history/(-2//sidebar:arrow/-2)",g="network/(-2//sidebar:meta/-2)",b="created.project",v="project.newtwork.array",P="project.filtered.newtwork.array",y="jira.token.key",A="jira.token.expiry.key",d="You are not the owner of this project. To edit you must Save Copy.",f="Go to Parent to enable buttons. Your changes will be preserved."},9707:(T,u,l)=>{l.d(u,{Z:()=>S});var c=l(2119),p=l(2181),e=l(9212),C=l(1e3),h=l(3633),m=l(4902),g=l(9844),_=l(2433),j=l(3803),b=l(9011);let v=(()=>{class a{constructor(t,n){this.dateUtils=t,this.riskCompiler=n}compile(t){null!==t.profile.parentProject?(this.riskCompiler.compileRiskProperties(t),this.dateUtils.calculateEarliestFinishDate(t),this.updateParentRisk(t),this.riskCompiler.compileRiskProperties(t.profile.parentProject),this.dateUtils.calculateEarliestFinishDate(t.profile.parentProject)):console.error("No parent project found for project: "+t.profile.id)}updateParentRisk(t){this.updateActivityParentRisk(t)}updateActivityParentRisk(t){if(null!=t.profile.parentProject){const n=t.profile.subProject.activityParentId,i=t.profile.parentProject.activities.find(s=>s.profile.id===n);if(!i)return;i.profile.duration=this.calculatedProjectDuration(t)}}calculatedProjectDuration(t){if(null!=t.profile.end){const n=t.profile.end;return t.integrations.find(s=>s.id===n)?.lft}return 0}static#e=this.\u0275fac=function(n){return new(n||a)(e.LFG(j.s),e.LFG(b.r))};static#t=this.\u0275prov=e.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"})}return a})();var P=l(4961);let y=(()=>{class a{constructor(t,n,i,s,o,r){this.dashboard=t,this.eventService=n,this.parentCompiler=i,this.milestoneFactory=s,this.projectApi=o,this.projectSerializer=r}ngOnInit(){this.drawChannel$=this.eventService.get(m.B),this.activeProject$=this.dashboard.activeProject$}setDuration(t,n,i){null!==n&&(n.profile.duration=+t,null!=i.profile.parentProject?(this.parentCompiler.compile(i),this.updateProject(i),this.dashboard.secondaryProject$.next(i.profile.parentProject)):this.updateProject(i))}setName(t,n,i){null!==n&&(n.profile.name=t,this.updateProject(i))}setPcd(t,n,i){null!==n&&(n.profile.planned_completion_date=t,this.updateProject(i))}setFinish(t,n,i){null!==n&&(n.profile.finish=t,this.updateProject(i))}setSubGraphId(t,n,i){null!==n&&(n.subProject.subGraphId=+t,this.updateProject(i))}setIsDummy(t,n,i){null!==n&&(n.chartInfo.isDummy=t,this.updateProject(i))}setIsNDummy(t,n,i){null!==n&&(n.isDummy=t,this.updateProject(i))}generateMilestone(t,n){this.milestoneFactory.createMilestone(n,t),this.updateProject(n)}revertMilestone(t,n){this.milestoneFactory.changeBackToNonMilestone(t,n),this.updateProject(n)}updateProject(t){this.dashboard.updateProject(t,!0)}updateSelectedActivity(t,n){n.profile.view.selectedActivity=t}loadSubProject(t,n,i){let s=null;if(i&&i.length>0&&(s=i.find(o=>o.profile.id===t.subProject.subGraphId),s))this.swapProjWithSubProj(s,t,n);else if(null==t.subProject.subGraphLoaded){const o=this.dashboard.cache.get(t.subProject.subGraphId);o?this.loadChildAndParentProjects(t,n,o,i):this.projectApi.get(t.subProject.subGraphId).subscribe(r=>{this.loadChildAndParentProjects(t,n,r,i)})}else this.swapProjWithSubProj(t.subProject.subGraphLoaded,t,n)}loadChildAndParentProjects(t,n,i,s){i.profile.parentProject=n,t.subProject.subGraphLoaded=i,i.profile.subProject.activityParentId=t.profile.id,i.profile.parentProjectId=n.profile.id,i.profile.view.autoZoom=!0,this.dashboard.resetUndoRedo(),this.dashboard.updateProject(i,!0),this.dashboard.secondaryProject$.next(n)}swapProjWithSubProj(t,n,i){n.subProject.subGraphLoaded=t,-1===n.subProject.subGraphId&&(n.subProject.subGraphId=0,t.profile.id=0),t.profile.parentProject=i,t.profile.view.autoZoom=!0,t.profile.subProject.activityParentId=n.profile.id,t.profile.parentProjectId=i.profile.id,this.dashboard.resetUndoRedo(),this.dashboard.updateProject(t,!0),this.dashboard.secondaryProject$.next(i)}createSubProject(t,n,i){const s=this.eventService.get(m.P),o=this.projectSerializer.fromJson(null);let r=s.getValue();void 0===r&&(r=-2),o.profile.id=r,o.profile.name=t.profile.name??"New Sub Project",o.profile.parentProjectId=n.profile.id,o.profile.subProject.activityParentId=t.profile.id,--r,s.next(r),this.eventService.get(_.RO).next(o),this.swapProjWithSubProj(o,t,n)}destroy(){this.eventService.get(_.RO).next(null)}formatDate(t){if(null!=t)return(0,C.Z)(t,g.R7)}updateDate(t,n,i,s){switch(n){case"finish":i.profile.finish=this.formatDate(t),i.profile.finish_dt=t;break;case"start_date":i.profile.start_date=this.formatDate(t),i.profile.start_date_dt=t;break;case"pcd":i.profile.planned_completion_date=this.formatDate(t),i.profile.planned_completion_date_dt=t}this.updateProject(s)}setLabel(t,n,i){n.label=t,this.updateProject(i)}static#e=this.\u0275fac=function(n){return new(n||a)(e.LFG(h.Ou),e.LFG(h.WO),e.LFG(v),e.LFG(P.y),e.LFG(h.$6),e.LFG(c.z))};static#t=this.\u0275prov=e.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"})}return a})();var A=l(7586),d=l(6223),f=l(5616),M=l(617);const N=["activityName"];let S=(()=>{class a{constructor(t,n,i){this.controller=t,this.route=n,this.cd=i,this.activity=null,this.selectedNode=null,this.projectPool=null}ngOnInit(){this.controller.ngOnInit(),this.cActSub=this.controller.drawChannel$.pipe((0,p.h)(t=>!!t)).subscribe(t=>{this.activityName.nativeElement.focus(),this.activityName.nativeElement.select()}),this.sub=this.controller.activeProject$.pipe((0,p.h)(t=>!!t)).subscribe(t=>{this.project=t,this.activity=t.profile.view.selectedActivity??null,this.selectedNode=t.profile.view.selectedIntegration??null,this.loadSelectedActivity(this.activity),this.loadSelectedNode(this.selectedNode),this.cd.detectChanges()})}ngOnDestroy(){this.sub&&this.sub.unsubscribe(),this.cActSub&&this.cActSub.unsubscribe(),this.controller.destroy()}loadSelectedActivity(t){null!==t?(this.showPanel=!0,void 0!==t.profile.duration&&(this.duration=t.profile.duration),void 0!==t.profile.name&&(this.name=t.profile.name),null!==t.profile.planned_completion_date_dt&&(this.pcd=t.profile.planned_completion_date_dt),null!==t.profile.finish_dt&&(this.finish=t.profile.finish_dt),this.subgraphId=t.subProject.subGraphId,this.isDummy=t.chartInfo.isDummy,this.subGraphButtonType=-1!==t.subProject.subGraphId?"load":"create"):this.showPanel=!1}loadSelectedNode(t){this.label=t?.label??"",this.isMilestone=t?.isMilestone??!1}setDuration(t){this.activity&&this.controller.setDuration(t.value,this.activity,this.project)}setName(t){this.activity&&this.controller.setName(t.value,this.activity,this.project)}setPcd(t){this.activity&&this.controller.setPcd(t,this.activity,this.project)}setFinish(t){this.activity&&this.controller.setFinish(t,this.activity,this.project)}setSubGraphId(t){this.activity&&this.controller.setSubGraphId(t.value,this.activity,this.project)}setIsDummy(t){this.activity&&this.controller.setIsDummy(t.checked,this.activity,this.project)}setIsNDummy(t){this.selectedNode&&this.controller.setIsNDummy(t.checked,this.selectedNode,this.project)}generateMilestone(){this.selectedNode&&this.controller.generateMilestone(this.selectedNode,this.project)}revertMilestone(){this.selectedNode&&this.controller.revertMilestone(this.selectedNode,this.project)}loadSubProject(){this.activity&&this.controller.loadSubProject(this.activity,this.project,this.projectPool),this.activity=null}createSubProject(){this.activity&&this.controller.createSubProject(this.activity,this.project,this.projectPool),this.activity=null}updateDate(t,n){this.activity&&this.controller.updateDate(t,n,this.activity,this.project)}setLabel(t){this.selectedNode&&this.controller.setLabel(t.value,this.selectedNode,this.project)}static#e=this.\u0275fac=function(n){return new(n||a)(e.Y36(y),e.Y36(A.gz),e.Y36(e.sBO))};static#t=this.\u0275cmp=e.Xpm({type:a,selectors:[["cp-selected-activity"]],viewQuery:function(n,i){if(1&n&&e.Gf(N,7),2&n){let s;e.iGM(s=e.CRH())&&(i.activityName=s.first)}},inputs:{projectPool:"projectPool"},features:[e._Bn([c.z])],decls:74,vars:21,consts:[[1,"title"],[1,"form","nothing-selected","keep-selected-item",3,"hidden"],["type","text",3,"ngModel","input"],[1,"form-check"],["type","checkbox","name","isNDummy","id","isNDummy",1,"form-check-input",3,"ngModel","ngModelChange","change"],["for","isNDummy",1,"form-check-label"],[3,"hidden"],[1,"btn","btn-secondary",3,"click"],[1,"form","keep-selected-item",3,"hidden"],["activityName",""],["type","number",3,"ngModel","input"],[1,"dt-picker"],["matSuffix","",1,"icon","picker-toggle",3,"for"],[1,"mat-icon-rtl-mirror"],["placeholder","---",1,"dateinput",3,"matDatepicker","ngModel","ngModelChange"],["input",""],[3,"closed"],["picker",""],["inputfinish",""],["pickerfinish",""],["type","number",3,"ngModel","ngModelChange","change"],["type","checkbox","name","isDummy","id","isDummy",1,"form-check-input",3,"ngModel","ngModelChange","change"],["for","isDummy",1,"form-check-label"],[1,"nothing-selected",3,"hidden"]],template:function(n,i){if(1&n){const s=e.EpF();e.TgZ(0,"div",0),e._uU(1),e.qZA(),e.TgZ(2,"div",1)(3,"div")(4,"div"),e._uU(5),e.qZA()(),e.TgZ(6,"div")(7,"div"),e._uU(8,"Label"),e.qZA(),e.TgZ(9,"div")(10,"input",2),e.NdJ("input",function(r){return i.setLabel(r.target)}),e.qZA()()(),e.TgZ(11,"div")(12,"div",3)(13,"input",4),e.NdJ("ngModelChange",function(r){return i.isNDummy=r})("change",function(r){return i.setIsNDummy(r.target)}),e.qZA(),e.TgZ(14,"label",5),e._uU(15," Is Dummy "),e.qZA()()(),e.TgZ(16,"div")(17,"div",6)(18,"button",7),e.NdJ("click",function(){return i.generateMilestone()}),e._uU(19,"Convert to Milestone"),e.qZA()(),e.TgZ(20,"div",6)(21,"button",7),e.NdJ("click",function(){return i.revertMilestone()}),e._uU(22,"Revert from Milestone"),e.qZA()()()(),e.TgZ(23,"div",8)(24,"div")(25,"div"),e._uU(26,"Name"),e.qZA(),e.TgZ(27,"div")(28,"input",2,9),e.NdJ("input",function(r){return i.setName(r.target)}),e.qZA()()(),e.TgZ(30,"div")(31,"div"),e._uU(32,"Duration"),e.qZA(),e.TgZ(33,"div")(34,"input",10),e.NdJ("input",function(r){return i.setDuration(r.target)}),e.qZA()()(),e.TgZ(35,"div")(36,"div"),e._uU(37,"Planned Completion Date"),e.qZA(),e.TgZ(38,"div",11)(39,"mat-datepicker-toggle",12),e._UZ(40,"mat-icon",13),e.qZA(),e.TgZ(41,"input",14,15),e.NdJ("ngModelChange",function(r){return i.pcd=r})("ngModelChange",function(){return i.updateDate(i.pcd,"pcd")}),e.qZA(),e.TgZ(43,"mat-datepicker",16,17),e.NdJ("closed",function(){e.CHM(s);const r=e.MAs(42);return e.KtG(r.blur())}),e.qZA()()(),e.TgZ(45,"div")(46,"div"),e._uU(47,"Finish"),e.qZA(),e.TgZ(48,"div",11)(49,"mat-datepicker-toggle",12),e._UZ(50,"mat-icon",13),e.qZA(),e.TgZ(51,"input",14,18),e.NdJ("ngModelChange",function(r){return i.finish=r})("ngModelChange",function(){return i.updateDate(i.finish,"finish")}),e.qZA(),e.TgZ(53,"mat-datepicker",16,19),e.NdJ("closed",function(){e.CHM(s);const r=e.MAs(42);return e.KtG(r.blur())}),e.qZA()()(),e.TgZ(55,"div")(56,"div"),e._uU(57,"Sub Project"),e.qZA(),e.TgZ(58,"div")(59,"input",20),e.NdJ("ngModelChange",function(r){return i.subgraphId=r})("change",function(r){return i.setSubGraphId(r.target)}),e.qZA()()(),e.TgZ(60,"div")(61,"div",3)(62,"input",21),e.NdJ("ngModelChange",function(r){return i.isDummy=r})("change",function(r){return i.setIsDummy(r.target)}),e.qZA(),e.TgZ(63,"label",22),e._uU(64," Is Dummy "),e.qZA()()(),e.TgZ(65,"div")(66,"div",6)(67,"button",7),e.NdJ("click",function(){return i.loadSubProject()}),e._uU(68,"Load Sub Project"),e.qZA()(),e.TgZ(69,"div",6)(70,"button",7),e.NdJ("click",function(){return i.createSubProject()}),e._uU(71,"Create Sub Project"),e.qZA()()()(),e.TgZ(72,"div",23),e._uU(73,"No Activity Selected"),e.qZA()}if(2&n){const s=e.MAs(44),o=e.MAs(54);e.xp6(1),e.hij("Selected ",null===i.selectedNode?"Activity":"Node",""),e.xp6(1),e.Q6J("hidden",null===i.selectedNode),e.xp6(3),e.hij("Id: ",null==i.selectedNode?null:i.selectedNode.id,""),e.xp6(5),e.Q6J("ngModel",i.label),e.xp6(3),e.Q6J("ngModel",i.isNDummy),e.xp6(4),e.Q6J("hidden",i.isMilestone),e.xp6(3),e.Q6J("hidden",!i.isMilestone),e.xp6(3),e.Q6J("hidden",!i.showPanel),e.xp6(5),e.Q6J("ngModel",i.name),e.xp6(6),e.Q6J("ngModel",i.duration),e.xp6(5),e.Q6J("for",s),e.xp6(2),e.Q6J("matDatepicker",s)("ngModel",i.pcd),e.xp6(8),e.Q6J("for",o),e.xp6(2),e.Q6J("matDatepicker",o)("ngModel",i.finish),e.xp6(8),e.Q6J("ngModel",i.subgraphId),e.xp6(3),e.Q6J("ngModel",i.isDummy),e.xp6(4),e.Q6J("hidden","load"!==i.subGraphButtonType),e.xp6(3),e.Q6J("hidden","create"!==i.subGraphButtonType),e.xp6(3),e.Q6J("hidden",i.showPanel||null!==i.selectedNode)}},dependencies:[d.Fj,d.wV,d.Wl,d.JJ,d.On,f.Mq,f.hl,f.nW,M.Hw],styles:[".title[_ngcontent-%COMP%]{font-size:.95rem;font-weight:700;padding-bottom:2px}.nothing-selected[_ngcontent-%COMP%]{height:261px;margin-top:7px}button[_ngcontent-%COMP%]{width:155px;padding:3px 0;margin-top:10px}input[type=text][_ngcontent-%COMP%], input[type=number][_ngcontent-%COMP%]{padding-left:5px;width:150px}  .mat-form-field-infix{width:120px!important}  svg.mat-datepicker-toggle-default-icon{height:15px!important;width:14px!important;margin-right:0;display:inherit}.icon[_ngcontent-%COMP%]{transform:scale(1)}input.dateinput[_ngcontent-%COMP%]{padding-left:24px;width:150px}  .mat-icon-button{height:17px!important;width:27px!important;line-height:16px!important}.dt-picker[_ngcontent-%COMP%]{position:relative}.picker-toggle[_ngcontent-%COMP%]{margin-top:2px;position:absolute;top:-22px;left:-8px}  button.mat-icon-button{height:25px!important;width:27px!important}label.btn[_ngcontent-%COMP%]{text-align:left;padding-left:12px;margin-top:10px;width:154px}"]})}return a})()},4902:(T,u,l)=>{l.d(u,{B:()=>c,P:()=>p});const c="arrow.create.focus",p="network.sub.proj.tracker"}}]);